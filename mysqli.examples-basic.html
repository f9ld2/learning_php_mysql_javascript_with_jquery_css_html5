---
layout: default
---

  <h2 class="title">MySQLi extension basic examples</h2>
  <p class="para">
   This example shows how to connect, execute a query, use basic
   error handling, print resulting rows, and disconnect from a MySQL database.
  </p>
  <p class="para">
   This example uses the freely available Sakila database that
   can be downloaded from <a href="http://dev.mysql.com/doc/sakila/en/index.html" class="link external">&#xBB;&#xA0;dev.mysql.com,
   as described here</a>. To get this example to work, (a) install sakila 
   and (b) modify the connection variables (host, your_user, your_pass).
  </p>
  <div class="example" id="example-1820">
   <p><strong>Example #1 MySQLi extension overview example</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&#xA0;Let&apos;s&#xA0;pass&#xA0;in&#xA0;a&#xA0;$_GET&#xA0;variable&#xA0;to&#xA0;our&#xA0;example,&#xA0;in&#xA0;this&#xA0;case<br>//&#xA0;it&apos;s&#xA0;aid&#xA0;for&#xA0;actor_id&#xA0;in&#xA0;our&#xA0;Sakila&#xA0;database.&#xA0;Let&apos;s&#xA0;make&#xA0;it<br>//&#xA0;default&#xA0;to&#xA0;1,&#xA0;and&#xA0;cast&#xA0;it&#xA0;to&#xA0;an&#xA0;integer&#xA0;as&#xA0;to&#xA0;avoid&#xA0;SQL&#xA0;injection<br>//&#xA0;and/or&#xA0;related&#xA0;security&#xA0;problems.&#xA0;Handling&#xA0;all&#xA0;of&#xA0;this&#xA0;goes&#xA0;beyond<br>//&#xA0;the&#xA0;scope&#xA0;of&#xA0;this&#xA0;simple&#xA0;example.&#xA0;Example:<br>//&#xA0;&#xA0;&#xA0;http://example.org/script.php?aid=42<br></span><span style="color: #007700">if&#xA0;(isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;aid&apos;</span><span style="color: #007700">])&#xA0;&amp;&amp;&#xA0;</span><span style="color: #0000BB">is_numeric</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;aid&apos;</span><span style="color: #007700">]))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$aid&#xA0;</span><span style="color: #007700">=&#xA0;(int)&#xA0;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;aid&apos;</span><span style="color: #007700">];<br>}&#xA0;else&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$aid&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #FF8000">//&#xA0;Connecting&#xA0;to&#xA0;and&#xA0;selecting&#xA0;a&#xA0;MySQL&#xA0;database&#xA0;named&#xA0;sakila<br>//&#xA0;Hostname:&#xA0;127.0.0.1,&#xA0;username:&#xA0;your_user,&#xA0;password:&#xA0;your_pass,&#xA0;db:&#xA0;sakila<br></span><span style="color: #0000BB">$mysqli&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;127.0.0.1&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;your_user&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;your_pass&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;sakila&apos;</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;Oh&#xA0;no!&#xA0;A&#xA0;connect_errno&#xA0;exists&#xA0;so&#xA0;the&#xA0;connection&#xA0;attempt&#xA0;failed!<br></span><span style="color: #007700">if&#xA0;(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_errno</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;The&#xA0;connection&#xA0;failed.&#xA0;What&#xA0;do&#xA0;you&#xA0;want&#xA0;to&#xA0;do?&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;You&#xA0;could&#xA0;contact&#xA0;yourself&#xA0;(email?),&#xA0;log&#xA0;the&#xA0;error,&#xA0;show&#xA0;a&#xA0;nice&#xA0;page,&#xA0;etc.<br>&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;You&#xA0;do&#xA0;not&#xA0;want&#xA0;to&#xA0;reveal&#xA0;sensitive&#xA0;information<br><br>&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;Let&apos;s&#xA0;try&#xA0;this:<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&quot;Sorry,&#xA0;this&#xA0;website&#xA0;is&#xA0;experiencing&#xA0;problems.&quot;</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;Something&#xA0;you&#xA0;should&#xA0;not&#xA0;do&#xA0;on&#xA0;a&#xA0;public&#xA0;site,&#xA0;but&#xA0;this&#xA0;example&#xA0;will&#xA0;show&#xA0;you<br>&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;anyways,&#xA0;is&#xA0;print&#xA0;out&#xA0;MySQL&#xA0;error&#xA0;related&#xA0;information&#xA0;--&#xA0;you&#xA0;might&#xA0;log&#xA0;this<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&quot;Error:&#xA0;Failed&#xA0;to&#xA0;make&#xA0;a&#xA0;MySQL&#xA0;connection,&#xA0;here&#xA0;is&#xA0;why:&#xA0;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Errno:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_errno&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&quot;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Error:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_error&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&quot;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;You&#xA0;might&#xA0;want&#xA0;to&#xA0;show&#xA0;them&#xA0;something&#xA0;nice,&#xA0;but&#xA0;we&#xA0;will&#xA0;simply&#xA0;exit<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">exit;<br>}<br><br></span><span style="color: #FF8000">//&#xA0;Perform&#xA0;an&#xA0;SQL&#xA0;query<br></span><span style="color: #0000BB">$sql&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&quot;SELECT&#xA0;actor_id,&#xA0;first_name,&#xA0;last_name&#xA0;FROM&#xA0;actor&#xA0;WHERE&#xA0;actor_id&#xA0;=&#xA0;</span><span style="color: #0000BB">$aid</span><span style="color: #DD0000">&quot;</span><span style="color: #007700">;<br>if&#xA0;(!</span><span style="color: #0000BB">$result&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;Oh&#xA0;no!&#xA0;The&#xA0;query&#xA0;failed.&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&quot;Sorry,&#xA0;the&#xA0;website&#xA0;is&#xA0;experiencing&#xA0;problems.&quot;</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;Again,&#xA0;do&#xA0;not&#xA0;do&#xA0;this&#xA0;on&#xA0;a&#xA0;public&#xA0;site,&#xA0;but&#xA0;we&apos;ll&#xA0;show&#xA0;you&#xA0;how<br>&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;to&#xA0;get&#xA0;the&#xA0;error&#xA0;information<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&quot;Error:&#xA0;Our&#xA0;query&#xA0;failed&#xA0;to&#xA0;execute&#xA0;and&#xA0;here&#xA0;is&#xA0;why:&#xA0;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Query:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$sql&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&quot;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Errno:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errno&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&quot;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Error:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&quot;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;exit;<br>}<br><br></span><span style="color: #FF8000">//&#xA0;Phew,&#xA0;we&#xA0;made&#xA0;it.&#xA0;We&#xA0;know&#xA0;our&#xA0;MySQL&#xA0;connection&#xA0;and&#xA0;query&#xA0;<br>//&#xA0;succeeded,&#xA0;but&#xA0;do&#xA0;we&#xA0;have&#xA0;a&#xA0;result?<br></span><span style="color: #007700">if&#xA0;(</span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows&#xA0;</span><span style="color: #007700">===&#xA0;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;Oh,&#xA0;no&#xA0;rows!&#xA0;Sometimes&#xA0;that&apos;s&#xA0;expected&#xA0;and&#xA0;okay,&#xA0;sometimes<br>&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;it&#xA0;is&#xA0;not.&#xA0;You&#xA0;decide.&#xA0;In&#xA0;this&#xA0;case,&#xA0;maybe&#xA0;actor_id&#xA0;was&#xA0;too<br>&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;large?&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&quot;We&#xA0;could&#xA0;not&#xA0;find&#xA0;a&#xA0;match&#xA0;for&#xA0;ID&#xA0;</span><span style="color: #0000BB">$aid</span><span style="color: #DD0000">,&#xA0;sorry&#xA0;about&#xA0;that.&#xA0;Please&#xA0;try&#xA0;again.&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;exit;<br>}<br><br></span><span style="color: #FF8000">//&#xA0;Now,&#xA0;we&#xA0;know&#xA0;only&#xA0;one&#xA0;result&#xA0;will&#xA0;exist&#xA0;in&#xA0;this&#xA0;example&#xA0;so&#xA0;let&apos;s&#xA0;<br>//&#xA0;fetch&#xA0;it&#xA0;into&#xA0;an&#xA0;associated&#xA0;array&#xA0;where&#xA0;the&#xA0;array&apos;s&#xA0;keys&#xA0;are&#xA0;the&#xA0;<br>//&#xA0;table&apos;s&#xA0;column&#xA0;names<br></span><span style="color: #0000BB">$actor&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">();<br>echo&#xA0;</span><span style="color: #DD0000">&quot;Sometimes&#xA0;I&#xA0;see&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;first_name&apos;</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;last_name&apos;</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;&#xA0;on&#xA0;TV.&quot;</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&#xA0;Now,&#xA0;let&apos;s&#xA0;fetch&#xA0;five&#xA0;random&#xA0;actors&#xA0;and&#xA0;output&#xA0;their&#xA0;names&#xA0;to&#xA0;a&#xA0;list.<br>//&#xA0;We&apos;ll&#xA0;add&#xA0;less&#xA0;error&#xA0;handling&#xA0;here&#xA0;as&#xA0;you&#xA0;can&#xA0;do&#xA0;that&#xA0;on&#xA0;your&#xA0;own&#xA0;now<br></span><span style="color: #0000BB">$sql&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&quot;SELECT&#xA0;actor_id,&#xA0;first_name,&#xA0;last_name&#xA0;FROM&#xA0;actor&#xA0;ORDER&#xA0;BY&#xA0;rand()&#xA0;LIMIT&#xA0;5&quot;</span><span style="color: #007700">;<br>if&#xA0;(!</span><span style="color: #0000BB">$result&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Sorry,&#xA0;the&#xA0;website&#xA0;is&#xA0;experiencing&#xA0;problems.&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;exit;<br>}<br><br></span><span style="color: #FF8000">//&#xA0;Print&#xA0;our&#xA0;5&#xA0;random&#xA0;actors&#xA0;in&#xA0;a&#xA0;list,&#xA0;and&#xA0;link&#xA0;to&#xA0;each&#xA0;actor<br></span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;ul&gt;\n&quot;</span><span style="color: #007700">;<br>while&#xA0;(</span><span style="color: #0000BB">$actor&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;li&gt;&lt;a&#xA0;href=&apos;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;SCRIPT_FILENAME&apos;</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;?aid=&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;actor_id&apos;</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;&apos;&gt;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;first_name&apos;</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&apos;&#xA0;&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;last_name&apos;</span><span style="color: #007700">];<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;/a&gt;&lt;/li&gt;\n&quot;</span><span style="color: #007700">;<br>}<br>echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;/ul&gt;\n&quot;</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&#xA0;The&#xA0;script&#xA0;will&#xA0;automatically&#xA0;free&#xA0;the&#xA0;result&#xA0;and&#xA0;close&#xA0;the&#xA0;MySQL<br>//&#xA0;connection&#xA0;when&#xA0;it&#xA0;exits,&#xA0;but&#xA0;let&apos;s&#xA0;just&#xA0;do&#xA0;it&#xA0;anyways<br></span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">free</span><span style="color: #007700">();<br></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">close</span><span style="color: #007700">();<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 