---
layout: default
---

 <div class="refnamediv">
  <h1 class="refname">oci_close</h1>
  <p class="verinfo">(PHP 5, PHP 7, PECL OCI8 &gt;= 1.1.0)</p><p class="refpurpose"><span class="refname">oci_close</span> &#x2014; <span class="dc-title">Closes an Oracle connection</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.oci-close-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>oci_close</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$connection</code></span>
   )</div>

  <p class="para rdfs-comment">
   Unsets <code class="parameter">connection</code>.  The underlying database
   connection is closed if no other resources are using it and if it
   was created with <span class="function"><a href="function.oci-connect.html" class="function">oci_connect()</a></span>
   or <span class="function"><a href="function.oci-new-connect.html" class="function">oci_new_connect()</a></span>.
  </p>
  <p class="para">
   It is recommended to close connections that are no longer needed
   because this makes database resources available for other users.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.oci-close-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">connection</code></dt>

     <dd>

      <p class="para">
       An Oracle connection identifier returned by 
       <span class="function"><a href="function.oci-connect.html" class="function">oci_connect()</a></span>, <span class="function"><a href="function.oci-pconnect.html" class="function">oci_pconnect()</a></span>,
       or <span class="function"><a href="function.oci-new-connect.html" class="function">oci_new_connect()</a></span>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.oci-close-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> on success or <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.oci-close-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="example-2203">
   <p><strong>Example #1 Closing a connection</strong></p>
   <div class="example-contents"><p>
    Resources associated with a connection should be closed to ensure
    the underlying database connection is properly terminated and the
    database resources are released.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$conn&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;hr&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;welcome&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;localhost/XE&apos;</span><span style="color: #007700">);<br>if&#xA0;(!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$e&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;message&apos;</span><span style="color: #007700">],&#xA0;</span><span style="color: #0000BB">ENT_QUOTES</span><span style="color: #007700">),&#xA0;</span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #0000BB">$stid&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;SELECT&#xA0;*&#xA0;FROM&#xA0;departments&apos;</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$r&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br></span><span style="color: #0000BB">oci_fetch_all</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;Free&#xA0;the&#xA0;statement&#xA0;identifier&#xA0;when&#xA0;closing&#xA0;the&#xA0;connection<br></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>

  <div class="example" id="example-2204">
   <p><strong>Example #2 Database connections are not closed until all references are closed</strong></p>
   <div class="example-contents"><p>
    The internal refcount of a connection identifier must be zero
    before the underlying connection to the database is closed.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$conn&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;hr&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;welcome&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;localhost/XE&apos;</span><span style="color: #007700">);<br>if&#xA0;(!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$e&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;message&apos;</span><span style="color: #007700">],&#xA0;</span><span style="color: #0000BB">ENT_QUOTES</span><span style="color: #007700">),&#xA0;</span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #0000BB">$stid&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;SELECT&#xA0;*&#xA0;FROM&#xA0;departments&apos;</span><span style="color: #007700">);&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;this&#xA0;increases&#xA0;the&#xA0;refcount&#xA0;on&#xA0;$conn<br></span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);<br></span><span style="color: #0000BB">oci_fetch_all</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$res</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;$conn&#xA0;is&#xA0;no&#xA0;longer&#xA0;usable&#xA0;in&#xA0;the&#xA0;script&#xA0;but&#xA0;the&#xA0;underlying&#xA0;database<br>//&#xA0;connection&#xA0;is&#xA0;still&#xA0;held&#xA0;open&#xA0;until&#xA0;$stid&#xA0;is&#xA0;freed.<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">);&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;prints&#xA0;NULL&#xA0;&#xA0;<br><br>//&#xA0;While&#xA0;PHP&#xA0;sleeps,&#xA0;querying&#xA0;the&#xA0;Oracle&#xA0;V$SESSION&#xA0;view&#xA0;in&#xA0;a<br>//&#xA0;terminal&#xA0;window&#xA0;will&#xA0;show&#xA0;that&#xA0;the&#xA0;database&#xA0;user&#xA0;is&#xA0;still&#xA0;connected.<br></span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">10</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;When&#xA0;$stid&#xA0;is&#xA0;freed,&#xA0;the&#xA0;database&#xA0;connection&#xA0;is&#xA0;physically&#xA0;closed<br></span><span style="color: #0000BB">oci_free_statement</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">);&#xA0;&#xA0;<br><br></span><span style="color: #FF8000">//&#xA0;While&#xA0;PHP&#xA0;sleeps,&#xA0;querying&#xA0;the&#xA0;Oracle&#xA0;V$SESSION&#xA0;view&#xA0;in&#xA0;a<br>//&#xA0;terminal&#xA0;window&#xA0;will&#xA0;show&#xA0;that&#xA0;the&#xA0;database&#xA0;user&#xA0;has&#xA0;disconnected.<br></span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">10</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>

  <div class="example" id="example-2205">
   <p><strong>Example #3 Closing a connection opened more than once</strong></p>
   <div class="example-contents"><p>
     When database credentials are reused, both connections must be closed
     before the underlying database connection is closed.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$conn1&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;hr&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;welcome&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;localhost/XE&apos;</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;Using&#xA0;the&#xA0;same&#xA0;credentials&#xA0;reuses&#xA0;the&#xA0;same&#xA0;underlying&#xA0;database&#xA0;connection<br>//&#xA0;Any&#xA0;uncommitted&#xA0;changes&#xA0;done&#xA0;on&#xA0;$conn1&#xA0;will&#xA0;be&#xA0;visible&#xA0;in&#xA0;$conn2<br></span><span style="color: #0000BB">$conn2&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;hr&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;welcome&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;localhost/XE&apos;</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;While&#xA0;PHP&#xA0;sleeps,&#xA0;querying&#xA0;the&#xA0;Oracle&#xA0;V$SESSION&#xA0;view&#xA0;in&#xA0;a<br>//&#xA0;terminal&#xA0;window&#xA0;will&#xA0;show&#xA0;that&#xA0;only&#xA0;one&#xA0;database&#xA0;user&#xA0;is&#xA0;connected.<br></span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">10</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">oci_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn1</span><span style="color: #007700">);&#xA0;</span><span style="color: #FF8000">//&#xA0;doesn&apos;t&#xA0;close&#xA0;the&#xA0;underlying&#xA0;database&#xA0;connection<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn1</span><span style="color: #007700">);&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;prints&#xA0;NULL&#xA0;because&#xA0;the&#xA0;variable&#xA0;$conn1&#xA0;is&#xA0;no&#xA0;longer&#xA0;usable<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn2</span><span style="color: #007700">);&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;displays&#xA0;that&#xA0;$conn2&#xA0;is&#xA0;still&#xA0;a&#xA0;valid&#xA0;connection&#xA0;resource<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>

  <div class="example" id="example-2206">
   <p><strong>Example #4 Connections are closed when variables go out of scope</strong></p>
   <div class="example-contents"><p>
    When all variables referencing a connection go out of scope and
    are freed by PHP, a rollback occurs (if necessary) and the
    underlying connection to the database is closed.
   </p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br></span><span style="color: #007700">function&#xA0;</span><span style="color: #0000BB">myfunc</span><span style="color: #007700">()&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$conn&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;hr&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;hrpwd&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;localhost/XE&apos;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$e&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_error</span><span style="color: #007700">();<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">trigger_error</span><span style="color: #007700">(</span><span style="color: #0000BB">htmlentities</span><span style="color: #007700">(</span><span style="color: #0000BB">$e</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;message&apos;</span><span style="color: #007700">],&#xA0;</span><span style="color: #0000BB">ENT_QUOTES</span><span style="color: #007700">),&#xA0;</span><span style="color: #0000BB">E_USER_ERROR</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$stid&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">oci_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;UPDATE&#xA0;mytab&#xA0;SET&#xA0;id&#xA0;=&#xA0;100&apos;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">oci_execute</span><span style="color: #007700">(</span><span style="color: #0000BB">$stid</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">OCI_NO_AUTO_COMMIT</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;</span><span style="color: #DD0000">&quot;Finished&quot;</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #0000BB">$r&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">myfunc</span><span style="color: #007700">();<br></span><span style="color: #FF8000">//&#xA0;At&#xA0;this&#xA0;point&#xA0;a&#xA0;rollback&#xA0;occurred&#xA0;and&#xA0;the&#xA0;underlying&#xA0;database&#xA0;connection&#xA0;was&#xA0;released.<br><br></span><span style="color: #007700">print&#xA0;</span><span style="color: #0000BB">$r</span><span style="color: #007700">;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;displays&#xA0;the&#xA0;function&#xA0;return&#xA0;value&#xA0;&quot;Finished&quot;<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div>


 <div class="refsect1 notes" id="refsect1-function.oci-close-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Variables that have a dependency on the connection identifier,
    such as statement identifiers returned
    by <span class="function"><a href="function.oci-parse.html" class="function">oci_parse()</a></span>, must also be freed before the
    underlying database connection is closed.
   </p>
  <p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    Prior to version PHP 5.1.2 (PECL OCI8
    1.1) <span class="function"><strong>oci_close()</strong></span> was a no-op. In more recent
    versions it correctly closes the Oracle
    connection. Use <a href="oci8.configuration.html#ini.oci8.old-oci-close-semantics" class="link">oci8.old_oci_close_semantics</a>
    option to restore old behavior of this function.
   </p>
  <p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    The <span class="function"><strong>oci_close()</strong></span> function does not close the
    underlying database connections created
    with <span class="function"><a href="function.oci-pconnect.html" class="function">oci_pconnect()</a></span>.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.oci-close-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.oci-connect.html" class="function" rel="rdfs-seeAlso">oci_connect()</a> - Connect to an Oracle database</span></li>
    <li class="member"><span class="function"><a href="function.oci-free-statement.html" class="function" rel="rdfs-seeAlso">oci_free_statement()</a> - Frees all resources associated with statement or cursor</span></li>
   </ul>
  </p>
 </div>


