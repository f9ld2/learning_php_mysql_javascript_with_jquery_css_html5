---
layout: default
---

  <h2 class="title">Browsing devices and services</h2>
  <p class="para">
   This example shows how to obtain information about all devices and
   services.  It starts an infinite loop (use CLI), and if any of
   available devices or services are found, the proper callback
   function will be invoked.
  </p>
  <p class="para">
   <div class="example" id="example-4921">
    <p><strong>Example #1 Search for all UPnP devices and services.</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br></span><span style="color: #FF8000">/*&#xA0;Callback&#xA0;for&#xA0;available&#xA0;device&#xA0;*/<br></span><span style="color: #007700">function&#xA0;</span><span style="color: #0000BB">device_proxy_available_cb</span><span style="color: #007700">(</span><span style="color: #0000BB">$proxy</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$arg</span><span style="color: #007700">)<br>{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$info&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">gupnp_device_info_get</span><span style="color: #007700">(</span><span style="color: #0000BB">$proxy</span><span style="color: #007700">);<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$type&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;device_type&apos;</span><span style="color: #007700">];<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$location&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;location&apos;</span><span style="color: #007700">];<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;Device&#xA0;available:\n&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;\ttype:&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;%s\n&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;\tlocation:&#xA0;%s\n&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$location</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #FF8000">/*&#xA0;Callback&#xA0;for&#xA0;available&#xA0;service&#xA0;*/<br></span><span style="color: #007700">function&#xA0;</span><span style="color: #0000BB">service_proxy_available_cb</span><span style="color: #007700">(</span><span style="color: #0000BB">$proxy</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$arg</span><span style="color: #007700">)<br>{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$info&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">gupnp_service_info_get</span><span style="color: #007700">(</span><span style="color: #0000BB">$proxy</span><span style="color: #007700">);<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$type&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;service_type&apos;</span><span style="color: #007700">];<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$location&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;location&apos;</span><span style="color: #007700">];<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;Service&#xA0;available:\n&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;\ttype:&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;%s\n&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$type</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;\tlocation:&#xA0;%s\n&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$location</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #FF8000">/*&#xA0;Create&#xA0;the&#xA0;UPnP&#xA0;context&#xA0;*/<br></span><span style="color: #0000BB">$context&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">gupnp_context_new</span><span style="color: #007700">();<br>if&#xA0;(!</span><span style="color: #0000BB">$context</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;Error&#xA0;creating&#xA0;the&#xA0;GUPnP&#xA0;context\n&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;exit(-</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #FF8000">/*&#xA0;We&apos;re&#xA0;interested&#xA0;in&#xA0;everything&#xA0;*/<br></span><span style="color: #0000BB">$cp&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">gupnp_control_point_new</span><span style="color: #007700">(</span><span style="color: #0000BB">$context</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;ssdp:all&quot;</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&#xA0;Set&#xA0;callbacks&#xA0;*/<br></span><span style="color: #0000BB">gupnp_control_point_callback_set</span><span style="color: #007700">(</span><span style="color: #0000BB">$cp</span><span style="color: #007700">,&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">GUPNP_SIGNAL_DEVICE_PROXY_AVAILABLE</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;device_proxy_available_cb&apos;</span><span style="color: #007700">);<br></span><span style="color: #0000BB">gupnp_control_point_callback_set</span><span style="color: #007700">(</span><span style="color: #0000BB">$cp</span><span style="color: #007700">,&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">GUPNP_SIGNAL_SERVICE_PROXY_AVAILABLE</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;service_proxy_available_cb&apos;</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">/*&#xA0;Start&#xA0;for&#xA0;browsing&#xA0;(infinite&#xA0;loop,&#xA0;hit&#xA0;Ctrl-C&#xA0;to&#xA0;interrupt)&#xA0;*/<br></span><span style="color: #0000BB">gupnp_control_point_browse_start</span><span style="color: #007700">(</span><span style="color: #0000BB">$cp</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 