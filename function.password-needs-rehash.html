---
layout: default
---

 <div class="refnamediv">
  <h1 class="refname">password_needs_rehash</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.5.0, PHP 7)</p><p class="refpurpose"><span class="refname">password_needs_rehash</span> &#x2014; <span class="dc-title">Checks if the given hash matches the given options</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.password-needs-rehash-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">boolean</span> <span class="methodname"><strong>password_needs_rehash</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$hash</code></span>
   , <span class="methodparam"><span class="type">integer</span> <code class="parameter">$algo</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   This function checks to see if the supplied hash implements the algorithm
   and options provided. If not, it is assumed that the hash needs to be
   rehashed.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.password-needs-rehash-parameters">
  <h3 class="title">Parameters</h3>
  <dl>

   
    <dt>
<code class="parameter">hash</code></dt>

    <dd>

     <p class="para">
      A hash created by <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span>.
     </p>
    </dd>

   
   
    <dt>
<code class="parameter">algo</code></dt>

    <dd>

     <p class="para">
      A <a href="password.constants.html" class="link">password algorithm constant</a> denoting the algorithm to use when hashing the password.
     </p>
    </dd>

   
   
    <dt>
<code class="parameter">options</code></dt>

    <dd>

     <p class="para">
      An associative array containing options. See the <a href="password.constants.html" class="link">password algorithm constants</a> for documentation on the supported options for each algorithm.
     </p>
    </dd>

   
  </dl>

 </div>

 
 <div class="refsect1 examples" id="refsect1-function.password-needs-rehash-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-962">
    <p><strong>Example #1 Usage of <span class="function"><strong>password_needs_rehash()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$password&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;rasmuslerdorf&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$hash&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;$2y$10$YCFsG6elYca568hBi2pZ0.3LDL5wjgxct1N8w/oLR/jfHsiQwCqTS&apos;</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&#xA0;The&#xA0;cost&#xA0;parameter&#xA0;can&#xA0;change&#xA0;over&#xA0;time&#xA0;as&#xA0;hardware&#xA0;improves<br></span><span style="color: #0000BB">$options&#xA0;</span><span style="color: #007700">=&#xA0;array(</span><span style="color: #DD0000">&apos;cost&apos;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #0000BB">11</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;Verify&#xA0;stored&#xA0;hash&#xA0;against&#xA0;plain-text&#xA0;password<br></span><span style="color: #007700">if&#xA0;(</span><span style="color: #0000BB">password_verify</span><span style="color: #007700">(</span><span style="color: #0000BB">$password</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$hash</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;Check&#xA0;if&#xA0;a&#xA0;newer&#xA0;hashing&#xA0;algorithm&#xA0;is&#xA0;available<br>&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;or&#xA0;the&#xA0;cost&#xA0;has&#xA0;changed<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">if&#xA0;(</span><span style="color: #0000BB">password_needs_rehash</span><span style="color: #007700">(</span><span style="color: #0000BB">$hash</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">PASSWORD_DEFAULT</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$options</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;If&#xA0;so,&#xA0;create&#xA0;a&#xA0;new&#xA0;hash,&#xA0;and&#xA0;replace&#xA0;the&#xA0;old&#xA0;one<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$newHash&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">password_hash</span><span style="color: #007700">(</span><span style="color: #0000BB">$password</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">PASSWORD_DEFAULT</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$options</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;Log&#xA0;user&#xA0;in<br></span><span style="color: #007700">}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p> 
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.password-needs-rehash-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> if the hash should be rehashed to match the given
   <code class="parameter">algo</code> and <code class="parameter">options</code>, or <strong><code>FALSE</code></strong>
   otherwise.
  </p>
 </div>

