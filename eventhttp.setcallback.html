---
layout: default
---

 <div class="refnamediv">
  <h1 class="refname">EventHttp::setCallback</h1>
  <p class="verinfo">(PECL event &gt;= 1.4.0-beta)</p><p class="refpurpose"><span class="refname">EventHttp::setCallback</span> &#x2014; <span class="dc-title">Sets a callback for specified URI</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-eventhttp.setcallback-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span>
   <span class="type"><span class="type void">void</span></span> 
   <span class="methodname"><strong>EventHttp::setCallback</strong></span>
    ( <span class="methodparam">
    <span class="type">string</span>
     <code class="parameter">$path</code>
   </span>
   , <span class="methodparam">
    <span class="type">string</span>
     <code class="parameter">$cb</code>
   </span>
   [, <span class="methodparam">
    <span class="type">string</span>
     <code class="parameter">$arg</code>
   </span>
  ] )</div>

  <p class="para rdfs-comment">
   Sets a callback for specified URI.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-eventhttp.setcallback-parameters">
  <h3 class="title">Parameters</h3>
  <dl>

   
    <dt>

     <code class="parameter">path</code>
    </dt>

    <dd>

     <p class="para">
      The path for which to invoke the callback.
     </p>
    </dd>

   
   
    <dt>

     <code class="parameter">cb</code>
    </dt>

    <dd>

     <p class="para">
      The callback
      <span class="type"><a href="language.types.callable.html" class="type callable">callable</a></span>
      that gets invoked on requested
      <code class="parameter">path</code>
      . It should match the following prototype:
     </p>
     <div class="methodsynopsis dc-description">
      <span class="type"><span class="type void">void</span></span> 
      <span class="methodname"><strong>callback</strong></span>
       ([ <span class="methodparam">
       <span class="type"><a href="class.eventhttprequest.html" class="type EventHttpRequest">EventHttpRequest</a></span>
        <code class="parameter">$req</code>
       <span class="initializer"> = NULL</span>
      </span>
      [, <span class="methodparam">
       <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span>
        <code class="parameter">$arg</code>
       <span class="initializer"> = NULL</span>
      </span>
     ]] )</div>

     <p class="para">
      <dl>

       
        <dt>

         <code class="parameter">req</code>
        </dt>

        <dd>

         <p class="para">
          <a href="class.eventhttprequest.html" class="classname">EventHttpRequest</a>
          object.
         </p>
        </dd>

       
       
        <dt>

         <code class="parameter">arg</code>
        </dt>

        <dd>

         <p class="para">
          Custom data.
         </p>
        </dd>

       
      </dl>

     </p>
    </dd>

   
   
    <dt>

     <code class="parameter">arg</code>
    </dt>

    <dd>

     <p class="para">
      Custom data.
     </p>
    </dd>

   
  </dl>

 </div>

 <div class="refsect1 returnvalues" id="refsect1-eventhttp.setcallback-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> on success. Otherwise <strong><code>FALSE</code></strong>.
  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-eventhttp.setcallback-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="example-4849">
   <p><strong>Example #1 
    <span class="function"><strong>EventHttp::setCallback()</strong></span> example</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">/*<br>&#xA0;*&#xA0;Simple&#xA0;HTTP&#xA0;server.<br>&#xA0;*<br>&#xA0;*&#xA0;To&#xA0;test&#xA0;it:<br>&#xA0;*&#xA0;1)&#xA0;Run&#xA0;it&#xA0;on&#xA0;a&#xA0;port&#xA0;of&#xA0;your&#xA0;choice,&#xA0;e.g.:<br>&#xA0;*&#xA0;$&#xA0;php&#xA0;examples/http.php&#xA0;8010<br>&#xA0;*&#xA0;2)&#xA0;In&#xA0;another&#xA0;terminal&#xA0;connect&#xA0;to&#xA0;some&#xA0;address&#xA0;on&#xA0;this&#xA0;port<br>&#xA0;*&#xA0;and&#xA0;make&#xA0;GET&#xA0;or&#xA0;POST&#xA0;request(others&#xA0;are&#xA0;turned&#xA0;off&#xA0;here),&#xA0;e.g.:<br>&#xA0;*&#xA0;$&#xA0;nc&#xA0;-t&#xA0;127.0.0.1&#xA0;8010<br>&#xA0;*&#xA0;POST&#xA0;/about&#xA0;HTTP/1.0<br>&#xA0;*&#xA0;Content-Type:&#xA0;text/plain<br>&#xA0;*&#xA0;Content-Length:&#xA0;4<br>&#xA0;*&#xA0;Connection:&#xA0;close<br>&#xA0;*&#xA0;(press&#xA0;Enter)<br>&#xA0;*<br>&#xA0;*&#xA0;It&#xA0;will&#xA0;output<br>&#xA0;*&#xA0;a=12<br>&#xA0;*&#xA0;HTTP/1.0&#xA0;200&#xA0;OK<br>&#xA0;*&#xA0;Content-Type:&#xA0;text/html;&#xA0;charset=ISO-8859-1<br>&#xA0;*&#xA0;Connection:&#xA0;close<br>&#xA0;*<br>&#xA0;*&#xA0;3)&#xA0;See&#xA0;what&#xA0;the&#xA0;server&#xA0;outputs&#xA0;on&#xA0;the&#xA0;previous&#xA0;terminal&#xA0;window.<br>&#xA0;*/<br><br></span><span style="color: #007700">function&#xA0;</span><span style="color: #0000BB">_http_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$data</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;static&#xA0;</span><span style="color: #0000BB">$counter&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;static&#xA0;</span><span style="color: #0000BB">$max_requests&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(++</span><span style="color: #0000BB">$counter&#xA0;</span><span style="color: #007700">&gt;=&#xA0;</span><span style="color: #0000BB">$max_requests</span><span style="color: #007700">)&#xA0;&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Counter&#xA0;reached&#xA0;max&#xA0;requests&#xA0;</span><span style="color: #0000BB">$max_requests</span><span style="color: #DD0000">.&#xA0;Exiting\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;exit();<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #0000BB">__METHOD__</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;&#xA0;called\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;request:&quot;</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;data:&quot;</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">);<br><br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;\n=====&#xA0;DUMP&#xA0;=====\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Command:&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getCommand</span><span style="color: #007700">(),&#xA0;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;URI:&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUri</span><span style="color: #007700">(),&#xA0;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Input&#xA0;headers:&quot;</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputHeaders</span><span style="color: #007700">());<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Output&#xA0;headers:&quot;</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getOutputHeaders</span><span style="color: #007700">());<br><br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;\n&#xA0;&gt;&gt;&#xA0;Sending&#xA0;reply&#xA0;...&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sendReply</span><span style="color: #007700">(</span><span style="color: #0000BB">200</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;OK&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;OK\n&quot;</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;\n&#xA0;&gt;&gt;&#xA0;Reading&#xA0;input&#xA0;buffer&#xA0;...\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$buf&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getInputBuffer</span><span style="color: #007700">();<br>&#xA0;&#xA0;&#xA0;&#xA0;while&#xA0;(</span><span style="color: #0000BB">$s&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$buf</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">readLine</span><span style="color: #007700">(</span><span style="color: #0000BB">EventBuffer</span><span style="color: #007700">::</span><span style="color: #0000BB">EOL_ANY</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #0000BB">$s</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;No&#xA0;more&#xA0;data&#xA0;in&#xA0;the&#xA0;buffer\n&quot;</span><span style="color: #007700">;<br>}<br><br>function&#xA0;</span><span style="color: #0000BB">_http_about</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #0000BB">__METHOD__</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;URI:&#xA0;&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUri</span><span style="color: #007700">(),&#xA0;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;\n&#xA0;&gt;&gt;&#xA0;Sending&#xA0;reply&#xA0;...&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sendReply</span><span style="color: #007700">(</span><span style="color: #0000BB">200</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;OK&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;OK\n&quot;</span><span style="color: #007700">;<br>}<br><br>function&#xA0;</span><span style="color: #0000BB">_http_default</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$data</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #0000BB">__METHOD__</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;URI:&#xA0;&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUri</span><span style="color: #007700">(),&#xA0;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;\n&#xA0;&gt;&gt;&#xA0;Sending&#xA0;reply&#xA0;...&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$req</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">sendReply</span><span style="color: #007700">(</span><span style="color: #0000BB">200</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;OK&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;OK\n&quot;</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #0000BB">$port&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">8010</span><span style="color: #007700">;<br>if&#xA0;(</span><span style="color: #0000BB">$argc&#xA0;</span><span style="color: #007700">&gt;&#xA0;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$port&#xA0;</span><span style="color: #007700">=&#xA0;(int)&#xA0;</span><span style="color: #0000BB">$argv</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">];<br>}<br>if&#xA0;(</span><span style="color: #0000BB">$port&#xA0;</span><span style="color: #007700">&lt;=&#xA0;</span><span style="color: #0000BB">0&#xA0;</span><span style="color: #007700">||&#xA0;</span><span style="color: #0000BB">$port&#xA0;</span><span style="color: #007700">&gt;&#xA0;</span><span style="color: #0000BB">65535</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;exit(</span><span style="color: #DD0000">&quot;Invalid&#xA0;port&quot;</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #0000BB">$base&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">EventBase</span><span style="color: #007700">();<br></span><span style="color: #0000BB">$http&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">EventHttp</span><span style="color: #007700">(</span><span style="color: #0000BB">$base</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$http</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setAllowedMethods</span><span style="color: #007700">(</span><span style="color: #0000BB">EventHttpRequest</span><span style="color: #007700">::</span><span style="color: #0000BB">CMD_GET&#xA0;</span><span style="color: #007700">|&#xA0;</span><span style="color: #0000BB">EventHttpRequest</span><span style="color: #007700">::</span><span style="color: #0000BB">CMD_POST</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$http</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setCallback</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;/dump&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;_http_dump&quot;</span><span style="color: #007700">,&#xA0;array(</span><span style="color: #0000BB">4</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">8</span><span style="color: #007700">));<br></span><span style="color: #0000BB">$http</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setCallback</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;/about&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;_http_about&quot;</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$http</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setDefaultCallback</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;_http_default&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;custom&#xA0;data&#xA0;value&quot;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$http</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bind</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;0.0.0.0&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">8010</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$base</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">loop</span><span style="color: #007700">();<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>The above example will output
something similar to:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
a=12
HTTP/1.0 200 OK
Content-Type: text/html; charset=ISO-8859-1
Connection: close
</pre></div>
   </div>
  </div>
 </div>

 <div class="refsect1 seealso" id="refsect1-eventhttp.setcallback-seealso">
  <h3 class="title">See Also</h3>
  <ul class="simplelist">
   <li class="member">
    <span class="methodname"><a href="eventhttp.setdefaultcallback.html" class="methodname" rel="rdfs-seeAlso">EventHttp::setDefaultCallback()</a> - Sets default callback to handle requests that are not caught by specific callbacks</span>
   </li>
  </ul>
 </div>

