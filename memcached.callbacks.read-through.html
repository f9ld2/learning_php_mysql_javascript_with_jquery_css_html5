---
layout: default
---

  <h2 class="title">Read-through cache callbacks</h2>
  <p class="para">
   Read-through cache callbacks are invoked when an item cannot be retrieved
   from the server. The callback is passed the Memcached object, the requested
   key, and the by-reference value variable. The callback is responsible for
   setting the value and returning true or false. If the callback returns true,
   Memcached will store the populated value on the server and return it to the
   original calling function. Only <span class="methodname"><a href="memcached.get.html" class="methodname">Memcached::get()</a></span> and
   <span class="methodname"><a href="memcached.getbykey.html" class="methodname">Memcached::getByKey()</a></span> support these callbacks,
   because the memcache protocol does not provide information on which keys
   were not found in the multi-key request.
  </p>
  <div class="example" id="example-4981">
   <p><strong>Example #1 Read-through callback example</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$m&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">Memcached</span><span style="color: #007700">();<br></span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">addServer</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;localhost&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">11211</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$profile_info&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$m</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;user:&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$user_id</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;user_info_cb&apos;</span><span style="color: #007700">);<br><br>function&#xA0;</span><span style="color: #0000BB">user_info_cb</span><span style="color: #007700">(</span><span style="color: #0000BB">$memc</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$key</span><span style="color: #007700">,&#xA0;&amp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)<br>{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$user_id&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">5</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">/*&#xA0;lookup&#xA0;profile&#xA0;info&#xA0;in&#xA0;the&#xA0;DB&#xA0;*/<br>&#xA0;&#xA0;&#xA0;&#xA0;/*&#xA0;...&#xA0;*/<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$value&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$profile_info</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 