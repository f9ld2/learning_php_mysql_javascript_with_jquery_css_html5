---
layout: default
---

 <h1>Examples</h1>

 
 <p class="para">
  See also the examples under <a href="wrappers.rar.html" class="link"><em>rar://</em> wrapper</a>.
 </p>
 
 <p class="para">
  <div class="example" id="example-806">
   <p><strong>Example #1 On-the-fly decompression</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br></span><span style="color: #007700">if&#xA0;(!</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;i&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">)&#xA0;||&#xA0;!</span><span style="color: #0000BB">is_numeric</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">&quot;i&quot;</span><span style="color: #007700">]))<br>&#xA0;&#xA0;&#xA0;&#xA0;die(</span><span style="color: #DD0000">&quot;Index&#xA0;unspecified&#xA0;or&#xA0;non-numeric&quot;</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$index&#xA0;</span><span style="color: #007700">=&#xA0;(int)&#xA0;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">&quot;i&quot;</span><span style="color: #007700">];<br>&#xA0;&#xA0;&#xA0;&#xA0;<br></span><span style="color: #0000BB">$arch&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">RarArchive</span><span style="color: #007700">::</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;example.rar&quot;</span><span style="color: #007700">);<br>if&#xA0;(</span><span style="color: #0000BB">$arch&#xA0;</span><span style="color: #007700">===&#xA0;</span><span style="color: #0000BB">FALSE</span><span style="color: #007700">)<br>&#xA0;&#xA0;&#xA0;&#xA0;die(</span><span style="color: #DD0000">&quot;Cannot&#xA0;open&#xA0;example.rar&quot;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$entries&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$arch</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getEntries</span><span style="color: #007700">();<br>if&#xA0;(</span><span style="color: #0000BB">$entries&#xA0;</span><span style="color: #007700">===&#xA0;</span><span style="color: #0000BB">FALSE</span><span style="color: #007700">)<br>&#xA0;&#xA0;&#xA0;&#xA0;die(</span><span style="color: #DD0000">&quot;Cannot&#xA0;retrieve&#xA0;entries&quot;</span><span style="color: #007700">);<br><br>if&#xA0;(!</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$index</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$entries</span><span style="color: #007700">))<br>&#xA0;&#xA0;&#xA0;&#xA0;die(</span><span style="color: #DD0000">&quot;No&#xA0;such&#xA0;index:&#xA0;</span><span style="color: #0000BB">$index</span><span style="color: #DD0000">&quot;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$orfilename&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$entries</span><span style="color: #007700">[</span><span style="color: #0000BB">$index</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">getName</span><span style="color: #007700">();&#xA0;</span><span style="color: #FF8000">//UTF-8&#xA0;encoded<br><br></span><span style="color: #0000BB">$filesize&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$entries</span><span style="color: #007700">[</span><span style="color: #0000BB">$index</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">getUnpackedSize</span><span style="color: #007700">();<br><br></span><span style="color: #FF8000">/*&#xA0;you&#xA0;could&#xA0;check&#xA0;HTTP_IF_MODIFIED_SINCE&#xA0;here&#xA0;and&#xA0;compare&#xA0;with<br>&#xA0;*&#xA0;$entries[$index]-&gt;getFileTime().&#xA0;You&#xA0;could&#xA0;also&#xA0;send&#xA0;a<br>&#xA0;*&#xA0;&quot;Last&#xA0;modified&quot;&#xA0;header&#xA0;*/<br><br></span><span style="color: #0000BB">$fp&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$entries</span><span style="color: #007700">[</span><span style="color: #0000BB">$index</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">getStream</span><span style="color: #007700">();<br>if&#xA0;(</span><span style="color: #0000BB">$fp&#xA0;</span><span style="color: #007700">===&#xA0;</span><span style="color: #0000BB">FALSE</span><span style="color: #007700">)<br>&#xA0;&#xA0;&#xA0;&#xA0;die(</span><span style="color: #DD0000">&quot;Cannot&#xA0;open&#xA0;file&#xA0;with&#xA0;index&#xA0;</span><span style="color: #0000BB">$index</span><span style="color: #DD0000">&#xA0;insided&#xA0;the&#xA0;archive.&quot;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$arch</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">close</span><span style="color: #007700">();&#xA0;</span><span style="color: #FF8000">//no&#xA0;longer&#xA0;needed;&#xA0;stream&#xA0;is&#xA0;independent<br><br></span><span style="color: #007700">function&#xA0;</span><span style="color: #0000BB">detectUserAgent</span><span style="color: #007700">()&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(!</span><span style="color: #0000BB">array_key_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;HTTP_USER_AGENT&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">))<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;</span><span style="color: #DD0000">&quot;Other&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$uas&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;HTTP_USER_AGENT&apos;</span><span style="color: #007700">];<br>&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;@Opera/@&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$uas</span><span style="color: #007700">))<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;</span><span style="color: #DD0000">&quot;Opera&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;@Firefox/@&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$uas</span><span style="color: #007700">))<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;</span><span style="color: #DD0000">&quot;Firefox&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;@Chrome/@&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$uas</span><span style="color: #007700">))<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;</span><span style="color: #DD0000">&quot;Chrome&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;@MSIE&#xA0;([0-9.]+);@&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$uas</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$matches</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(((float)</span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">])&#xA0;&gt;=&#xA0;</span><span style="color: #0000BB">7.0</span><span style="color: #007700">)<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;</span><span style="color: #DD0000">&quot;IE&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;</span><span style="color: #DD0000">&quot;Other&quot;</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #FF8000">/*<br>&#xA0;*&#xA0;We&#xA0;have&#xA0;3&#xA0;options:<br>&#xA0;*&#xA0;-&#xA0;For&#xA0;FF&#xA0;and&#xA0;Opera,&#xA0;which&#xA0;support&#xA0;RFC&#xA0;2231,&#xA0;use&#xA0;that&#xA0;format.<br>&#xA0;*&#xA0;-&#xA0;For&#xA0;IE&#xA0;and&#xA0;Chrome,&#xA0;use&#xA0;attwithfnrawpctenclong<br>&#xA0;*&#xA0;&#xA0;&#xA0;(http://greenbytes.de/tech/tc2231/#attwithfnrawpctenclong)<br>&#xA0;*&#xA0;-&#xA0;For&#xA0;the&#xA0;others,&#xA0;convert&#xA0;to&#xA0;ISO-8859-1,&#xA0;if&#xA0;possible<br>&#xA0;*/<br></span><span style="color: #0000BB">$formatRFC2231&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;Content-Disposition:&#xA0;attachment;&#xA0;filename*=UTF-8\&apos;\&apos;%s&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$formatDef&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;Content-Disposition:&#xA0;attachment;&#xA0;filename=&quot;%s&quot;&apos;</span><span style="color: #007700">;<br><br>switch&#xA0;(</span><span style="color: #0000BB">detectUserAgent</span><span style="color: #007700">())&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;</span><span style="color: #DD0000">&quot;Opera&quot;</span><span style="color: #007700">:<br>&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;</span><span style="color: #DD0000">&quot;Firefox&quot;</span><span style="color: #007700">:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$orfilename&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">rawurlencode</span><span style="color: #007700">(</span><span style="color: #0000BB">$orfilename</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$format&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$formatRFC2231</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;</span><span style="color: #DD0000">&quot;IE&quot;</span><span style="color: #007700">:<br>&#xA0;&#xA0;&#xA0;&#xA0;case&#xA0;</span><span style="color: #DD0000">&quot;Chrome&quot;</span><span style="color: #007700">:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$orfilename&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">rawurlencode</span><span style="color: #007700">(</span><span style="color: #0000BB">$orfilename</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$format&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$formatDef</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;<br>&#xA0;&#xA0;&#xA0;&#xA0;default:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;iconv&apos;</span><span style="color: #007700">))<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$orfilename&#xA0;</span><span style="color: #007700">=<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;@</span><span style="color: #0000BB">iconv</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;UTF-8&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;ISO-8859-1//TRANSLIT&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$orfilename</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$format&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$formatDef</span><span style="color: #007700">;<br>}<br><br></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #0000BB">$format</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$orfilename</span><span style="color: #007700">));<br></span><span style="color: #FF8000">//cannot&#xA0;send&#xA0;error&#xA0;messages&#xA0;from&#xA0;now&#xA0;on&#xA0;(headers&#xA0;already&#xA0;sent)<br><br>//replace&#xA0;by&#xA0;real&#xA0;content&#xA0;type,&#xA0;perhaps&#xA0;infering&#xA0;from&#xA0;the&#xA0;file&#xA0;extension<br></span><span style="color: #0000BB">$contentType&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&quot;application/octet-stream&quot;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;Content-Type:&#xA0;</span><span style="color: #0000BB">$contentType</span><span style="color: #DD0000">&quot;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;Content-Transfer-Encoding:&#xA0;binary&quot;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;Content-Length:&#xA0;</span><span style="color: #0000BB">$filesize</span><span style="color: #DD0000">&quot;</span><span style="color: #007700">);<br><br>if&#xA0;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;REQUEST_METHOD&apos;</span><span style="color: #007700">]&#xA0;==&#xA0;</span><span style="color: #DD0000">&quot;HEAD&quot;</span><span style="color: #007700">)<br>&#xA0;&#xA0;&#xA0;&#xA0;die();<br>&#xA0;&#xA0;&#xA0;&#xA0;<br>while&#xA0;(!</span><span style="color: #0000BB">feof</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$s&#xA0;</span><span style="color: #007700">=&#xA0;@</span><span style="color: #0000BB">fread</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">8192</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(</span><span style="color: #0000BB">$s&#xA0;</span><span style="color: #007700">===&#xA0;</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;&#xA0;</span><span style="color: #FF8000">//useless&#xA0;to&#xA0;send&#xA0;error&#xA0;messages<br>&#xA0;&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">echo&#xA0;</span><span style="color: #0000BB">$s</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="para">
  This example opens a RAR file and presents the requested file inside the RAR archive for download to the client.
 </p>
 
 <p class="para">
  <div class="example" id="example-807">
   <p><strong>Example #2 RAR extension filesystem extraction example</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br><br>$rar_file&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">rar_open</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;example.rar&apos;</span><span style="color: #007700">)&#xA0;or&#xA0;die(</span><span style="color: #DD0000">&quot;Can&apos;t&#xA0;open&#xA0;Rar&#xA0;archive&quot;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$entries&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">rar_list</span><span style="color: #007700">(</span><span style="color: #0000BB">$rar_file</span><span style="color: #007700">);<br><br>foreach&#xA0;(</span><span style="color: #0000BB">$entries&#xA0;</span><span style="color: #007700">as&#xA0;</span><span style="color: #0000BB">$entry</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&apos;Filename:&#xA0;&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$entry</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getName</span><span style="color: #007700">()&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&apos;Packed&#xA0;size:&#xA0;&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$entry</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getPackedSize</span><span style="color: #007700">()&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&apos;Unpacked&#xA0;size:&#xA0;&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$entry</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getUnpackedSize</span><span style="color: #007700">()&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;\n&quot;</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$entry</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">extract</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;/dir/extract/to/&apos;</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #0000BB">rar_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$rar_file</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="para">
  This example opens a RAR file archive and extracts each entry to the
  specified directory.
 </p>
 
