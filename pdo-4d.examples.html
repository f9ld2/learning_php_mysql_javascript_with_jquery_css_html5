---
layout: default
---

 <div class="refnamediv">
  <h1 class="refname">Examples with PDO_4D</h1>
  <p class="verinfo">(No version information available, might only be in Git)</p><p class="refpurpose"><span class="refname">Examples with PDO_4D</span> &#x2014; <span class="dc-title">Examples PDO_4D</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-pdo-4d.examples-description">
  <p class="para">
   This basic example show how to connect, execute a query,
   read data and disconnect from a 4D SQL server.
   <div class="example" id="example-1082">
    <p><strong>Example #1 Basic example with PDO_4D</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$dsn&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;4D:host=localhost;charset=UTF-8&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$user&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;test&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$pass&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;test&apos;</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&#xA0;Connection&#xA0;to&#xA0;the&#xA0;4D&#xA0;SQL&#xA0;server<br></span><span style="color: #0000BB">$db&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$pass</span><span style="color: #007700">);<br><br>try&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">exec</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;CREATE&#xA0;TABLE&#xA0;test(id&#xA0;varCHAR(1)&#xA0;NOT&#xA0;NULL,&#xA0;val&#xA0;VARCHAR(10))&apos;</span><span style="color: #007700">);<br>}&#xA0;catch&#xA0;(</span><span style="color: #0000BB">PDOException&#xA0;$e</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;die(</span><span style="color: #DD0000">&quot;Erreur&#xA0;4D&#xA0;:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$e</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">());<br>}<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<br></span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">exec</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;INSERT&#xA0;INTO&#xA0;test&#xA0;VALUES(&apos;A&apos;,&#xA0;&apos;B&apos;)&quot;</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">exec</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;INSERT&#xA0;INTO&#xA0;test&#xA0;VALUES(&apos;C&apos;,&#xA0;&apos;D&apos;)&quot;</span><span style="color: #007700">);<br></span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">exec</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;INSERT&#xA0;INTO&#xA0;test&#xA0;VALUES(&apos;E&apos;,&#xA0;&apos;F&apos;)&quot;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$stmt&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;SELECT&#xA0;id,&#xA0;val&#xA0;from&#xA0;test&apos;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">());<br><br>unset(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br>unset(</span><span style="color: #0000BB">$db</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
    Array
(
    [0] =&gt; Array
        (
            [ID] =&gt; A
            [0] =&gt; A
            [VAL] =&gt; B
            [1] =&gt; B
        )

    [1] =&gt; Array
        (
            [ID] =&gt; C
            [0] =&gt; C
            [VAL] =&gt; D
            [1] =&gt; D
        )

    [2] =&gt; Array
        (
            [ID] =&gt; E
            [0] =&gt; E
            [VAL] =&gt; F
            [1] =&gt; F
        )

)

</pre></div>
    </div>
   </div>
  </p>
 </div>

  
 <div class="refsect1 description" id="refsect1-pdo-4d.examples-description">
  <p class="para">
   This example shows how to execute a query in 4D language, 
   and how to read the result through PDO_4D.
   <div class="example" id="example-1083">
    <p><strong>Example #2 Accessing 4D language from pdo_4d</strong></p>
    <div class="example-contents"><p>
     Set up a 4D method, called <em>method</em>. Make sure
     in the method properties that the option 
     <em>Available via SQL</em> is checked. The 4D code
     is the following.
    </p></div>
    <div class="example-contents">
<div class="4dcode"><pre class="4dcode">C_TEXT($0)
$0:=Application Version(*)</pre>
</div>
    </div>

    <div class="example-contents"><p>
     The PHP code to use the above 4D method is : 
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$dsn&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;4D:host=localhost;charset=UTF-8&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$user&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;test&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$pass&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;test&apos;</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&#xA0;Connection&#xA0;to&#xA0;the&#xA0;4D&#xA0;server<br></span><span style="color: #0000BB">$db&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$pass</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$stmt&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;SELECT&#xA0;{FN&#xA0;method()&#xA0;AS&#xA0;VARCHAR&#xA0;}&#xA0;FROM&#xA0;_USER_SCHEMAS&#xA0;LIMIT&#xA0;1&apos;</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">());<br><br>unset(</span><span style="color: #0000BB">$stmt</span><span style="color: #007700">);<br>unset(</span><span style="color: #0000BB">$db</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
(
    [0] =&gt; Array
        (
            [&lt;expression&gt;] =&gt; F0011140
            [0] =&gt; F0011140
        )

)
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 description" id="refsect1-pdo-4d.examples-description">
  <p class="para">
   <div class="example" id="example-1084">
    <p><strong>Example #3 Escaping 4D table names</strong></p>
    <div class="example-contents"><p>
     This examples illustrates how to escape characters in a 
     4D SQL query.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$dsn&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;4D:host=localhost;charset=UTF-8&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$user&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;test&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$pass&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;test&apos;</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&#xA0;Connection&#xA0;to&#xA0;4D&#xA0;server&#xA0;4D<br></span><span style="color: #0000BB">$db&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">(</span><span style="color: #0000BB">$dsn</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$pass</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$objects&#xA0;</span><span style="color: #007700">=&#xA0;array(</span><span style="color: #DD0000">&apos;[&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;]&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;[]&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;][&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;[[&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;]]&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;[[[&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;]]]&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;TBL&#xA0;]]32[23&apos;</span><span style="color: #007700">);<br><br>foreach(</span><span style="color: #0000BB">$objects&#xA0;</span><span style="color: #007700">as&#xA0;</span><span style="color: #0000BB">$id&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #0000BB">$object</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$object&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;]&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;]]&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$object</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;print&#xA0;</span><span style="color: #DD0000">&quot;</span><span style="color: #0000BB">$object</span><span style="color: #DD0000">\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">exec</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;CREATE&#xA0;TABLE&#xA0;IF&#xA0;NOT&#xA0;EXISTS&#xA0;[&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$object</span><span style="color: #007700">.</span><span style="color: #DD0000">&apos;]([&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$object</span><span style="color: #007700">.</span><span style="color: #DD0000">&apos;]&#xA0;FLOAT)&apos;</span><span style="color: #007700">);<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$req&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&quot;INSERT&#xA0;INTO&#xA0;[</span><span style="color: #0000BB">$object</span><span style="color: #DD0000">]&#xA0;([</span><span style="color: #0000BB">$object</span><span style="color: #DD0000">])&#xA0;VALUES&#xA0;(</span><span style="color: #0000BB">$id</span><span style="color: #DD0000">);&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #0000BB">$req</span><span style="color: #007700">);<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$q&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;SELECT&#xA0;[</span><span style="color: #0000BB">$object</span><span style="color: #DD0000">]&#xA0;FROM&#xA0;[</span><span style="color: #0000BB">$object</span><span style="color: #DD0000">]&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$q</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">();<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$x</span><span style="color: #007700">[]&#xA0;=&#xA0;</span><span style="color: #0000BB">$q</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch</span><span style="color: #007700">(</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">FETCH_NUM</span><span style="color: #007700">);<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">exec</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;DROP&#xA0;TABLE&#xA0;[&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$object</span><span style="color: #007700">.</span><span style="color: #DD0000">&apos;];&apos;</span><span style="color: #007700">);<br>}<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
[
]]
[]]
]][
[[
]]]]
[[[
]]]]]]
TBL ]]]]32[23
</pre></div>
    </div>
   </div>
  </p>
 </div>


