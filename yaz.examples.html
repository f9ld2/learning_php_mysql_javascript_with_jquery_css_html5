---
layout: default
---

 <h1>Examples</h1>

 <p class="para">
  PHP/YAZ keeps track of connections with targets
  (Z-Associations). A resource represents a connection to a
  target.
 </p>
 <p class="para">
  The script below demonstrates the parallel searching feature of
  the API. When invoked with no arguments it prints a query form; else
  (arguments are supplied) it searches the targets as given in array
  <em>host</em>.
 </p>
 <p class="para">
  <div class="example" id="example-5234">
   <p><strong>Example #1 Parallel searching using Yaz</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$host</span><span style="color: #007700">=</span><span style="color: #0000BB">$_REQUEST</span><span style="color: #007700">[</span><span style="color: #0000BB">host</span><span style="color: #007700">];<br></span><span style="color: #0000BB">$query</span><span style="color: #007700">=</span><span style="color: #0000BB">$_REQUEST</span><span style="color: #007700">[</span><span style="color: #0000BB">query</span><span style="color: #007700">];<br></span><span style="color: #0000BB">$num_hosts&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$host</span><span style="color: #007700">);<br>if&#xA0;(empty(</span><span style="color: #0000BB">$query</span><span style="color: #007700">)&#xA0;||&#xA0;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$host</span><span style="color: #007700">)&#xA0;==&#xA0;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&apos;&lt;form&#xA0;method=&quot;get&quot;&gt;<br>&#xA0;&#xA0;&#xA0;&#xA0;&lt;input&#xA0;type=&quot;checkbox&quot;<br>&#xA0;&#xA0;&#xA0;&#xA0;name=&quot;host[]&quot;&#xA0;value=&quot;bagel.indexdata.dk/gils&quot;&#xA0;/&gt;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;GILS&#xA0;test<br>&#xA0;&#xA0;&#xA0;&#xA0;&lt;input&#xA0;type=&quot;checkbox&quot;<br>&#xA0;&#xA0;&#xA0;&#xA0;name=&quot;host[]&quot;&#xA0;value=&quot;localhost:9999/Default&quot;&#xA0;/&gt;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;local&#xA0;test<br>&#xA0;&#xA0;&#xA0;&#xA0;&lt;input&#xA0;type=&quot;checkbox&quot;&#xA0;checked=&quot;checked&quot;<br>&#xA0;&#xA0;&#xA0;&#xA0;name=&quot;host[]&quot;&#xA0;value=&quot;z3950.loc.gov:7090/voyager&quot;&#xA0;/&gt;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Library&#xA0;of&#xA0;Congress<br>&#xA0;&#xA0;&#xA0;&#xA0;&lt;br&#xA0;/&gt;<br>&#xA0;&#xA0;&#xA0;&#xA0;RPN&#xA0;Query:<br>&#xA0;&#xA0;&#xA0;&#xA0;&lt;input&#xA0;type=&quot;text&quot;&#xA0;size=&quot;30&quot;&#xA0;name=&quot;query&quot;&#xA0;/&gt;<br>&#xA0;&#xA0;&#xA0;&#xA0;&lt;input&#xA0;type=&quot;submit&quot;&#xA0;name=&quot;action&quot;&#xA0;value=&quot;Search&quot;&#xA0;/&gt;<br>&#xA0;&#xA0;&#xA0;&#xA0;&lt;/form&gt;<br>&#xA0;&#xA0;&#xA0;&#xA0;&apos;</span><span style="color: #007700">;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<br>}&#xA0;else&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&apos;You&#xA0;searched&#xA0;for&#xA0;&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">)&#xA0;.&#xA0;</span><span style="color: #DD0000">&apos;&lt;br&#xA0;/&gt;&apos;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;for&#xA0;(</span><span style="color: #0000BB">$i&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">$i&#xA0;</span><span style="color: #007700">&lt;&#xA0;</span><span style="color: #0000BB">$num_hosts</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$id</span><span style="color: #007700">[]&#xA0;=&#xA0;</span><span style="color: #0000BB">yaz_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$host</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">yaz_syntax</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">],&#xA0;</span><span style="color: #DD0000">&quot;usmarc&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">yaz_range</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">],&#xA0;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">10</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">yaz_search</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">],&#xA0;</span><span style="color: #DD0000">&quot;rpn&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">yaz_wait</span><span style="color: #007700">();<br>&#xA0;&#xA0;&#xA0;&#xA0;for&#xA0;(</span><span style="color: #0000BB">$i&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">$i&#xA0;</span><span style="color: #007700">&lt;&#xA0;</span><span style="color: #0000BB">$num_hosts</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&apos;&lt;hr&#xA0;/&gt;&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$host</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&apos;:&apos;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$error&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">yaz_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(!empty(</span><span style="color: #0000BB">$error</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Error:&#xA0;</span><span style="color: #0000BB">$error</span><span style="color: #DD0000">&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}&#xA0;else&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$hits&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">yaz_hits</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Result&#xA0;Count&#xA0;</span><span style="color: #0000BB">$hits</span><span style="color: #DD0000">&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&apos;&lt;dl&gt;&apos;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;for&#xA0;(</span><span style="color: #0000BB">$p&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">1</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">$p&#xA0;</span><span style="color: #007700">&lt;=&#xA0;</span><span style="color: #0000BB">10</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">$p</span><span style="color: #007700">++)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$rec&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">yaz_record</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">],&#xA0;</span><span style="color: #0000BB">$p</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;string&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(empty(</span><span style="color: #0000BB">$rec</span><span style="color: #007700">))&#xA0;continue;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;dt&gt;&lt;b&gt;</span><span style="color: #0000BB">$p</span><span style="color: #DD0000">&lt;/b&gt;&lt;/dt&gt;&lt;dd&gt;&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #0000BB">nl2br</span><span style="color: #007700">(</span><span style="color: #0000BB">$rec</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;/dd&gt;&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&apos;&lt;/dl&gt;&apos;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
