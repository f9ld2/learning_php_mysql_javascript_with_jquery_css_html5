---
layout: default
---

 <div class="refnamediv">
  <h1 class="refname">mssql_next_result</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.5, PHP 5, PECL odbtp &gt;= 1.1.1)</p><p class="refpurpose"><span class="refname">mssql_next_result</span> &#x2014; <span class="dc-title">Move the internal result pointer to the next result</span></p>

 </div>
 
 <div id="function.mssql-next-result-refsynopsisdiv">
  <div class="warning"><strong class="warning">Warning</strong>
   
<p class="para">
 This function was <em class="emphasis">REMOVED</em> in PHP 7.0.0.
</p>
<p class="para">
 Alternatives to this function include:
</p>

   <ul class="simplelist">
    <li class="member"><span class="function"><a href="pdostatement.nextrowset.html" class="function">PDOStatement::nextRowset()</a></span></li>
    <li class="member"><span class="function"><a href="function.sqlsrv-next-result.html" class="function">sqlsrv_next_result()</a></span></li>
    <li class="member"><span class="function"><a href="function.odbc-next-result.html" class="function">odbc_next_result()</a></span></li>
   </ul>
  </div>
 </div>

 <div class="refsect1 description" id="refsect1-function.mssql-next-result-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>mssql_next_result</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result_id</code></span>
   )</div>

  <p class="para rdfs-comment">
   When sending more than one SQL statement to the server or
   executing a stored procedure with multiple results, it will cause
   the server to return multiple result sets. This function will
   test for additional results available form the server. If an
   additional result set exists it will free the existing result set
   and prepare to fetch the rows from the new result set.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mssql-next-result-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">result_id</code></dt>

     <dd>

      <p class="para">
       The result resource that is being evaluated. This result comes from a
       call to <span class="function"><a href="function.mssql-query.html" class="function">mssql_query()</a></span>.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mssql-next-result-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> if an additional result set was available or <strong><code>FALSE</code></strong>
   otherwise.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mssql-next-result-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-1772">
    <p><strong>Example #1 <span class="function"><strong>mssql_next_result()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&#xA0;Connect&#xA0;to&#xA0;MSSQL&#xA0;and&#xA0;select&#xA0;the&#xA0;database<br></span><span style="color: #0000BB">$link&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">mssql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;MANGO\SQLEXPRESS&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;sa&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;phpfi&apos;</span><span style="color: #007700">);<br></span><span style="color: #0000BB">mssql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;php&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;Send&#xA0;a&#xA0;query&#xA0;to&#xA0;MSSQL<br></span><span style="color: #0000BB">$sql&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;SELECT&#xA0;[name],&#xA0;[age]&#xA0;FROM&#xA0;[php].[dbo].[persons]&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$query&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">mssql_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;Iterate&#xA0;through&#xA0;returned&#xA0;records<br></span><span style="color: #007700">do&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;while&#xA0;(</span><span style="color: #0000BB">$row&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">mssql_fetch_row</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;Handle&#xA0;record&#xA0;...<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">}<br>}&#xA0;while&#xA0;(</span><span style="color: #0000BB">mssql_next_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">));<br><br></span><span style="color: #FF8000">//&#xA0;Clean&#xA0;up<br></span><span style="color: #0000BB">mssql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br></span><span style="color: #0000BB">mssql_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


