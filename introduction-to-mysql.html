---
layout: default
title: "Introduction to MySQL"
---
<h2>Introduction to MySQL</h2>
<span>With well over 10 million installations, MySQL is probably the most popular database</span>
<span>management system for web servers. Developed in the mid-1990s, it&rsquo;s now a mature</span>
<span>technology that powers many of today&rsquo;s most-visited Internet destinations.</span>
<br/>
<span>One reason for its success must be the fact that, like PHP, it&rsquo;s free to use. But it&rsquo;s also</span>
<span>extremely powerful and exceptionally fast&mdash;it can run on even the most basic of</span>
<span>hardware, and it hardly puts a dent in system resources.</span>
<br/>
<span>MySQL is also highly scalable, which means that it can grow with your website (for</span>
<span>the latest benchmarks, see</span>
<span>http://mysql.com/why-mysql/benchmarks</span>
<span>).</span>
<h3>MySQL Basics</h3>
<span>A</span>
<span>database</span>
<span>is a structured collection of records or data stored in a computer system</span>
<span>and organized in such a way that it can be quickly searched and information can be</span>
<span>rapidly retrieved.</span>
<br/>
<span>The</span>
<span>SQL</span>
<span>in MySQL stands for</span>
<span>Structured Query Language</span>
<span>. This language is loosely</span>
<span>based on English and also used in other databases such as Oracle and Microsoft SQL</span>
<span>Server. It is designed to allow simple requests from a database via commands such as</span>
<pre><code class="sql">SELECT title FROM publications WHERE author = 'Charles Dickens';</code></pre>
<span>A MySQL database contains one or more</span>
<span>tables</span>
<span>, each of which contains</span>
<span>records</span>
<span>or</span>
<span>rows</span>
<span>. Within these rows are various</span>
<span>&nbsp;columns</span>
<span>&nbsp;or</span>
<span>fields</span>
<span>&nbsp;that contain the data itself.</span>
<span>Table 8-1</span>
<span>shows the contents of an example database of five publications detailing the</span>
<span>author, title, type, and year of publication.</span>
<br/>
<span>Table 8-1. Example of a simple database</span>
<table class="tbl-left">
    <tr>
        <td>Author</td>
        <td>Title</td>
        <td>Type</td>
        <td>Year</td>
    </tr>
    <tr>
        <td>Mark Twain</td>
        <td>The Adventures of Tom Sawyer</td>
        <td>Fiction</td>
        <td>1876</td>
    </tr>
    <tr>
        <td>Jane Austen</td>
        <td>Pride and Prejudice</td>
        <td>Fiction</td>
        <td>1811</td>
    </tr>
    <tr>
        <td>Charles Darwin</td>
        <td>The Origin of Species</td>
        <td>Nonfiction</td>
        <td>1856</td>
    </tr>
    <tr>
        <td>Charles Dickens</td>
        <td>The Old Curiosity Shop</td>
        <td>Fiction</td>
        <td>1841</td>
    </tr>
    <tr>
        <td>William Shakespeare</td>
        <td>Romeo and Juliet</td>
        <td>Play</td>
        <td>1594</td>
    </tr>
</table><br/>
<span>Each row in the table is the same as a row in a MySQL table, and each element within</span>
<span>a row is the same as a MySQL field.</span>
<br/>
<span>To uniquely identify this database, I&rsquo;ll refer to it as the</span>
<span>&nbsp;publications</span>
<span>&nbsp;database in the</span>
<span>examples that follow. And, as you will have observed, all these publications are considered to be classics of literature, so I&rsquo;ll call the table within the database that holds</span>
<span>the details</span>
<span>classics</span>
<span>.</span>
<h3>Summary of Database Terms</h3>
<span>The main terms you need to acquaint yourself with for now are as follows:</span>
<br/>
<span>Database</span>
<div class="t30">The overall container for a collection of MySQL data</div>
<span>Table</span>
<div class="t30">A subcontainer within a database that stores the actual data</div>
<span>Row</span>
<div class="t30">A single record within a table, which may contain several fields</div>
<span>Column</span>
<div class="t30">The name of a field within a row</div><br/>
<span>I should note that I&rsquo;m not trying to reproduce the precise terminology used in academic literature about relational databases, but just to provide simple, everyday terms</span>
<span>to help you quickly grasp basic concepts and get started with a database.</span>
<h3>Accessing MySQL via the Command Line</h3>
<span>There are three main ways in which you can interact with MySQL: using a command</span>
<span>line, via a web interface such as phpMyAdmin, and through a programming language</span>
<span>like PHP. We&rsquo;ll start doing the third of these in</span>
<span>Chapter 10</span>
<span>, but for now, let&rsquo;s look at</span>
<span>the first two.</span>
<h4>Starting the Command-Line Interface</h4>
<span>The following sections describe relevant instructions for Windows, OS X, and Linux.</span>
<h6>Windows users</h6>
<span>If you installed XAMPP (as explained in</span>
<span>&nbsp;Chapter 2</span>
<span>), you will be able to access the</span>
<span>MySQL executable from the following directory:</span>
<pre><code class="bash">C:\xampp\mysql\bin</code></pre>
<span>If you installed XAMPP in a place other than</span>
<span>&nbsp;\xampp</span>
<span>, you will</span>
<span>need to use that directory instead.</span>
<br/>
<span>By default, the initial MySQL user will be</span>
<span>root</span>
<span>and will not have had a password set.</span>
<span>Seeing as this is a development server that only you should be able to access, we won&rsquo;t</span>
<span>worry about creating one yet.</span>
<br/>
<span>So, to enter MySQL&rsquo;s command-line interface, select Start&rarr;Run, enter</span>
<span>CMD</span>
<span>into the</span>
<span>Run box, and press Return. This will call up a Windows command prompt. From</span>
<span>there, enter one the following (making any appropriate changes as just discussed):</span>
<pre><code class="bash">C:\xampp\mysql\bin\mysql -u root</code></pre>
<span>This command tells MySQL to log you in as user</span>
<span>root</span>
<span>, without a password. You will</span>
<span>now be logged into MySQL and can start entering commands. So, to be sure everything is working as it should be, enter the following; the results should be similar to</span>
<span>Figure 8-1</span>
<span>:</span>
<pre><code class="sql">SHOW databases;</code></pre>
<p><img src="images/8.1.png"/></p>
<span>Figure 8-1. Accessing MySQL from a Windows command prompt</span>
<br/>
<span>You are now ready to move on to the next section,</span>
<span>&ldquo;Using the Command-Line Interface&rdquo; on page 171</span>
<span>.</span>
<h6>OS X users</h6>
<span>To proceed with this chapter, you should have installed XAMPP as detailed in</span>
<span>Chapter 2</span>
<span>. You should also have the web server running and the MySQL server started.</span>
<br/>
<span>To enter the MySQL command-line interface, start the Terminal program (which</span>
<span>should be available in Finder&rarr;Utilities). Then call up the MySQL program, which</span>
<span>will have been installed in the directory</span>
<span>/Applications/xampp/bin</span>
<span>.</span>
<br/>
<span>By default, the initial MySQL user is</span>
<span>root</span>
<span>, and it will have a password of</span>
<span>root</span>
<span>too. So,</span>
<span>to start the program, type the following:</span>
<pre><code class="bash">/Applications/xampp/bin/mysql -u root</code></pre>
<span>This command tells MySQL to log you in as user</span>
<span>root</span>
<span>and not to request your password. To verify that all is well, type the following;</span>
<span>Figure 8-2</span>
<span>should be the result:</span>
<br/>
<pre><code class="sql">SHOW databases;</code></pre>
<p><img src="images/8.2.png"/></p>
<span>Figure 8-2. Accessing MySQL from the OS X Terminal program</span>
<span>If you receive an error such as &ldquo;Can&rsquo;t connect to local MySQL server through socket,&rdquo;</span>
<span>you will need to first start the MySQL server as described in</span>
<span>Chapter 2</span>
<span>.</span>
<span>You should now be ready to move on to the next section,</span>
<span>&ldquo;Using the Command-Line</span>
<span>Interface&rdquo; on page 171</span>
<span>.</span>
<h6>Linux users</h6>
<span>On a system running a Unix-like operating system such as Linux, you will almost certainly already have PHP and MySQL installed and running, and you will be able to</span>
<span>enter the examples in the next section (if not, you can follow the procedure outlined</span>
<span>in</span>
<span>Chapter 2</span>
<span>to install XAMPP). First you should type the following to log into your</span>
<span>MySQL system:</span>
<pre><code class="bash">mysql -u root -p</code></pre>
<span>This tells MySQL to log you in as the user</span>
<span>root</span>
<span>and to request your password. If you</span>
<span>have a password, enter it; otherwise, just press Return.</span>
<br/>
<span>Once you are logged in, type the following to test the program; you should see something like</span>
<span>Figure 8-3</span>
<span>in response:</span>
<pre><code class="sql">SHOW databases;</code></pre>
<p><img src="images/8.3.png"/></p>
<span>Figure 8-3. Accessing MySQL using Linux</span>
<span>If this procedure fails at any point, please refer to</span>
<span>Chapter 2</span>
<span>to ensure that you have</span>
<span>MySQL properly installed. Otherwise, you should now be ready to move on to the</span>
<span>next section,</span>
<span>&ldquo;Using the Command-Line Interface&rdquo; on page 171</span>
<span>.</span>
<h6>MySQL on a remote server</h6>
<span>If you are accessing MySQL on a remote server, you should Telnet (or preferably, for</span>
<span>security, use SSH) into the remote machine, which will probably be a Linux/FreeBSD/</span>
<span>Unix type of box. Once in there, you might find that things are a little different,</span>
<span>depending on how the system administrator has set the server up, especially if it&rsquo;s a</span>
<span>shared hosting server. Therefore, you need to ensure that you have been given access</span>
<span>to MySQL and that you have your username and password. Armed with these, you</span>
<span>can then type the following, where</span>
<span>username</span>
<span>is the name supplied:</span>
<pre><code class="sql">mysql -u username -p</code></pre>
<span>Enter your password when prompted. You can then try the following command,</span>
<span>which should result in something like</span>
<span>Figure 8-3</span>
<span>:</span>
<pre><code class="sql">SHOW databases;</code></pre>
<span>There may be other databases already created, and the</span>
<span>test</span>
<span>database may not be there.</span>
<br/>
<span>Bear in mind also that system administrators have ultimate control over everything</span>
<span>and that you can encounter some unexpected setups. For example, you may find that</span>
<span>you are required to preface all database names that you create with a unique identifying string to ensure that you do not conflict with databases created by other users.</span>
<br/>
<span>Therefore, if you have any problems, talk with your system administrator, who will</span>
<span>get you sorted out. Just let the sysadmin know that you need a username and</span>
<span>password. You should also ask for the ability to create new databases or, at a minimum, to have at least one database created for you ready to use. You can then create</span>
<span>all the tables you require within that database.</span>
<h4>Using the Command-Line Interface</h4>
<span>From here on out, it makes no difference whether you are using Windows, Mac OS</span>
<span>X, or Linux to access MySQL directly, as all the commands used (and errors you may</span>
<span>receive) are identical.</span>
<h6>The semicolon</h6>
<span>Let&rsquo;s start with the basics. Did you notice the semicolon (</span>
<span>;</span>
<span>) at the end of the</span>
<span>SHOW</span>
<span>databases;</span>
<span>command that you typed? The semicolon is used by MySQL to separate</span>
<span>or end commands. If you forget to enter it, MySQL will issue a prompt and wait for</span>
<span>you to do so. The required semicolon was made part of the syntax to let you enter</span>
<span>multiple-line commands, which can be convenient because some commands get quite</span>
<span>long. It also allows you to issue more than one command at a time by placing a semicolon after each one. The interpreter gets them all in a batch when you press the</span>
<span>Enter (or Return) key and executes them in order.</span>
<br/>
<span>It&rsquo;s very common to receive a MySQL prompt instead of the results</span>
<span>of your command; it means that you forgot the final semicolon.</span>
<span>Just enter the semicolon and press the Enter key, and you&rsquo;ll get</span>
<span>what you want.</span>
<br/>
<span>There are six different prompts that MySQL may present you with (see</span>
<span>Table 8-2</span>
<span>), so</span>
<span>you will always know where you are during a multiline input.</span>
<br/>
<span>Table 8-2. MySQL&rsquo;s six command prompts</span>
<table class="tbl-left">
    <tr>
        <td>MySQL prompt</td>
        <td>Meaning</td>
    </tr>
    <tr>
        <td>mysql&gt;</td>
        <td>Ready and waiting for a command</td>
    </tr>
    <tr>
        <td>-&gt;</td>
        <td>Waiting for the next line of a command</td>
    </tr>
    <tr>
        <td>'&gt;</td>
        <td>Waiting for the next line of a string started with a single quote</td>
    </tr>
    <tr>
        <td>"&gt;</td>
        <td>Waiting for the next line of a string started with a double quote</td>
    </tr>
    <tr>
        <td>`&gt;</td>
        <td>Waiting for the next line of a string started with a back tick</td>
    </tr>
    <tr>
        <td>/*&gt;</td>
        <td>Waiting for the next line of a comment started with /*</td>
    </tr>
</table>
<h6>Canceling a command</h6>
<span>If you are partway through entering a command and decide you don&rsquo;t wish to execute</span>
<span>it after all, whatever you do,</span>
<span>&nbsp;don&rsquo;t press Control-C</span>
<span>! That will close the program.</span>
<span>Instead, you can enter</span>
<span>\c</span>
<span>and press Return.</span>
<span>Example 8-1</span>
<span>shows how to use it.</span>
<br/>
<span>Example 8-1. Canceling a line of input</span>
<pre><code class="sql">meaningless gibberish to mysql \c</code></pre>
<span>When you type that line, MySQL will ignore everything you typed and issue a new</span>
<span>prompt. Without the</span>
<span>\c</span>
<span>, it would have displayed an error message. Be careful,</span>
<span>though: if you have opened a string or comment, close it first before using the</span>
<span>\c</span>
<span>or</span>
<span>MySQL will think the</span>
<span>\c</span>
<span>is just part of the string.</span>
<span>Example 8-2</span>
<span>shows the right way to</span>
<span>do this.</span>
<span>Example 8-2. Canceling input from inside a string</span>
<br/>
<b class="t30">this is "meaningless gibberish to mysql" \c</b>
<br/>
<span>Also note that using</span>
<span>\c</span>
<span>after a semicolon will not work, as it is then a new statement.</span>
<h4>MySQL Commands</h4>
<span>You&rsquo;ve already seen the</span>
<span>SHOW</span>
<span>command, which lists tables, databases, and many other</span>
<span>items. The commands you&rsquo;ll use most often are listed in</span>
<span>Table 8-3</span>
<span>.</span>
<br/>
<span>Table 8-3. Common MySQL commands</span>
<table class="tbl-left">
    <tr>
         <td>Command</td>
        <td>Action</td>
    </tr>
    <tr>
        <td>ALTER</td>
        <td>Alter a database or table</td>
    </tr>
    <tr>
        <td>BACKUP</td>
        <td>Back up a table</td>
    </tr>
    <tr>
        <td>\c</td>
        <td>Cancel input</td>
    </tr>
    <tr>
        <td>CREATE</td>
        <td>Create a database</td>
    </tr>
    <tr>
        <td>DELETE</td>
        <td>Delete a row from a table</td>
    </tr>
    <tr>
        <td>DESCRIBE</td>
        <td>Describe a table&rsquo;s columns</td>
    </tr>
    <tr>
        <td>DROP</td>
        <td>Delete a database or table</td>
    </tr>
    <tr>
        <td>EXIT (CTRL-C)</td>
        <td>Exit</td>
    </tr>
    <tr>
        <td>GRANT</td>
        <td>Change user privileges</td>
    </tr>
    <tr>
        <td>HELP (\h, \?)</td>
        <td>Display help</td>
    </tr>
    <tr>
        <td>INSERT</td>
        <td>Insert data</td>
    </tr>
    <tr>
        <td>LOCK</td>
        <td>Lock table(s)</td>
    </tr>
    <tr>
        <td>QUIT (\q)</td>
        <td>Same as EXIT</td>
    </tr>
    <tr>
        <td>RENAME</td>
        <td>Rename a table</td>
    </tr>
    <tr>
        <td>SHOW</td>
        <td>List details about an object</td>
    </tr>
    <tr>
        <td>SOURCE</td>
        <td>Execute a file</td>
    </tr>
    <tr>
        <td>STATUS (\s)</td>
        <td>Display the current status</td>
    </tr>
    <tr>
        <td>TRUNCATE</td>
        <td>Empty a table</td>
    </tr>
    <tr>
        <td>UNLOCK</td>
        <td>Unlock table(s)</td>
    </tr>
    <tr>
        <td>UPDATE</td>
        <td>Update an existing record</td>
    </tr>
    <tr>
        <td>USE</td>
        <td>Use a database</td>
    </tr>
</table>

<br/>
<span>I&rsquo;ll cover most of these as we proceed, but first, you need to remember a couple of</span>
<span>points about MySQL commands:</span>
<br/>
<span>&bull;</span>
<span>SQL commands and keywords are case-insensitive.</span>
<span>CREATE</span>
<span>,</span>
<span>create</span>
<span>, and</span>
<span>CrEaTe</span>
<span>all mean the same thing. However, for the sake of clarity, the recommended style</span>
<span>is to use uppercase.</span>
<br/>
<span>&bull;</span>
<span>Table names are case-sensitive on Linux and OS X, but case-insensitive on Windows. So for portability purposes, you should always choose a case and stick to it.</span>
<span>The recommended style is to use lowercase for tables.</span>
<h6>Creating a database</h6>
<span>If you are working on a remote server and have only a single user account and access</span>
<span>to a single database that was created for you, move on to the section</span>
<span>&ldquo;Creating a table&rdquo;</span>
<span>on page 175</span>
<span>. Otherwise, get the ball rolling by issuing the following command to create a new database called</span>
<span>publications</span>
<span>:</span>
<pre><code class="sql">CREATE DATABASE publications;</code></pre>
<span>A successful command will return a message that doesn&rsquo;t mean much yet&mdash;</span>
<span>Query OK,</span>
<span>1 row affected (0.00 sec)</span>
<span>&mdash;</span>
<span>but will make sense soon. Now that you&rsquo;ve created</span>
<span>the database, you want to work with it, so issue the following:</span>
<pre><code class="sql">USE publications;</code></pre>
<span>You should now see the message</span>
<span>Database changed</span>
<span>and will then be set to proceed</span>
<span>with the following examples.</span>
<h6>Creating users</h6>
<span>Now that you&rsquo;ve seen how easy it is to use MySQL, and created your first database, it&rsquo;s</span>
<span>time to look at how you create users, as you probably won&rsquo;t want to grant your PHP</span>
<span>scripts root access to MySQL; it could cause a real headache should you get hacked.</span>
<span>To create a user, issue the</span>
<span>GRANT</span>
<span>command, which takes the following form (don&rsquo;t</span>
<span>type this in; it&rsquo;s not an actual working command):</span>
<pre>
<code class="sql">
    GRANT PRIVILEGES ON database.object TO 'username'@'hostname'
    IDENTIFIED BY 'password';
</code>
</pre>
<span>This should be pretty straightforward, with the possible exception of the</span>
<span>data</span>
<span>base.object</span>
<span>part, which refers to the database itself and the objects it contains, such</span>
<span>as tables (see</span>
<span>Table 8-4</span>
<span>).</span>
<br/>
<span>Table 8-4. Example parameters for the GRANT command</span>
<table class="tbl-left">
    <tr>
        <td>Arguments</td>
        <td>Meaning</td>
    </tr>
    <tr>
        <td>*.*</td>
        <td>All databases and all their objects</td>
    </tr>
    <tr>
        <td>database.*</td>
        <td>Only the database called database and all its objects</td>
    </tr>
    <tr>
        <td>database.object</td>
        <td>Only the database called database and its object called object</td>
    </tr>
</table>
<br/>
<span>So let&rsquo;s create a user who can access just the new</span>
<span>&nbsp;publications</span>
<span>&nbsp;database and all its</span>
<span>objects, by entering the following (replacing the username</span>
<span>jim</span>
<span>and also the password</span>
<span>mypasswd</span>
<span>with ones of your choosing):</span>
<pre>
<code class="sql">
    GRANT ALL ON publications.* TO 'jim'@'localhost'
    IDENTIFIED BY 'mypasswd';
</code>
</pre>
<span>What this does is allow the user</span>
<span>jim@localhost</span>
<span>full access to the</span>
<span>publications</span>
<span>database</span>
<span>using the password</span>
<span>mypasswd</span>
<span>. You can test whether this step has worked by entering</span>
<span>quit</span>
<span>to exit and then rerunning MySQL the way you did before, but instead of entering</span>
<span>-u root -p</span>
<span>, type</span>
<span>-u jim -p</span>
<span>, or whatever username you created. See</span>
<span>Table 8-5</span>
<span>for</span>
<span>the correct command for your operating system. Modify it as necessary if the</span>
<span>mysql</span>
<span>client program is installed in a different directory on your system.</span>
<br/>
<span>Table 8-5. Starting MySQL and logging in as jim@localhost</span>
<table class="tbl-left">
    <tr>
        <td>OS</td>
        <td>Example command</td>
    </tr>
    <tr>
        <td>Windows</td>
        <td>C:\xampp\mysql\bin\mysql -u jim -p</td>
    </tr>
    <tr>
        <td>Mac OS X</td>
        <td>/Applications/xampp/bin/mysql -u jim -p</td>
    </tr>
    <tr>
        <td>Linux</td>
        <td>mysql -u jim &ndash;p</td>
    </tr>
</table>
<br/>
<span>All you have to do now is enter your password when prompted and you will be logged in. If you prefer, you can place your password immediately following the</span>
<span>-p</span>
<span>(without any spaces) to avoid having to enter it when prompted. But this is considered a poor practice, because if other people are logged into your system, there may</span>
<span>be ways for them to look at the command you entered and find out your password.</span>
<br/>
<span>You can grant only privileges that you already have, and you must</span>
<span>also have the privilege to issue</span>
<span>GRANT</span>
<span>commands. There are a whole</span>
<span>range of privileges you can choose to grant if you are not granting</span>
<span>all privileges. For further details, please visit the following site,</span>
<span>which also covers the</span>
<span>REVOKE</span>
<span>command, which can remove privileges once granted:</span>
<span>&nbsp;http://tinyurl.com/mysqlgrant</span>
<span>. Also be aware</span>
<span>that if you create a new user but do not specify an</span>
<span>IDENTIFIED BY</span>
<span>clause, the user will have no password, a situation that is very insecure and should be avoided.</span>
<h6>Creating a table</h6>
<span>At this point, you should now be logged into MySQL with</span>
<span>ALL</span>
<span>privileges granted for</span>
<span>the database</span>
<span>publications</span>
<span>(or a database that was created for you), so you&rsquo;re ready to</span>
<span>create your first table. Make sure the correct database is in use by typing the following</span>
<span>(replacing</span>
<span>publications</span>
<span>with the name of your database if it is different):</span>
<pre><code class="sql">USE publications;</code></pre>
<span>Now enter the commands in</span>
<span>Example 8-3</span>
<span>one line at a time.</span>
<br/>
<span>Example 8-3. Creating a table called classics</span>
<pre>
<code class="sql">
CREATE TABLE classics (
    author VARCHAR(128),
    title VARCHAR(128),
    type VARCHAR(16),
    year CHAR(4)
) ENGINE MyISAM;
</code>
</pre>
<span>You could also issue this command on a single line, like this:</span>
<span>CREATE TABLE classics (author VARCHAR(128), title</span>
<span>VARCHAR(128), type VARCHAR(16), year CHAR(4)) ENGINE</span>
<span>MyISAM;</span>
<br/>
<span>but MySQL commands can be long and complicated, so I recommend a single line at a time until you are comfortable with longer</span>
<span>ones.</span>
<br/>
<span>MySQL should then issue the response</span>
<span>Query OK, 0 rows affected</span>
<span>, along with how</span>
<span>long it took to execute the command. If you see an error message instead, check your</span>
<span>syntax carefully. Every parenthesis and comma counts, and typing errors are easy to</span>
<span>make. In case you are wondering, the</span>
<span>ENGINE MyISAM</span>
<span>tells MySQL the type of database engine to use for this table.</span>
<br/>
<span>To check whether your new table has been created, type the following:</span>
<pre><code class="sql">DESCRIBE classics;</code></pre>
<span>All being well, you will see the sequence of commands and responses shown in</span>
<span>Example 8-4</span>
<span>, where you should particularly note the table format displayed.</span>
<br/>
<span>Example 8-4. A MySQL session: creating and checking a new table</span>
<pre>
<code class="php">
mysql&gt; USE publications;
Database changed
mysql&gt; CREATE TABLE classics (
-&gt; author VARCHAR(128),
-&gt; title VARCHAR(128),
-&gt; type VARCHAR(16),
-&gt; year CHAR(4)) ENGINE MyISAM;
Query OK, 0 rows affected (0.03 sec)

mysql&gt; DESCRIBE classics;
+--------+--------------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+--------+--------------+------+-----+---------+-------+
| author | varchar(128) | YES | | NULL | |
| title | varchar(128) | YES | | NULL | |
| type | varchar(16) | YES | | NULL | |
| year | char(4) | YES | | NULL | |
+--------+--------------+------+-----+---------+-------+
4 rows in set (0.00 sec)
</code>
</pre>
<span>The</span>
<span>DESCRIBE</span>
<span>command is an invaluable debugging aid when you need to ensure that</span>
<span>you have correctly created a MySQL table. You can also use it to remind yourself</span>
<span>about a table&rsquo;s field or column names and the types of data in each one. Let&rsquo;s look at</span>
<span>each of the headings in detail:</span>
<br/>
<span>Field</span>
<div class="t30">The name of each field or column within a table.</div>

<span>Type</span>
<div class="t30">The type of data being stored in the field.</div>

<span>Null</span>
<div class="t30">Whether a field is allowed to contain a value of NULL.</div>

<span>Key</span>
<div class="t30">MySQL supports &nbsp;keys &nbsp;or &nbsp;indexes , which are quick ways to look up and search for data. The Key heading shows what type of key (if any) has been applied.</div>

<span>Default</span>
<div class="t30">The default value that will be assigned to the field if no value is specified when a new row is created.</div>

<span>Extra</span><br/>
<span>Additional information, such as whether a field is set to auto-increment.</span>
<h4>Data Types</h4>
<span>In</span>
<span>Example 8-3</span>
<span>, you may have noticed that three of the table&rsquo;s fields were given the</span>
<span>data type of</span>
<span>VARCHAR</span>
<span>, and one was given the type</span>
<span>CHAR</span>
<span>. The term</span>
<span>VARCHAR</span>
<span>stands for</span>
<span>VARiable length</span>
<span>CHARacter string</span>
<span>, and the command takes a numeric value that tells</span>
<span>MySQL the maximum length allowed for a string stored in this field.</span>
<br/>
<span>This data type is very useful, as MySQL can then plan the size of databases and perform lookups and searches more easily. The downside is that if you ever attempt to</span>
<span>assign a string value longer than the length allowed, it will be truncated to the maximum length declared in the table definition.</span>
<br/>
<span>The</span>
<span>year</span>
<span>field, however, has more-predictable values, so instead of</span>
<span>VARCHAR</span>
<span>we use</span>
<span>the more efficient</span>
<span>CHAR(4)</span>
<span>data type. The parameter of</span>
<span>4</span>
<span>allows for 4 bytes of data,</span>
<span>supporting all years from &ndash;999 to 9999; a byte comprises 8 bits and can have the values 00000000 through 11111111, which are 0 to 255 in decimal.</span>
<br/>
<span>You could, of course, just store two-digit values for the year, but if your data is going</span>
<span>to still be needed in the following century, or may otherwise wrap around, it will have</span>
<span>to be sanitized first&mdash;much like the &ldquo;millennium bug&rdquo; that would have caused dates</span>
<span>beginning on January 1, 2000, to be treated as 1900 on many of the world&rsquo;s biggest</span>
<span>computer installations.</span>
<br/>
<span>I didn&rsquo;t use the</span>
<span>YEAR</span>
<span>data type in the</span>
<span>classics</span>
<span>table because it supports only the year 0000, and years 1901 through 2155. This is</span>
<span>because MySQL stores the year in a single byte for reasons of efficiency, but it also means that only 256 years are available, and the</span>
<span>publication years of the titles in the</span>
<span>&nbsp;classics</span>
<span>&nbsp;table are well before</span>
<span>this.</span>
<br/>
<span>Both</span>
<span>CHAR</span>
<span>and</span>
<span>VARCHAR</span>
<span>accept text strings and impose a limit on the size of the field.</span>
<span>The difference is that every string in a</span>
<span>CHAR</span>
<span>field has the specified size. If you put in a</span>
<span>smaller string, it is padded with spaces. A</span>
<span>VARCHAR</span>
<span>field does not pad the text; it lets</span>
<span>the size of the field vary to fit the text that is inserted. But</span>
<span>VARCHAR</span>
<span>requires a small</span>
<span>amount of overhead to keep track of the size of each value. So</span>
<span>CHAR</span>
<span>is slightly more</span>
<span>efficient if the sizes are similar in all records, whereas</span>
<span>VARCHAR</span>
<span>is more efficient if</span>
<span>sizes can vary a lot and get large. In addition, the overhead causes access to</span>
<span>VARCHAR</span>
<span>data to be slightly slower than to</span>
<span>CHAR</span>
<span>data.</span>
<h6>The CHAR data type</h6>
<span>Table 8-6</span>
<span>lists the</span>
<span>CHAR</span>
<span>data types. All these types offer a parameter that sets the maximum (or exact) length of the string allowed in the field. As the table shows, each type</span>
<span>has a built-in maximum number of bytes it can occupy.</span>
<br/>
<span>Table 8-6. MySQL&rsquo;s CHAR data types</span>
<table class="tbl-left">
    <tr>
        <td>Data type</td>
        <td>Bytes used</td>
        <td>Examples</td>
    </tr>
    <tr>
        <td>CHAR(n)</td>
        <td>Exactly n(&lt;= 255)</td>
        <td>CHAR(5)&ldquo;Hello&rdquo; uses 5 bytes<br/>
            CHAR(57)&ldquo;Goodbye&rdquo; uses 57 bytes</td>
    </tr>
    <tr>
        <td>VARCHAR(n)</td>
        <td>Up to n(&lt;= 65535)</td>
        <td>VARCHAR(7)&ldquo;Morning&rdquo; uses 7 bytes<br/>
            VARCHAR(100)&ldquo;Night&rdquo; uses 5 bytes</td>
    </tr>
</table>
<h6>The BINARY data type</h6>
<span>The</span>
<span>BINARY</span>
<span>data type is used for storing strings of full bytes that do not have an associated character set. For example, you might use the</span>
<span>BINARY</span>
<span>data type to store a GIF</span>
<span>image (see</span>
<span>Table 8-7</span>
<span>).</span>
<br/>
<span>Table 8-7. MySQL&rsquo;s BINARY data types</span>
<table class="tbl-left">
    <tr>
        <td>Data type</td>
        <td>Bytes used</td>
        <td>Examples</td>
    </tr>
    <tr>
        <td>BINARY(n) or BYTE(n)</td>
        <td>Exactly n(&lt;= 255)</td>
        <td>As CHAR but contains binary data</td>
    </tr>
    <tr>
        <td>VARBINARY(n)</td>
        <td>Up to n(&lt;= 65535)</td>
        <td>As VARCHAR but contains binary data</td>
    </tr>
</table>
<h6>The TEXT and VARCHAR data types</h6>
<span>The differences between</span>
<span>TEXT</span>
<span>and</span>
<span>VARCHAR</span>
<span>are small:</span>
<br/>
<span>&bull;</span>
<span>Prior to version 5.0.3, MySQL would remove leading and trailing spaces from</span>
<span>VARCHAR</span>
<span>fields.</span>
<br/>
<span>&bull;</span>
<span>TEXT</span>
<span>fields cannot have default values.</span>
<br/>
<span>&bull;</span>
<span>MySQL indexes only the first</span>
<span>n</span>
<span>characters of a</span>
<span>TEXT</span>
<span>column (you specify</span>
<span>n</span>
<span>when</span>
<span>you create the index).</span>
<br/>
<span>What this means is that</span>
<span>VARCHAR</span>
<span>is the better and faster data type to use if you need to</span>
<span>search the entire contents of a field. If you will never search more than a certain number of leading characters in a field, you should probably use a</span>
<span>TEXT</span>
<span>data type (see</span>
<span>Table 8-8</span>
<span>).</span>
<br/>
<span>Table 8-8. MySQL&rsquo;s TEXT data types</span>
<table class="tbl-left">
    <tr>
        <td>Data type</td>
        <td>Bytes used</td>
        <td>Attributes</td>
    </tr>
    <tr>
        <td>TINYTEXT(n)</td>
        <td>Up to n(&lt;= 255)</td>
        <td>Treated as a string with a character set</td>
    </tr>
    <tr>
        <td>TEXT(n)</td>
        <td>Up to n (&lt;= 65535)</td>
        <td>Treated as a string with a character set</td>
    </tr>
    <tr>
        <td>MEDIUMTEXT(n)</td>
        <td>Up to n (&lt;= 1.67e+7)</td>
        <td>Treated as a string with a character set</td>
    </tr>
    <tr>
        <td>LONGTEXT(n)</td>
        <td>Up to n (&lt;= 4.29e+9)</td>
        <td>Treated as a string with a character set</td>
    </tr>
</table>
<h6>The BLOB data type</h6>
<span>The term</span>
<span>BLOB</span>
<span>stands for</span>
<span>Binary</span>
<span>Large</span>
<span>OBject</span>
<span>and, therefore, as you would think, the</span>
<span>BLOB</span>
<span>data type is most useful for binary data in excess of 65,536 bytes in size. The</span>
<span>main other difference between the</span>
<span>BLOB</span>
<span>and</span>
<span>BINARY</span>
<span>data types is that</span>
<span>BLOB</span>
<span>s cannot</span>
<span>have default values (see</span>
<span>Table 8-9</span>
<span>).</span>
<br/>
<span>Table 8-9. MySQL&rsquo;s BLOB data types</span>
<table class="tbl-left">
    <tr>
        <td>Data type</td>
        <td>Bytes used</td>
        <td>Attributes</td>
    </tr>
    <tr>
        <td>TINYBLOB(n)</td>
        <td>Up to n (&lt;= 255)</td>
        <td>Treated as binary data&mdash;no character set</td>
    </tr>
    <tr>
        <td>BLOB(n)</td>
        <td>Up to n(&lt;= 65535)</td>
        <td>Treated as binary data&mdash;no character set</td>
    </tr>
    <tr>
        <td>MEDIUMBLOB(n)</td>
        <td>Up to n (&lt;= 1.67e+7)</td>
        <td>Treated as binary data&mdash;no character set</td>
    </tr>
    <tr>
        <td>LONGBLOB(n)</td>
        <td>Up to n (&lt;= 4.29e+9)</td>
        <td>Treated as binary data&mdash;no character set</td>
    </tr>
</table>
<h6>Numeric data types</h6>
<span>MySQL supports various numeric data types from a single byte up to double-</span>
<span>precision floating-point numbers. Although the most memory that a numeric field</span>
<span>can use up is 8 bytes, you are well advised to choose the smallest data type that will</span>
<span>adequately handle the largest value you expect. Your databases will be small and</span>
<span>quickly accessible.</span>
<br/>
<span>Table 8-10</span>
<span>lists the numeric data types supported by MySQL and the ranges of values</span>
<span>they can contain. In case you are not acquainted with the terms, a</span>
<span>signed number</span>
<span>is</span>
<span>one with a possible range from a minus value, through 0, to a positive one; and an</span>
<span>unsigned</span>
<span>one has a value ranging from 0 to a positive one. They can both hold the</span>
<span>same number of values; just picture a signed number as being shifted halfway to the</span>
<span>left so that half its values are negative and half are positive. Note that floating-point</span>
<span>values (of any precision) may only be signed.</span>
<br/>
<span>Table 8-10. MySQL&rsquo;s numeric data types</span>
<table class="tbl-left">
    <tr>
        <td rowspan="2">Data type</td>
        <td rowspan="2">Bytes used</td>
        <td colspan="2">Minimum value</td>
        <td colspan="2">Maximum value</td>
    </tr>
    <tr>
        <td>Signed</td>
        <td>Unsigned</td>
        <td>Signed</td>
        <td>Unsigned</td>
    </tr>
    <tr>
        <td>TINYINT</td>
        <td>1</td>
        <td>&ndash;128</td>
        <td>0</td>
        <td>127</td>
        <td>255</td>
    </tr>
    <tr>
        <td>SMALLINT</td>
        <td>2</td>
        <td>&ndash;32768</td>
        <td>0</td>
        <td>32767</td>
        <td>65535</td>
    </tr>
    <tr>
        <td>MEDIUMINT</td>
        <td>3</td>
        <td>&ndash;8.38e+6</td>
        <td>0</td>
        <td>8.38e+6</td>
        <td>1.67e+7</td>
    </tr>
    <tr>
        <td>INT/INTEGER</td>
        <td>4</td>
        <td>&ndash;2.15e+9</td>
        <td>0</td>
        <td>2.15e+9</td>
        <td>4.29e+9</td>
    </tr>
    <tr>
        <td>BIGINT</td>
        <td>8</td>
        <td>&ndash;9.22e+18</td>
        <td>0</td>
        <td>9.22e+18</td>
        <td>1.84e+19</td>
    </tr>
    <tr>
        <td>FLOAT</td>
        <td>4</td>
        <td>&ndash;3.40e+38</td>
        <td>n/a</td>
        <td>3.4e+38</td>
        <td>n/a</td>
    </tr>
    <tr>
        <td>DOUBLE/REAL</td>
        <td>8</td>
        <td>&ndash;1.80e+308</td>
        <td>n/a</td>
        <td>1.80e+308</td>
        <td>n/a</td>
    </tr>
</table>
<br/>
<span>To specify whether a data type is signed or unsigned, use the</span>
<span>UNSIGNED</span>
<span>qualifier. The</span>
<span>following example creates a table called</span>
<span>tablename</span>
<span>with a field in it called</span>
<span>fieldname</span>
<span>of</span>
<span>the data type</span>
<span>UNSIGNED INTEGER</span>
<span>:</span>
<pre><code class="sql">CREATE TABLE tablename (fieldname INT UNSIGNED);</code></pre>
<span>When creating a numeric field, you can also pass an optional number as a parameter,</span>
<span>like this:</span>
<pre><code class="sql">CREATE TABLE tablename (fieldname INT(4));</code></pre>
<span>But you must remember that, unlike</span>
<span>BINARY</span>
<span>and</span>
<span>CHAR</span>
<span>data types, this parameter does</span>
<span>not indicate the number of bytes of storage to use. It may seem counterintuitive, but</span>
<span>what the number actually represents is the display width of the data in the field when</span>
<span>it is retrieved. It is commonly used with the</span>
<span>ZEROFILL</span>
<span>qualifier, like this:</span>
<pre><code class="sql">CREATE TABLE tablename (fieldname INT(4) ZEROFILL);</code></pre>
<span>What this does is cause any numbers with a width of less than four characters to be</span>
<span>padded with one or more zeros, sufficient to make the display width of the field four</span>
<span>characters long. When a field is already of the specified width or greater, no padding</span>
<span>takes place.</span>
<h6>DATE and TIME</h6>
<span>The main remaining data types supported by MySQL relate to the date and time and</span>
<span>can be seen in</span>
<span>Table 8-11</span>
<span>.</span>
<br/>
<span>Table 8-11. MySQL&rsquo;s DATE and TIME data types</span>
<table class="tbl-left">
    <tr>
        <td>Data type</td>
        <td>Time/date format</td>
    </tr>
    <tr>
        <td>DATETIME</td>
        <td>'0000-00-00 00:00:00'</td>
    </tr>
    <tr>
        <td>DATE</td>
        <td>'0000-00-00'</td>
    </tr>
    <tr>
        <td>TIMESTAMP</td>
        <td>'0000-00-00 00:00:00'</td>
    </tr>
    <tr>
        <td>TIME</td>
        <td>'00:00:00'</td>
    </tr>
    <tr>
        <td>YEAR</td>
        <td>0000(Only years 0000 and 1901&ndash;2155)</td>
    </tr>
</table>
<br/>
<span>The</span>
<span>DATETIME</span>
<span>and</span>
<span>TIMESTAMP</span>
<span>data types display the same way. The main difference is</span>
<span>that</span>
<span>TIMESTAMP</span>
<span>has a very narrow range (from the years 1970 through 2037), whereas</span>
<span>DATETIME</span>
<span>will hold just about any date you&rsquo;re likely to specify, unless you&rsquo;re interested</span>
<span>in ancient history or science fiction.</span>
<br/>
<span>TIMESTAMP</span>
<span>is useful, however, because you can let MySQL set the value for you. If you</span>
<span>don&rsquo;t specify the value when adding a row, the current time is automatically inserted.</span>
<span>You can also have MySQL update a</span>
<span>TIMESTAMP</span>
<span>column each time you change a row.</span>
<h6>The AUTO_INCREMENT data type</h6>
<span>Sometimes you need to ensure that every row in your database is guaranteed to be</span>
<span>unique. You could do this in your program by carefully checking the data you enter</span>
<span>and making sure that there is at least one value that differs in any two rows, but this</span>
<span>approach is error-prone and works only in certain circumstances. In the</span>
<span>classics</span>
<span>table,</span>
<span>for instance, an author may appear multiple times. Likewise, the year of publication</span>
<span>will also be frequently duplicated, and so on. It would be hard to guarantee that you</span>
<span>have no duplicate rows.</span>
<br/>
<span>The general solution is to use an extra column just for this purpose. In a while, we&rsquo;ll</span>
<span>look at using a publication&rsquo;s ISBN (International Standard Book Number), but first I&rsquo;d</span>
<span>like to introduce the</span>
<span>AUTO_INCREMENT</span>
<span>data type.</span>
<br/>
<span>As its name implies, a column given this data type will set the value of its contents to</span>
<span>that of the column entry in the previously inserted row, plus 1.</span>
<span>Example 8-5</span>
<span>shows</span>
<span>how to add a new column called</span>
<span>id</span>
<span>to the table</span>
<span>classics</span>
<span>with auto-incrementing.</span>
<br/>
<span>Example 8-5. Adding the auto-incrementing column id</span>
<pre><code class="sql">ALTER TABLE classics ADD id INT UNSIGNED NOT NULL AUTO_INCREMENT KEY;</code></pre>
<span>This is your introduction to the</span>
<span>ALTER</span>
<span>command, which is very similar to</span>
<span>CREATE</span>
<span>.</span>
<span>ALTER</span>
<span>operates on an existing table, and can add, change, or delete columns. Our</span>
<span>example adds a column named</span>
<span>id</span>
<span>with the following characteristics:</span>
<br/>
<span>INT UNSIGNED</span>
<div class="t30">Makes the column take an integer large enough for you to store more than 4 billion records in the table.</div>
<span>NOT NULL</span>
<div class="t30">
Ensures that every column has a value. Many programmers use
NULL
in a field to
indicate that it doesn&rsquo;t have any value. But that would allow duplicates, which would
violate the whole reason for this column&rsquo;s existence. So we disallow
NULL
values.</div>

<span>AUTO_INCREMENT</span>
<div class="t30">Causes MySQL to set a unique value for this column in every row, as described earlier. We don&rsquo;t really have control over the value that this column will take in each row,
but we don&rsquo;t care: all we care about is that we are guaranteed a unique value.</div>

<span>KEY</span>
<div class="t30">An auto-increment column is useful as a key, because you will tend to search for rows
based on this column. This will be explained in the section
&ldquo;Indexes&rdquo; on page 186.</div>

<span>Each entry in the column</span>
<span>id</span>
<span>will now have a unique number, with the first starting at</span>
<span>1 and the others counting upward from there. And whenever a new row is inserted,</span>
<span>its</span>
<span>id</span>
<span>column will automatically be given the next number in sequence.</span>
<span>Rather than applying the column retroactively, you could have included it by issuing</span>
<span>the</span>
<span>CREATE</span>
<span>command in a slightly different format. In that case, the command in</span>
<span>Example 8-3</span>
<span>would be replaced with</span>
<span>Example 8-6</span>
<span>. Check the final line in particular.</span>
<br/>
<span>Example 8-6. Adding the auto-incrementing id column at table creation</span>
<pre>
<code class="sql">
CREATE TABLE classics (
    author VARCHAR(128),
    title VARCHAR(128),
    type VARCHAR(16),
    year CHAR(4),
    id INT UNSIGNED NOT NULL AUTO_INCREMENT KEY) ENGINE MyISAM;
</code>
</pre>
<span>If you wish to check whether the column has been added, use the following command to view the table&rsquo;s columns and data types:</span>
<pre><code class="sql">DESCRIBE classics;</code></pre>
<span>Now that we&rsquo;ve finished with it, the</span>
<span>id</span>
<span>column is no longer needed, so if you created it</span>
<span>using</span>
<span>&nbsp;Example 8-5</span>
<span>, you should now remove the column using the command in</span>
<span>Example 8-7</span>
<span>.</span>
<br/>
<span>Example 8-7. Removing the id column</span>
<pre><code class="sql">ALTER TABLE classics DROP id;</code></pre>
<h6>Adding data to a table</h6>
<span>To add data to a table, use the</span>
<span>INSERT</span>
<span>command. Let&rsquo;s see this in action by populating</span>
<span>the table</span>
<span>&nbsp;classics</span>
<span>&nbsp;with the data from</span>
<span>&nbsp;Table 8-1</span>
<span>, using one form of the</span>
<span>INSERT</span>
<span>command repeatedly (</span>
<span>Example 8-8</span>
<span>).</span>
<br/>
<span>Example 8-8. Populating the classics table</span>
<pre>
<code class="sql">
    INSERT INTO classics(author, title, type, year)
    VALUES('Mark Twain','The Adventures of Tom Sawyer','Fiction','1876');
    INSERT INTO classics(author, title, type, year)
    VALUES('Jane Austen','Pride and Prejudice','Fiction','1811');
    INSERT INTO classics(author, title, type, year)
    VALUES('Charles Darwin','The Origin of Species','Non-Fiction','1856');
    INSERT INTO classics(author, title, type, year)
    VALUES('Charles Dickens','The Old Curiosity Shop','Fiction','1841');
    INSERT INTO classics(author, title, type, year)
    VALUES('William Shakespeare','Romeo and Juliet','Play','1594');
</code>
</pre>
<span>After every second line, you should see a</span>
<span>Query OK</span>
<span>message. Once all lines have been</span>
<span>entered, type the following command, which will display the table&rsquo;s contents. The</span>
<span>result should look like</span>
<span>Figure 8-4</span>
<span>:</span>
<pre><code class="sql">SELECT * FROM classics;</code></pre>
<p><img src="images/8.4.png"/></p>
<span>Figure 8-4. Populating the classics table and viewing its contents</span>
<br/>
<span>Don&rsquo;t worry about the</span>
<span>SELECT</span>
<span>command for now&mdash;we&rsquo;ll come to it in the section</span>
<span>&ldquo;</span>
<span>Querying a MySQL Database&rdquo; on page 192</span>
<span>. Suffice it to say that, as typed, it will display all the data you just entered.</span>
<br/>
<span>Let&rsquo;s go back and look at how we used the</span>
<span>INSERT</span>
<span>command. The first part,</span>
<span>INSERT</span>
<span>INTO classics</span>
<span>, tells MySQL where to insert the following data. Then, within parentheses, the four column names are listed&mdash;</span>
<span>author</span>
<span>,</span>
<span>title</span>
<span>,</span>
<span>type</span>
<span>, and</span>
<span>year</span>
<span>&mdash;all separated</span>
<span>by commas. This tells MySQL that these are the fields into which the data is to be</span>
<span>inserted.</span>
<br/>
<span>The second line of each</span>
<span>INSERT</span>
<span>command contains the keyword</span>
<span>VALUES</span>
<span>followed by</span>
<span>four strings within parentheses, and separated by commas. This supplies MySQL with</span>
<span>the four values to be inserted into the four columns previously specified. (As always,</span>
<span>my choice of where to break the lines was arbitrary.)</span>
<br/>
<span>Each item of data will be inserted into the corresponding column, in a one-to-one</span>
<span>correspondence. If you accidentally listed the columns in a different order from the</span>
<span>data, the data would go into the wrong columns. And the number of columns must</span>
<span>match the number of data items.</span>
<h6>Renaming a table</h6>
<span>Renaming a table, like any other change to the structure or meta information about a</span>
<span>table, is achieved via the</span>
<span>ALTER</span>
<span>command. So, for example, to change the name of</span>
<span>table</span>
<span>classics</span>
<span>to</span>
<span>pre1900</span>
<span>, use the following command:</span>
<pre><code class="sql">ALTER TABLE classics RENAME pre1900;</code></pre>
<span>If you tried that command, you should revert the table name by entering the following, so that later examples in this chapter will work as printed:</span>
<br/>
<span>ALTER TABLE pre1900 RENAME classics;</span>
<h6>Changing the data type of a column</h6>
<span>Changing a column&rsquo;s data type also makes use of the</span>
<span>ALTER</span>
<span>command, this time in</span>
<span>conjunction with the</span>
<span>MODIFY</span>
<span>keyword. So to change the data type of column</span>
<span>&nbsp;year</span>
<span>from</span>
<span>CHAR(4)</span>
<span>to</span>
<span>SMALLINT</span>
<span>(which requires only 2 bytes of storage and so will save</span>
<span>disk space), enter the following:</span>
<pre><code class="sql">ALTER TABLE classics MODIFY year SMALLINT;</code></pre>
<span>When you do this, if the conversion of data type makes sense to MySQL, it will automatically change the data while keeping the meaning. In this case, it will change each</span>
<span>string to a comparable integer, and so on, as the string is recognizable as referring to</span>
<span>an integer.</span>
<h6>Adding a new column</h6>
<span>Let&rsquo;s suppose that you have created a table and populated it with plenty of data, only</span>
<span>to discover you need an additional column. Not to worry. Here&rsquo;s how to add the new</span>
<span>column</span>
<span>pages</span>
<span>, which will be used to store the number of pages in a publication:</span>
<pre><code class="sql">ALTER TABLE classics ADD pages SMALLINT UNSIGNED;</code></pre>
<span>This adds the new column with the name</span>
<span>pages</span>
<span>using the</span>
<span>UNSIGNED SMALLINT</span>
<span>data</span>
<span>type, sufficient to hold a value of up to 65,535&mdash;hopefully that&rsquo;s more than enough for</span>
<span>any book ever published!</span>
<br/>
<span>And, if you ask MySQL to describe the updated table by using the</span>
<span>DESCRIBE</span>
<span>command, as follows, you will see the change has been made (see</span>
<span>Figure 8-5</span>
<span>):</span>
<pre><code class="sql">DESCRIBE classics;</code></pre>
<p><img src="images/8.5.png"/></p>
<span>Figure 8-5. Adding the new pages column and viewing the table</span>
<h6>Renaming a column</h6>
<span>Looking again at</span>
<span>Figure 8-5</span>
<span>, you may decide that having a column named</span>
<span>type</span>
<span>can be</span>
<span>confusing, because that is the name used by MySQL to identify data types. Again, no</span>
<span>problem&mdash;let&rsquo;s change its name to</span>
<span>category</span>
<span>, like this:</span>
<pre><code class="sql">ALTER TABLE classics CHANGE type category VARCHAR(16);</code></pre>
<span>Note the addition of</span>
<span>VARCHAR(16)</span>
<span>on the end of this command. That&rsquo;s because the</span>
<span>CHANGE</span>
<span>keyword requires the data type to be specified, even if you don&rsquo;t intend to</span>
<span>change it, and</span>
<span>VARCHAR(16)</span>
<span>was the data type specified when that column was initially created as</span>
<span>type</span>
<span>.</span>
<h6>Removing a column</h6>
<span>Actually, upon reflection, you might decide that the page count column</span>
<span>&nbsp;pages</span>
<span>&nbsp;isn&rsquo;t</span>
<span>actually all that useful for this particular database, so here&rsquo;s how to remove that column by using the</span>
<span>DROP</span>
<span>keyword:</span>
<pre><code class="sql">ALTER TABLE classics DROP pages;</code></pre>
<span>Remember that</span>
<span>DROP</span>
<span>is irreversible and you should always use it</span>
<span>with caution, because you could inadvertently delete entire tables</span>
<span>(and even databases) with it if you are not careful!</span>
<h6>Deleting a table</h6>
<span>Deleting a table is very easy indeed. But, because I don&rsquo;t want you to have to reenter</span>
<span>all the data for the</span>
<span>classics</span>
<span>table, let&rsquo;s quickly create a new table, verify its existence,</span>
<span>and then delete it by typing the commands in</span>
<span>Example 8-9</span>
<span>. The result of these four</span>
<span>commands should look like</span>
<span>Figure 8-6</span>
<span>.</span>
<br/>
<span>Example 8-9. Creating, viewing, and deleting a table</span>
<pre>
<code class="sql">
    CREATE TABLE disposable(trash INT);
    DESCRIBE disposable;
    DROP TABLE disposable;
    SHOW tables;
</code>
</pre>
<p><img src="images/8.6.png"/></p>
<span>Figure 8-6. Creating, viewing, and deleting a table</span>
<h3>Indexes</h3>
<span>As things stand, the table</span>
<span>&nbsp;classics</span>
<span>&nbsp;works and can be searched without problem by</span>
<span>MySQL&mdash;until it grows to more than a couple of hundred rows, that is. At that point,</span>
<span>database accesses will get slower and slower with every new row added, because</span>
<span>MySQL has to search through every row whenever a query is issued. This is like</span>
<span>searching through every book in a library whenever you need to look something up.</span>
<br/>
<span>Of course, you don&rsquo;t have to search libraries that way, because they have either a card</span>
<span>index system or, most likely, a database of their own. And the same goes for MySQL,</span>
<span>because at the expense of a slight overhead in memory and disk space, you can create</span>
<span>a &ldquo;card index&rdquo; for a table that MySQL will use to conduct lightning-fast searches.</span>
<h4>Creating an Index</h4>
<span>The way to achieve fast searches is to add an</span>
<span>index</span>
<span>, either when creating a table or at</span>
<span>any time afterward. But the decision is not so simple. For example, there are different</span>
<span>index types such as a regular</span>
<span>INDEX</span>
<span>,</span>
<span>PRIMARY KEY</span>
<span>, and</span>
<span>FULLTEXT</span>
<span>. Also, you must</span>
<span>decide which columns require an index, a judgment that requires you to predict</span>
<span>whether you will be searching any of the data in that column. Indexes can also get</span>
<span>complicated, because you can combine multiple columns in one index. And even</span>
<span>when you&rsquo;ve decided that, you still have the option of reducing index size by limiting</span>
<span>the amount of each column to be indexed.</span>
<br/>
<span>If we imagine the searches that may be made on the</span>
<span>classics</span>
<span>table, it becomes apparent</span>
<span>that all of the columns may need to be searched. However, if the</span>
<span>pages</span>
<span>column created</span>
<span>in the section</span>
<span>&nbsp;&ldquo;Adding a new column&rdquo; on page 184</span>
<span>&nbsp;had not been deleted, it would</span>
<span>probably not have needed an index, as most people would be unlikely to search for</span>
<span>books by the number of pages they have. Anyway, go ahead and add an index to each</span>
<span>of the columns, using the commands in</span>
<span>Example 8-10</span>
<span>.</span>
<br/>
<span>Example 8-10. Adding indexes to the classics table</span>
<pre>
<code class="sql">
    ALTER TABLE classics ADD INDEX(author(20));
    ALTER TABLE classics ADD INDEX(title(20));
    ALTER TABLE classics ADD INDEX(category(4));
    ALTER TABLE classics ADD INDEX(year);
    DESCRIBE classics;
</code>
</pre>
<span>The first two commands create indexes on both the</span>
<span>author</span>
<span>and</span>
<span>title</span>
<span>columns, limiting</span>
<span>each index to only the first 20 characters. For instance, when MySQL indexes the following title:</span>
<br/>
<span>The Adventures of Tom Sawyer</span>
<br/>
<span>It will actually store in the index only the first 20 characters:</span>
<br/>
<span>The Adventures of To</span>
<br/>
<span>This is done to minimize the size of the index, and to optimize database access speed.</span>
<span>I chose 20 because it&rsquo;s likely to be sufficient to ensure uniqueness for most strings in</span>
<span>these columns. If MySQL finds two indexes with the same contents, it will have to</span>
<span>waste time going to the table itself and checking the column that was indexed to find</span>
<span>out which rows really matched.</span>
<br/>
<span>With the</span>
<span>category</span>
<span>column, currently only the first character is required to identify a</span>
<span>string as unique (F for Fiction, N for Nonfiction, and P for Play), but I chose an index</span>
<span>of four characters to allow for future category types that may be unique only after</span>
<span>four characters. You can also re-index this column later, when you have a more complete set of categories. And finally, I set no limit to the</span>
<span>year</span>
<span>column&rsquo;s index, because</span>
<span>it&rsquo;s an integer, not a string.</span>
<br/>
<span>The results of issuing these commands (and a</span>
<span>DESCRIBE</span>
<span>command to confirm that</span>
<span>they worked) can be seen in</span>
<span>Figure 8-7</span>
<span>, which shows the key</span>
<span>MUL</span>
<span>for each column.</span>
<span>This key means that multiple occurrences of a value may occur within that column,</span>
<span>which is exactly what we want, as authors may appear many times, the same book</span>
<span>title could be used by multiple authors, and so on.</span>
<p><img src="images/8.8.png"/></p>
<span>Figure 8-7. Adding indexes to the classics table</span>
<h6>Using CREATE INDEX</h6>
<span>An alternative to using</span>
<span>ALTER TABLE</span>
<span>to add an index is to use the</span>
<span>CREATE INDEX</span>
<span>command. They are equivalent, except that</span>
<span>CREATE INDEX</span>
<span>cannot be used for creating a</span>
<span>PRIMARY KEY</span>
<span>(see the section</span>
<span>&ldquo;Primary keys&rdquo; on page 189</span>
<span>). The format of this command is shown in the second line of</span>
<span>Example 8-11</span>
<span>.</span>
<br/>
<span>Example 8-11.</span>
<span>These two commands are equivalent</span>
<pre>
<code class="sql">
    ALTER TABLE classics ADD INDEX(author(20));
    CREATE INDEX author ON classics (author(20));
</code>
</pre>
<h6>Adding indexes when creating tables</h6>
<span>You don&rsquo;t have to wait until after creating a table to add indexes. In fact, doing so can</span>
<span>be time-consuming, as adding an index to a large table can take a very long time.</span>
<span>Therefore, let&rsquo;s look at a command that creates the table</span>
<span>classics</span>
<span>with indexes already</span>
<span>in place.</span>
<br/>
<span>Example 8-12</span>
<span>is a reworking of</span>
<span>Example 8-3</span>
<span>in which the indexes are created at the</span>
<span>same time as the table. Note that to incorporate the modifications made in this chapter, this version uses the new column name</span>
<span>category</span>
<span>instead of</span>
<span>type</span>
<span>and sets the data</span>
<span>type of</span>
<span>&nbsp;year</span>
<span>&nbsp;to</span>
<span>SMALLINT</span>
<span>instead of</span>
<span>CHAR(4)</span>
<span>. If you want to try it out without first</span>
<span>deleting your current</span>
<span>&nbsp;classics</span>
<span>&nbsp;table, change the word</span>
<span>&nbsp;classics</span>
<span>&nbsp;in line 1 to something</span>
<span>else like</span>
<span>classics1</span>
<span>, and then drop</span>
<span>classics1</span>
<span>after you have finished with it.</span>
<br/>
<span>Example 8-12. Creating the table classics with indexes</span>
<pre>
<code class="sql">
CREATE TABLE classics (
    author VARCHAR(128),
    title VARCHAR(128),
    category VARCHAR(16),
    year SMALLINT,
    INDEX(author(20)),
    INDEX(title(20)),
    INDEX(category(4)),
    INDEX(year)) ENGINE MyISAM;
</code>
</pre>

<h6>Primary keys</h6>
<span>So far, you&rsquo;ve created the table</span>
<span>classics</span>
<span>and ensured that MySQL can search it quickly</span>
<span>by adding indexes, but there&rsquo;s still something missing. All the publications in the table</span>
<span>can be searched, but there is no single unique key for each publication to enable</span>
<span>instant accessing of a row. The importance of having a key with a unique value for</span>
<span>each row will come up when we start to combine data from different tables.</span>
<br/>
<span>The section</span>
<span>&ldquo;The AUTO_INCREMENT data type&rdquo; on page 181</span>
<span>briefly introduced the</span>
<span>idea of a primary key when creating the auto-incrementing column</span>
<span>id</span>
<span>, which could</span>
<span>have been used as a primary key for this table. However, I wanted to reserve that task</span>
<span>for a more appropriate column: the internationally recognized ISBN.</span>
<br/>
<span>So let&rsquo;s go ahead and create a new column for this key. Now, bearing in mind that</span>
<span>ISBNs are 13 characters long, you might think that the following command would do</span>
<span>the job:</span>
<pre><code class="sql">ALTER TABLE classics ADD isbn CHAR(13) PRIMARY KEY;</code></pre>
<span>But it doesn&rsquo;t. If you try it, you&rsquo;ll get the error</span>
<span>Duplicate entry</span>
<span>for key 1. The reason</span>
<span>is that the table is already populated with some data and this command is trying to</span>
<span>add a column with the value</span>
<span>NULL</span>
<span>to each row, which is not allowed, as all values</span>
<span>must be unique in any column having a primary key index. However, if there were no</span>
<span>data already in the table, this command would work just fine, as would adding the</span>
<span>primary key index upon table creation.</span>
<br/>
<span>In our current situation, we have to be a bit sneaky and create the new column</span>
<span>without an index, populate it with data, and then add the index retrospectively using</span>
<span>the commands in</span>
<span>Example 8-13</span>
<span>. Luckily, each of the years is unique in the current set</span>
<span>of data, so we can use the</span>
<span>year</span>
<span>column to identify each row for updating. Note that</span>
<span>this example uses the</span>
<span>UPDATE</span>
<span>and</span>
<span>WHERE</span>
<span>keywords, which are explained in more detail</span>
<span>in the section</span>
<span>&ldquo;Querying a MySQL Database&rdquo; on page 192</span>
<span>.</span>
<br/>
<span>Example 8-13. Populating the isbn column with data and using a primary key</span>
<pre>
<code class="sql">
    ALTER TABLE classics ADD isbn CHAR(13);
    UPDATE classics SET isbn='9781598184891' WHERE year='1876';
    UPDATE classics SET isbn='9780582506206' WHERE year='1811';
    UPDATE classics SET isbn='9780517123201' WHERE year='1856';
    UPDATE classics SET isbn='9780099533474' WHERE year='1841';
    UPDATE classics SET isbn='9780192814968' WHERE year='1594';
    ALTER TABLE classics ADD PRIMARY KEY(isbn);
    DESCRIBE classics;
</code>
</pre>
<br/>
<span>Once you have typed these commands, the results should look like</span>
<span>Figure 8-8</span>
<span>. Note</span>
<span>that the keywords</span>
<span>PRIMARY KEY</span>
<span>replace the keyword</span>
<span>INDEX</span>
<span>in the</span>
<span>ALTER TABLE</span>
<span>syntax</span>
<span>(compare</span>
<span>Example 8-10</span>
<span>and</span>
<span>Example 8-13</span>
<span>).</span>
<p><img src="images/8.8.png"/></p>
<span>Figure 8-8. Retrospectively adding a primary key to the classics table</span>
<br/>
<span>To have created a primary key when the table</span>
<span>&nbsp;classics</span>
<span>&nbsp;was created, you could have</span>
<span>used the commands in</span>
<span>Example 8-14</span>
<span>. Again, rename</span>
<span>classics</span>
<span>in line 1 to something</span>
<span>else if you wish to try this example, and then delete the test table afterward.</span>
<br/>
<span>Example 8-14. Creating the table classics with a primary key</span>
<pre>
<code class="sql">
    CREATE TABLE classics (
        author VARCHAR(128),
        title VARCHAR(128),
        category VARCHAR(16),
        year SMALLINT,
        isbn CHAR(13),
        INDEX(author(20)),
        INDEX(title(20)),
        INDEX(category(4)),
        INDEX(year),
        PRIMARY KEY (isbn)) ENGINE MyISAM;
</code>
</pre>
<h6>Creating a FULLTEXT index</h6>
<span>Unlike a regular index, MySQL&rsquo;s</span>
<span>FULLTEXT</span>
<span>allows super-fast searches of entire columns of text. It stores every word in every data string in a special index that you can</span>
<span>search using &ldquo;natural language,&rdquo; in a similar manner to using a search engine.</span>
<br/>
<span>It&rsquo;s not strictly true that MySQL stores</span>
<span>all</span>
<span>the words in a</span>
<span>FULLTEXT</span>
<span>index, because it has a built-in list of more than 500 words that it</span>
<span>chooses to ignore because they are so common that they aren&rsquo;t very</span>
<span>helpful for searching anyway. This list, called</span>
<span>&nbsp;stopwords</span>
<span>, includes</span>
<span>the</span>
<span>,</span>
<span>&nbsp;as</span>
<span>,</span>
<span>&nbsp;is</span>
<span>,</span>
<span>&nbsp;of</span>
<span>, and so on. The list helps MySQL run much more</span>
<span>quickly when performing a</span>
<span>FULLTEXT</span>
<span>search and keeps database</span>
<span>sizes down.</span>
<span>Appendix C</span>
<span>contains the full list of stopwords.</span>
<br/>
<span>Here are some things that you should know about</span>
<span>FULLTEXT</span>
<span>indexes:</span>
<br/>
<span>&bull;</span>
<span>FULLTEXT</span>
<span>indexes can be used only with MyISAM tables, the type used by</span>
<span>MySQL&rsquo;s default storage engine (MySQL supports at least 10 different storage</span>
<span>engines). If you need to convert a table to MyISAM, you can usually use the</span>
<span>MySQL command</span>
<span>ALTER TABLE tablename ENGINE = MyISAM;</span>
<span>.</span>
<br/>
<span>&bull;</span>
<span>FULLTEXT</span>
<span>indexes can be created for</span>
<span>CHAR</span>
<span>,</span>
<span>VARCHAR</span>
<span>, and</span>
<span>TEXT</span>
<span>columns only.</span>
<br/>
<span>&bull;</span>
<span>A</span>
<span>FULLTEXT</span>
<span>index definition can be given in the</span>
<span>CREATE TABLE</span>
<span>statement when a</span>
<span>table is created, or added later using</span>
<span>ALTER TABLE</span>
<span>(or</span>
<span>CREATE INDEX</span>
<span>).</span>
<br/>
<span>&bull;</span>
<span>For large data sets, it is</span>
<span>&nbsp;much</span>
<span>&nbsp;faster to load your data into a table that has no</span>
<span>FULLTEXT</span>
<span>index and then create the index than to load data into a table that has</span>
<span>an existing</span>
<span>FULLTEXT</span>
<span>index.</span>
<br/>
<span>To create a</span>
<span>FULLTEXT</span>
<span>index, apply it to one or more records as in</span>
<span>&nbsp;Example 8-15</span>
<span>,</span>
<span>which adds a</span>
<span>FULLTEXT</span>
<span>index to the pair of columns</span>
<span>&nbsp;author</span>
<span>and</span>
<span>title</span>
<span>in the</span>
<span>&nbsp;classics</span>
<span>table (this index is in addition to the ones already created and does not affect them).</span>
<br/>
<span>Example 8-15. Adding a FULLTEXT index to the table classics</span>
<pre><code class="sql">ALTER TABLE classics ADD FULLTEXT(author,title);</code></pre>
<span>You can now perform</span>
<span>FULLTEXT</span>
<span>searches across this pair of columns. This feature</span>
<span>could really come into its own if you could now add the entire text of these publications to the database (particularly as they&rsquo;re out of copyright protection) and they</span>
<span>would be fully searchable. See the section</span>
<span>&ldquo;MATCH...AGAINST&rdquo; on page 197</span>
<span>for a</span>
<span>description of searches using</span>
<span>FULLTEXT</span>
<span>.</span>
<br/>
<span>If you find that MySQL is running slower than you think it should</span>
<span>be when accessing your database, the problem is usually related to</span>
<span>your indexes. Either you don&rsquo;t have an index where you need one,</span>
<span>or</span>
<span>the</span>
<span>indexes</span>
<span>are</span>
<span>not</span>
<span>optimally</span>
<span>designed.</span>
<span>Tweaking</span>
<span>a</span>
<span>table&rsquo;s</span>
<span>indexes will often solve such a problem. Performance is beyond the</span>
<span>scope of this book, but in</span>
<span>Chapter 9</span>
<span>I&rsquo;ll give you a few tips so you</span>
<span>know what to look for.</span>
<h4>Querying a MySQL Database</h4>
<span>So far, we&rsquo;ve created a MySQL database and tables, populated them with data, and</span>
<span>added indexes to make them fast to search. Now it&rsquo;s time to look at how these</span>
<span>searches are performed, and the various commands and qualifiers available.</span>
<h6>SELECT</h6>
<span>As you saw in</span>
<span>Figure 8-4</span>
<span>, the</span>
<span>SELECT</span>
<span>command is used to extract data from a table. In</span>
<span>that section, I used its simplest form to select all data and display it&mdash;something you</span>
<span>will never want to do on anything but the smallest tables, because all the data will</span>
<span>scroll by at an unreadable pace. Let&rsquo;s now examine</span>
<span>SELECT</span>
<span>in more detail.</span>
<br/>
<span>The basic syntax is as follows:</span>
<pre><code class="sql">SELECT something FROM tablename;</code></pre>
<span>The</span>
<span>something</span>
<span>can be an</span>
<span>*</span>
<span>(asterisk) as you saw before, which means</span>
<span>every column</span>
<span>,</span>
<span>or you can choose to select only certain columns. For instance,</span>
<span>Example 8-16</span>
<span>shows</span>
<span>how to select just the</span>
<span>author</span>
<span>and</span>
<span>title</span>
<span>and just the</span>
<span>title</span>
<span>and</span>
<span>isbn</span>
<span>. The result of typing</span>
<span>these commands can be seen in</span>
<span>Figure 8-9</span>
<span>.</span>
<br/>
<span>Example 8-16. Two</span>
<span>different SELECT statements</span>
<pre>
<code class="sql">
    SELECT author,title FROM classics;
    SELECT title,isbn FROM classics;
</code>
</pre>
<p><img src="images/8.9.png"/></p>
<span>Figure 8-9. The output from two different SELECT statements</span>
<h6>SELECT COUNT</h6>
<span>Another replacement for the</span>
<span>something</span>
<span>parameter is</span>
<span>COUNT</span>
<span>, which can be used in</span>
<span>many ways. In</span>
<span>Example 8-17</span>
<span>, it displays the number of rows in the table by passing</span>
<span>*</span>
<span>as a parameter, which means</span>
<span>&nbsp;all rows</span>
<span>. As you&rsquo;d expect, the result returned is</span>
<span>5</span>
<span>, as</span>
<span>there are five publications in the table.</span>
<br/>
<span>Example 8-17. Counting rows</span>
<pre><code class="sql">SELECT COUNT(*) FROM classics;</code></pre>
<span>SELECT DISTINCT</span>
<span>This qualifier (and its synonym DISTINCTROW) allows you to weed out multiple entries</span>
<span>when they contain the same data. For instance, suppose that you want a list of all</span>
<span>authors in the table. If you select just the</span>
<span>author</span>
<span>column from a table containing multiple books by the same author, you&rsquo;ll normally see a long list with the same author</span>
<span>names over and over. But by adding the</span>
<span>DISTINCT</span>
<span>keyword, you can show each</span>
<span>author just once. So let&rsquo;s test that out by adding another row that repeats one of our</span>
<span>existing authors (</span>
<span>Example 8-18</span>
<span>).</span>
<br/>
<span>Example 8-18. Duplicating data</span>
<pre>
<code class="sql">
    INSERT INTO classics(author, title, category, year, isbn)
    VALUES('Charles Dickens','Little Dorrit','Fiction','1857', '9780141439969');
</code>
</pre>
<span>Now that Charles Dickens appears twice in the table, we can compare the results of</span>
<span>using</span>
<span>SELECT</span>
<span>with and without the</span>
<span>DISTINCT</span>
<span>qualifier.</span>
<span>Example 8-19</span>
<span>and</span>
<span>Figure 8-10</span>
<span>show that the simple</span>
<span>SELECT</span>
<span>lists Dickens twice, and the command with the</span>
<span>DISTINCT</span>
<span>qualifier shows him only once.</span>
<br/>
<span>Example 8-19. With and without the DISTINCT</span>
<span>qualifier</span>
<pre>
<code class="sql">
    SELECT author FROM classics;
    SELECT DISTINCT author FROM classics;
</code>
</pre>

<p><img src="images/8.10.png"/></p>
<span>Figure 8-10. Selecting data with and without DISTINCT</span>
<h6>DELETE</h6>
<span>When you need to remove a row from a table, use the</span>
<span>DELETE</span>
<span>command. Its syntax is</span>
<span>similar to the</span>
<span>SELECT</span>
<span>command and allows you to narrow down the exact row or</span>
<span>rows to delete using qualifiers such as</span>
<span>WHERE</span>
<span>and</span>
<span>LIMIT</span>
<span>.</span>
<br/>
<span>Now that you&rsquo;ve seen the effects of the</span>
<span>DISTINCT</span>
<span>qualifier, if you typed</span>
<span>Example 8-18</span>
<span>,</span>
<span>you should remove</span>
<span>Little Dorrit</span>
<span>by entering the commands in</span>
<span>Example 8-20</span>
<span>.</span>
<br/>
<span>Example 8-20. Removing the new entry</span>
<pre><code class="sql">DELETE FROM classics WHERE title='Little Dorrit';</code></pre>
<span>This example issues a</span>
<span>DELETE</span>
<span>command for all rows whose</span>
<span>title</span>
<span>column contains the</span>
<span>string</span>
<span>Little Dorrit</span>
<span>.</span>
<br/>
<span>The</span>
<span>WHERE</span>
<span>keyword is very powerful, and important to enter correctly; an error could</span>
<span>lead a command to the wrong rows (or have no effect in cases where nothing matches</span>
<span>the</span>
<span>WHERE</span>
<span>clause). So now we&rsquo;ll spend some time on that clause, which is the heart</span>
<span>and soul of SQL.</span>
<h6>WHERE</h6>
<span>The</span>
<span>WHERE</span>
<span>keyword enables you to narrow down queries by returning only those</span>
<span>where</span>
<span>a certain expression is true.</span>
<span>Example 8-20</span>
<span>returns only the rows where the column</span>
<span>exactly</span>
<span>matches</span>
<span>the</span>
<span>string</span>
<span>Little Dorrit</span>
<span>,</span>
<span>using</span>
<span>the</span>
<span>equality</span>
<span>operator</span>
<span>=</span>
<span>.</span>
<span>Example 8-21</span>
<span>shows a couple more examples of using</span>
<span>WHERE</span>
<span>with</span>
<span>=</span>
<span>.</span>
<br/>
<span>Example 8-21. Using the WHERE keyword</span>
<pre>
<code class="sql">
    SELECT author,title FROM classics WHERE author="Mark Twain";
    SELECT author,title FROM classics WHERE isbn="9781598184891 ";
</code>
</pre>
<span>Given our current table, the two commands in</span>
<span>Example 8-21</span>
<span>display the same results.</span>
<span>But we could easily add more books by Mark Twain, in which case the first line would</span>
<span>display all titles he wrote and the second line would continue (because we know the</span>
<span>ISBN is unique) to display</span>
<span>The Adventures of Tom Sawyer</span>
<span>. In other words, searches</span>
<span>using a unique key are more predictable, and you&rsquo;ll see further evidence later of the</span>
<span>value of unique and primary keys.</span>
<br/>
<span>You can also do pattern matching for your searches using the</span>
<span>LIKE</span>
<span>qualifier, which</span>
<span>allows searches on parts of strings. This qualifier should be used with a</span>
<span>%</span>
<span>character</span>
<span>before or after some text. When placed before a keyword,</span>
<span>%</span>
<span>means</span>
<span>anything before</span>
<span>.</span>
<span>After a keyword, it means</span>
<span>anything</span>
<span>after</span>
<span>.</span>
<span>Example 8-22</span>
<span>performs three different queries, one for the start of a string, one for the end, and one for anywhere in a string. You</span>
<span>can see the results of these commands in</span>
<span>Figure 8-11</span>
<span>.</span>
<br/>
<span>Example 8-22. Using the LIKE</span>
<span>qualifier</span>
<pre>
<code class="sql">
    SELECT author,title FROM classics WHERE author LIKE "Charles%";
    SELECT author,title FROM classics WHERE title LIKE "%Species";
    SELECT author,title FROM classics WHERE title LIKE "%and%";
</code>
</pre>
<span>The first command outputs the publications by both Charles Darwin and Charles</span>
<span>Dickens because the</span>
<span>LIKE</span>
<span>qualifier was set to return anything matching the string</span>
<span>Charles</span>
<span>followed by any other text. Then just</span>
<span>The Origin of Species</span>
<span>is returned,</span>
<span>because it&rsquo;s the only row whose column ends with the string</span>
<span>Species</span>
<span>. Last, both</span>
<span>Pride and Prejudice</span>
<span>and</span>
<span>Romeo and Juliet</span>
<span>are returned, because they both</span>
<span>matched the string</span>
<span>and</span>
<span>anywhere in the column.</span>
<br/>
<span>The</span>
<span>%</span>
<span>will also match if there is nothing in the position it occupies; in other words, it</span>
<span>can match an empty string.</span>
<p><img src="images/8.11.png"/></p>
<span>Figure 8-11. Using WHERE with the LIKE qualifier</span>
<h6>LIMIT</h6>
<span>The</span>
<span>LIMIT</span>
<span>qualifier enables you to choose how many rows to return in a query, and</span>
<span>where in the table to start returning them. When passed a single parameter, it tells</span>
<span>MySQL to start at the beginning of the results and just return the number of rows</span>
<span>given in that parameter. If you pass it two parameters, the first indicates the offset</span>
<span>from the start of the results where MySQL should start the display, and the second</span>
<span>indicates how many to return. You can think of the first parameter as saying, &ldquo;Skip</span>
<span>this number of results at the start.&rdquo;</span>
<br/>
<span>Example 8-23</span>
<span>includes three commands. The first returns the first three rows from</span>
<span>the table. The second returns two rows starting at position 1 (skipping the first row).</span>
<span>The last command returns a single row starting at position 3 (skipping the first three</span>
<span>rows).</span>
<span>Figure 8-12</span>
<span>shows the results of issuing these three commands.</span>
<br/>
<span>Example 8-23. Limiting the number of results returned</span>
<pre>
<code class="sql">
SELECT author,title FROM classics LIMIT 3;
SELECT author,title FROM classics LIMIT 1,2;
SELECT author,title FROM classics LIMIT 3,1;
</code>
</pre>
<span>Be careful with the</span>
<span>LIMIT</span>
<span>keyword, because offsets start at 0, but</span>
<span>the number of rows to return starts at 1. So</span>
<span>LIMIT 1,3</span>
<span>means</span>
<span>return</span>
<span>three</span>
<span>rows starting from the</span>
<span>second</span>
<span>row.</span>
<p><img src="images/8.12.png"/></p>
<span>Figure 8-12. Restricting the rows returned with LIMIT</span>
<h6>MATCH...AGAINST</h6>
<span>The</span>
<span>MATCH...AGAINST</span>
<span>construct can be used on columns that have been given a</span>
<span>FULL</span>
<span>TEXT</span>
<span>index (see the section</span>
<span>&ldquo;Creating a FULLTEXT index&rdquo; on page 191</span>
<span>). With it, you</span>
<span>can make natural-language searches as you would in an Internet search engine.</span>
<span>Unlike the use of</span>
<span>WHERE...=</span>
<span>or</span>
<span>WHERE...LIKE</span>
<span>,</span>
<span>MATCH...AGAINST</span>
<span>lets you enter multiple words in a search query and checks them against all words in the</span>
<span>FULLTEXT</span>
<span>columns.</span>
<span>FULLTEXT</span>
<span>indexes are case-insensitive, so it makes no difference what case is</span>
<span>used in your queries.</span>
<br/>
<span>Assuming that you have added a</span>
<span>FULLTEXT</span>
<span>index to the</span>
<span>&nbsp;author</span>
<span>&nbsp;and</span>
<span>&nbsp;title</span>
<span>&nbsp;columns,</span>
<span>enter the three queries shown in</span>
<span>&nbsp;Example 8-24</span>
<span>. The first asks for any of these columns that contain the word</span>
<span>and</span>
<span>to be returned. Because</span>
<span>and</span>
<span>is a stopword, MySQL</span>
<span>will ignore it and the query will always produce an empty set&mdash;no matter what is</span>
<span>stored in the columns. The second query asks for any rows that contain both of the</span>
<span>words</span>
<span>curiosity</span>
<span>and</span>
<span>shop</span>
<span>anywhere in them, in any order, to be returned. And the last</span>
<span>query applies the same kind of search for the words</span>
<span>&nbsp;tom</span>
<span>&nbsp;and</span>
<span>&nbsp;sawyer</span>
<span>.</span>
<span>&nbsp;Figure 8-13</span>
<span>shows the results of these queries.</span>
<br/>
<span>Example 8-24. Using MATCH...AGAINST on FULLTEXT indexes</span>
<pre>
<code class="sql">
    SELECT author,title FROM classics
    WHERE MATCH(author,title) AGAINST('and');
    SELECT author,title FROM classics
    WHERE MATCH(author,title) AGAINST('curiosity shop');
    SELECT author,title FROM classics
    WHERE MATCH(author,title) AGAINST('tom sawyer');
</code>
</pre>
<p><img src="images/8.13.png"/></p>
<span>Figure 8-13. Using MATCH...AGAINST on a FULLTEXT index</span>
<h6>MATCH...AGAINST...in Boolean Mode</h6>
<span>If you wish to give your</span>
<span>MATCH...AGAINST</span>
<span>queries even more power, use Boolean</span>
<span>mode. This changes the effect of the standard</span>
<span>FULLTEXT</span>
<span>query so that it searches for</span>
<span>any combination of search words, instead of requiring all search words to be in the</span>
<span>text. The presence of a single word in a column causes the search to return the row.</span>
<br/>
<span>Boolean mode also allows you to preface search words with a</span>
<span>+</span>
<span>or</span>
<span>-</span>
<span>sign to indicate</span>
<span>whether they must be included or excluded. If normal Boolean mode says, &ldquo;Any of</span>
<span>these words will do,&rdquo; a plus sign means, &ldquo;This word must be present; otherwise, don&rsquo;t</span>
<span>return the row.&rdquo; A minus sign means, &ldquo;This word must not be present; its presence</span>
<span>disqualifies the row from being returned.&rdquo;</span>
<br/>
<span>Example 8-25</span>
<span>&nbsp;illustrates Boolean mode through two queries. The first asks for all</span>
<span>rows containing the word</span>
<span>charles</span>
<span>and not the word</span>
<span>species</span>
<span>to be returned. The second</span>
<span>uses double quotes to request that all rows containing the exact phrase</span>
<span>origin of</span>
<span>be</span>
<span>returned.</span>
<span>Figure 8-14</span>
<span>shows the results of these queries.</span>
<br/>
<span>Example 8-25. Using MATCH...AGAINST...in Boolean Mode</span>
<pre>
<code class="sql">
    SELECT author,title FROM classics
        WHERE MATCH(author,title)
        AGAINST('+charles -species' IN BOOLEAN MODE);
    
    SELECT author,title FROM classics
        WHERE MATCH(author,title)
        AGAINST('"origin of"' IN BOOLEAN MODE);
</code>
</pre>
<p><img src="images/8.14.png"/></p>
<span>Figure 8-14. Using MATCH...AGAINST...in Boolean Mode</span>
<br/>
<span>As you would expect, the first request returns only</span>
<span>The Old Curiosity Shop</span>
<span>by</span>
<span>Charles Dickens, because any rows containing the word</span>
<span>species</span>
<span>have been excluded,</span>
<span>so Charles Darwin&rsquo;s publication is ignored.</span>
<span>There is something of interest to note in the second query: the</span>
<span>stopword</span>
<span>&nbsp;of</span>
<span>&nbsp;is part of the search string, but is still used by the</span>
<span>search because the double quotation marks override stopwords.</span>
<h6>UPDATE...SET</h6>
<span>This construct allows you to update the contents of a field. If you wish to change the</span>
<span>contents of one or more fields, you need to first narrow in on just the field or fields to</span>
<span>be changed, in much the same way you use the</span>
<span>SELECT</span>
<span>command.</span>
<span>&nbsp;Example 8-26</span>
<span>shows the use of</span>
<span>UPDATE...SET</span>
<span>in two different ways. You can see the results in</span>
<span>Figure 8-15</span>
<span>.</span>
<br/>
<span>Example 8-26. Using UPDATE...SET</span>
<pre>
<code class="sql">
    UPDATE classics SET author='Mark Twain (Samuel Langhorne Clemens)'
        WHERE author='Mark Twain';
        
    UPDATE classics SET category='Classic Fiction'
        WHERE category='Fiction';
</code>
</pre>
<p><img src="images/8.15.png"/></p>
<span>Figure 8-15. Updating columns in the classics table</span>
<br/>
<span>In the first query, Mark Twain&rsquo;s real name of Samuel Langhorne Clemens was</span>
<span>appended to his pen name in brackets, which affected only one row. The second</span>
<span>query, however, affected three rows, because it changed all occurrences of the word</span>
<span>Fiction</span>
<span>in the</span>
<span>category</span>
<span>column to the term</span>
<span>Classic Fiction</span>
<span>.</span>
<br/>
<span>When performing an update, you can also make use of the qualifiers you have already</span>
<span>seen, such as</span>
<span>LIMIT</span>
<span>, and the following</span>
<span>ORDER BY</span>
<span>and</span>
<span>GROUP BY</span>
<span>keywords.</span>
<h6>ORDER BY</h6>
<span>ORDER BY</span>
<span>sorts returned results by one or more columns in ascending or descending</span>
<span>order.</span>
<span>&nbsp;Example 8-27</span>
<span>&nbsp;shows two such queries, the results of which can be seen in</span>
<span>Figure 8-16</span>
<span>.</span>
<br/>
<span>Example 8-27. Using ORDER BY</span>
<pre>
<code class="sql">
    SELECT author,title FROM classics ORDER BY author;
    SELECT author,title FROM classics ORDER BY title DESC;
</code>
</pre>
<span>As you can see, the first query returns the publications by</span>
<span>author</span>
<span>in ascending alphabetical order (the default), and the second returns them by</span>
<span>title</span>
<span>in descending order.</span>
<p><img src="images/8.16.png"/></p>
<span>Figure 8-16. Sorting the results of requests</span>
<br/>
<span>If you wanted to sort all the rows by</span>
<span>author</span>
<span>and then by descending</span>
<span>year</span>
<span>of publication (to view the most recent first), you would issue the following query:</span>
<pre><code class="sql">SELECT author,title,year FROM classics ORDER BY author,year DESC;</code></pre>
<span>This shows that each ascending and descending qualifier applies to a single column.</span>
<span>The</span>
<span>DESC</span>
<span>keyword applies only to the preceding column,</span>
<span>&nbsp;year</span>
<span>. Because you allow</span>
<span>author</span>
<span>&nbsp;to use the default sort order, it is sorted in ascending order. You could also</span>
<span>have explicitly specified ascending order for that column, with the same results:</span>
<pre><code class="sql">SELECT author,title,year FROM classics ORDER BY author ASC,year DESC</code></pre>
<h6>GROUP BY</h6>
<span>In a similar fashion to</span>
<span>ORDER BY</span>
<span>, you can group results returned from queries using</span>
<span>GROUP BY</span>
<span>, which is good for retrieving information about a group of data. For example, if you want to know how many publications there are of each category in the</span>
<span>classics</span>
<span>table, you can issue the following query:</span>
<pre><code class="sql">SELECT category,COUNT(author) FROM classics GROUP BY category</code></pre>
<br/>
<span>which returns the following output:</span>
<pre>
<code class="sql">
+-----------------+---------------+
| category | COUNT(author) |
+-----------------+---------------+
| Classic Fiction | 3 |
| Non-Fiction | 1 |
| Play | 1 |
+-----------------+---------------+
3 rows in set (0.00 sec)
</code>
</pre>
<h4>Joining Tables Together</h4>
<span>It is quite normal to maintain multiple tables within a database, each holding a different type of information. For example, consider the case of a</span>
<span>customers</span>
<span>table that needs</span>
<span>to be able to be cross-referenced with publications purchased from the</span>
<span>classics</span>
<span>table.</span>
<span>Enter the commands in</span>
<span>Example 8-28</span>
<span>to create this new table and populate it with</span>
<span>three customers and their purchases.</span>
<span>Figure 8-17</span>
<span>shows the result.</span>
<br/>
<span>Example 8-28. Creating and populating the customers table</span>
<pre>
<code class="sql">
    CREATE TABLE customers (
        name VARCHAR(128),
        isbn VARCHAR(13),
        PRIMARY KEY (isbn)) ENGINE MyISAM;

    INSERT INTO customers(name,isbn)
        VALUES('Joe Bloggs','9780099533474');

    INSERT INTO customers(name,isbn)
        VALUES('Mary Smith','9780582506206');

    INSERT INTO customers(name,isbn)
        VALUES('Jack Wilson','9780517123201');

    SELECT * FROM customers;
</code>
</pre>
<p><img src="images/8.17.png"/></p>
<span>Figure 8-17. Creating the customers table</span>
<br/>
<span>There&rsquo;s also a shortcut for inserting multiple rows of data, as in</span>
<span>Example 8-28</span>
<span>, in which you can replace the three separate</span>
<span>INSERT</span>
<span>INTO</span>
<span>queries with a single one listing the data to be inserted, separated by commas, like this:</span>
<pre>
<code class="sql">
INSERT INTO customers(name,isbn) VALUES
    ('Joe Bloggs','9780099533474'),
    ('Mary Smith','9780582506206'),
    ('Jack Wilson','9780517123201');
</code>
</pre>
<span>Of course, in a proper table containing customers&rsquo; details there would also be</span>
<span>addresses, phone numbers, email addresses, and so on, but they aren&rsquo;t necessary for</span>
<span>this explanation. While creating the new table, you should have noticed that it has</span>
<span>something in common with the</span>
<span>classics</span>
<span>table: a column called</span>
<span>isbn</span>
<span>. Because it has the</span>
<span>same meaning in both tables (an ISBN refers to a book, and always the same book),</span>
<span>we can use this column to tie the two tables together into a single query, as in</span>
<span>Example 8-29</span>
<span>.</span>
<br/>
<span>Example 8-29. Joining two tables into a single SELECT</span>
<pre>
<code class="sql">
    SELECT name,author,title from customers,classics
        WHERE customers.isbn=classics.isbn;
</code>
</pre>
<span>The result of this operation is the following:</span>
<pre>
<code class="sql">
+-------------+-----------------+------------------------+
| name | author | title |
+-------------+-----------------+------------------------+
| Joe Bloggs | Charles Dickens | The Old Curiosity Shop |
| Mary Smith | Jane Austen | Pride and Prejudice |
| Jack Wilson | Charles Darwin | The Origin of Species |
+-------------+-----------------+------------------------+
3 rows in set (0.00 sec)
</code>
</pre>
<span>See how this query has neatly tied both tables together to show the publications purchased from the</span>
<span>classics</span>
<span>table by the people in the</span>
<span>customers</span>
<span>table?</span>
<h6>NATURAL JOIN</h6>
<span>Using</span>
<span>NATURAL JOIN</span>
<span>, you can save yourself some typing and make queries a little</span>
<span>clearer. This kind of join takes two tables and automatically joins columns that have</span>
<span>the same name. So, to achieve the same results as from</span>
<span>&nbsp;Example 8-29</span>
<span>, you would</span>
<span>enter the following:</span>
<pre><code class="sql">SELECT name,author,title FROM customers NATURAL JOIN classics;</code></pre>
<h6>JOIN...ON</h6>
<span>If you wish to specify the column on which to join two tables, use the</span>
<span>JOIN...ON</span>
<span>construct, as follows, to achieve results identical to those of</span>
<span>Example 8-29</span>
<span>:</span>
<pre>
<code class="sql">
SELECT name,author,title FROM customers
    JOIN classics ON customers.isbn=classics.isbn;
</code>
</pre>
<h6>Using AS</h6>
<span>You can also save yourself some typing and improve query readability by creating</span>
<span>aliases using the</span>
<span>AS</span>
<span>keyword. Follow a table name with</span>
<span>AS</span>
<span>and the alias to use. The</span>
<span>following code, therefore, is also identical in action to</span>
<span>Example 8-29</span>
<span>. Aliases can be</span>
<span>particularly useful when you have long queries that reference the same table names</span>
<span>many times.</span>
<pre>
<code class="sql">
    SELECT name,author,title 
    FROM customers AS cust, classics AS class 
    WHERE cust.isbn=class.isbn;
</code>
</pre>
<span>The result of this operation is the following:</span>
<pre>
<code class="sql">
+-------------+-----------------+------------------------+
| name | author | title |
+-------------+-----------------+------------------------+
| Joe Bloggs | Charles Dickens | The Old Curiosity Shop |
| Mary Smith | Jane Austen | Pride and Prejudice |
| Jack Wilson | Charles Darwin | The Origin of Species |
+-------------+-----------------+------------------------+
3 rows in set (0.00 sec)
</code>
</pre>
<h4>Using Logical Operators</h4>
<span>You can also use the logical operators</span>
<span>AND</span>
<span>,</span>
<span>OR</span>
<span>, and</span>
<span>NOT</span>
<span>in your MySQL</span>
<span>WHERE</span>
<span>queries</span>
<span>to further narrow down your selections.</span>
<span>Example 8-30</span>
<span>shows one instance of each,</span>
<span>but you can mix and match them in any way you need.</span>
<br/>
<span>Example 8-30. Using logical operators</span>
<pre>
<code class="sql">
SELECT author,title FROM classics WHERE
    author LIKE "Charles%" AND author LIKE "%Darwin";

SELECT author,title FROM classics WHERE
    author LIKE "%Mark Twain%" OR author LIKE "%Samuel Langhorne Clemens%";

SELECT author,title FROM classics WHERE
    author LIKE "Charles%" AND author NOT LIKE "%Darwin";
</code>
</pre>
<span>I&rsquo;ve chosen the first query, because Charles Darwin might be listed in some rows by</span>
<span>his full name, Charles Robert Darwin. Thus, the query returns publications as long as</span>
<span>the</span>
<span>&nbsp;author</span>
<span>&nbsp;column starts with</span>
<span>&nbsp;Charles</span>
<span>&nbsp;and ends with</span>
<span>&nbsp;Darwin</span>
<span>. The second query</span>
<span>searches for publications written using either Mark Twain&rsquo;s pen name or his real</span>
<span>name, Samuel Langhorne Clemens. The third query returns publications written by</span>
<span>authors with the first name Charles but not the surname Darwin.</span>
<h3>MySQL Functions</h3>
<span>You might wonder why anyone would want to use MySQL functions when PHP</span>
<span>comes with a whole bunch of powerful functions of its own. The answer is very simple: the MySQL functions work on the data right there in the database. If you were to</span>
<span>use PHP, you would first have to extract raw data from MySQL, manipulate it, and</span>
<span>then perform the database query you first wanted.</span>
<br/>
<span>Having functions built into MySQL substantially reduces the time needed for performing complex queries, as well as their complexity. If you wish to learn more about</span>
<span>the available string and date/time functions, you can visit the following URLs:</span>
<br/>
<span>http://tinyurl.com/mysqlstrings</span>
<span>http://tinyurl.com/mysqldates</span>
<br/>
<span>However, to get you started,</span>
<span>Appendix D</span>
<span>describes a subset containing the most useful of these functions.</span>
<h3>Accessing MySQL via phpMyAdmin</h3>
<span>Although to use MySQL you have to learn these main commands and how they work,</span>
<span>once you understand them, it can be much quicker and simpler to use a program</span>
<span>such as</span>
<span>phpMyAdmin</span>
<span>to manage your databases and tables.</span>
<br/>
<span>To do this, type the following to call up the XAMPP main page shown in</span>
<span>Figure 8-18</span>
<span>:</span>
<span>http://localhost/xampp</span>
<p><img src="images/8.18.png"/></p>
<span>Figure 8-18. The XAMPP Dashboard</span>
<br/>
<span>Now click the phpMyAdmin link toward the bottom of the lefthand menu to open up</span>
<span>the program (see</span>
<span>Figure 8-19</span>
<span>).</span>
<p><img src="images/8.19.png"/></p>
<span>Figure 8-19. The phpMyAdmin main screen</span>
<br/>
<span>In the lefthand pane of the main phpMyAdmin screen, you can click to select any</span>
<span>database you wish to work with. This will open the database and display its tables.</span>
<span>You can also click New to create a new database.</span>
<br/>
<span>From here you can perform all the main operations, such as creating new databases,</span>
<span>adding tables, creating indexes, and much more. To read the supporting documentation for phpMyAdmin, visit</span>
<span>https://docs.phpmyadmin.net</span>
<span>.</span>
<br/>
<span>If you worked with me through the examples in this chapter, congratulations&mdash;it&rsquo;s</span>
<span>been quite a long journey. You&rsquo;ve come all the way from learning how to create a</span>
<span>MySQL database through issuing complex queries that combine multiple tables, to</span>
<span>using Boolean operators and leveraging MySQL&rsquo;s various qualifiers.</span>
<br/>
<span>In the next chapter, we&rsquo;ll start looking at how to approach efficient database design,</span>
<span>advanced SQL techniques, and MySQL functions and transactions.</span>