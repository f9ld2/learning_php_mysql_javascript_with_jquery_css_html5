---
layout: default
---

  <h1>HTTP authentication with PHP</h1>


  <p class="simpara">
   It is possible to use the 
   <span class="function"><a href="function.header.html" class="function">header()</a></span> function to send an <em>&quot;Authentication Required&quot;</em> 
   message to the client browser causing it to pop up a Username/Password 
   input window.  Once the user has filled in a username and a password, 
   the URL containing the PHP script will be called again with the 
   <a href="reserved.variables.html" class="link">predefined variables</a> 
   <var class="varname"><var class="varname">PHP_AUTH_USER</var></var>, <var class="varname"><var class="varname">PHP_AUTH_PW</var></var>, 
   and <var class="varname"><var class="varname">AUTH_TYPE</var></var> set to the user name, password and 
   authentication type respectively.  These predefined variables are found 
   in the <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER</a></var></var> array. Both &quot;Basic&quot; and &quot;Digest&quot;
   (since PHP 5.1.0) authentication methods are supported. See the
   <span class="function"><a href="function.header.html" class="function">header()</a></span> function for more information.
  </p>

  <p class="para">
   An example script fragment which would force client authentication
   on a page is as follows:
  </p>
  <p class="para">
   <div class="example" id="example-377">
    <p><strong>Example #1 Basic HTTP Authentication example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">if&#xA0;(!isset(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;PHP_AUTH_USER&apos;</span><span style="color: #007700">]))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;WWW-Authenticate:&#xA0;Basic&#xA0;realm=&quot;My&#xA0;Realm&quot;&apos;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;HTTP/1.0&#xA0;401&#xA0;Unauthorized&apos;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&apos;Text&#xA0;to&#xA0;send&#xA0;if&#xA0;user&#xA0;hits&#xA0;Cancel&#xA0;button&apos;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;exit;<br>}&#xA0;else&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;p&gt;Hello&#xA0;</span><span style="color: #007700">{</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;PHP_AUTH_USER&apos;</span><span style="color: #007700">]}</span><span style="color: #DD0000">.&lt;/p&gt;&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;p&gt;You&#xA0;entered&#xA0;</span><span style="color: #007700">{</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;PHP_AUTH_PW&apos;</span><span style="color: #007700">]}</span><span style="color: #DD0000">&#xA0;as&#xA0;your&#xA0;password.&lt;/p&gt;&quot;</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <p class="para">
   <div class="example" id="example-378">
    <p><strong>Example #2 Digest HTTP Authentication example</strong></p>
    <div class="example-contents"><p>
     This example shows you how to implement a simple Digest HTTP
     authentication script. For more information read the <a href="http://www.faqs.org/rfcs/rfc2617" class="link external">&#xBB;&#xA0;RFC 2617</a>.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$realm&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;Restricted&#xA0;area&apos;</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//user&#xA0;=&gt;&#xA0;password<br></span><span style="color: #0000BB">$users&#xA0;</span><span style="color: #007700">=&#xA0;array(</span><span style="color: #DD0000">&apos;admin&apos;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&apos;mypass&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;guest&apos;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&apos;guest&apos;</span><span style="color: #007700">);<br><br><br>if&#xA0;(empty(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;PHP_AUTH_DIGEST&apos;</span><span style="color: #007700">]))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;HTTP/1.1&#xA0;401&#xA0;Unauthorized&apos;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;WWW-Authenticate:&#xA0;Digest&#xA0;realm=&quot;&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$realm</span><span style="color: #007700">.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&apos;&quot;,qop=&quot;auth&quot;,nonce=&quot;&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">uniqid</span><span style="color: #007700">().</span><span style="color: #DD0000">&apos;&quot;,opaque=&quot;&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">$realm</span><span style="color: #007700">).</span><span style="color: #DD0000">&apos;&quot;&apos;</span><span style="color: #007700">);<br><br>&#xA0;&#xA0;&#xA0;&#xA0;die(</span><span style="color: #DD0000">&apos;Text&#xA0;to&#xA0;send&#xA0;if&#xA0;user&#xA0;hits&#xA0;Cancel&#xA0;button&apos;</span><span style="color: #007700">);<br>}<br><br><br></span><span style="color: #FF8000">//&#xA0;analyze&#xA0;the&#xA0;PHP_AUTH_DIGEST&#xA0;variable<br></span><span style="color: #007700">if&#xA0;(!(</span><span style="color: #0000BB">$data&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">http_digest_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;PHP_AUTH_DIGEST&apos;</span><span style="color: #007700">]))&#xA0;||<br>&#xA0;&#xA0;&#xA0;&#xA0;!isset(</span><span style="color: #0000BB">$users</span><span style="color: #007700">[</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;username&apos;</span><span style="color: #007700">]]))<br>&#xA0;&#xA0;&#xA0;&#xA0;die(</span><span style="color: #DD0000">&apos;Wrong&#xA0;Credentials!&apos;</span><span style="color: #007700">);<br><br><br></span><span style="color: #FF8000">//&#xA0;generate&#xA0;the&#xA0;valid&#xA0;response<br></span><span style="color: #0000BB">$A1&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;username&apos;</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&apos;:&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$realm&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&apos;:&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$users</span><span style="color: #007700">[</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;username&apos;</span><span style="color: #007700">]]);<br></span><span style="color: #0000BB">$A2&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;REQUEST_METHOD&apos;</span><span style="color: #007700">].</span><span style="color: #DD0000">&apos;:&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;uri&apos;</span><span style="color: #007700">]);<br></span><span style="color: #0000BB">$valid_response&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">$A1</span><span style="color: #007700">.</span><span style="color: #DD0000">&apos;:&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;nonce&apos;</span><span style="color: #007700">].</span><span style="color: #DD0000">&apos;:&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;nc&apos;</span><span style="color: #007700">].</span><span style="color: #DD0000">&apos;:&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;cnonce&apos;</span><span style="color: #007700">].</span><span style="color: #DD0000">&apos;:&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;qop&apos;</span><span style="color: #007700">].</span><span style="color: #DD0000">&apos;:&apos;</span><span style="color: #007700">.</span><span style="color: #0000BB">$A2</span><span style="color: #007700">);<br><br>if&#xA0;(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;response&apos;</span><span style="color: #007700">]&#xA0;!=&#xA0;</span><span style="color: #0000BB">$valid_response</span><span style="color: #007700">)<br>&#xA0;&#xA0;&#xA0;&#xA0;die(</span><span style="color: #DD0000">&apos;Wrong&#xA0;Credentials!&apos;</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;ok,&#xA0;valid&#xA0;username&#xA0;&amp;&#xA0;password<br></span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&apos;You&#xA0;are&#xA0;logged&#xA0;in&#xA0;as:&#xA0;&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;username&apos;</span><span style="color: #007700">];<br><br><br></span><span style="color: #FF8000">//&#xA0;function&#xA0;to&#xA0;parse&#xA0;the&#xA0;http&#xA0;auth&#xA0;header<br></span><span style="color: #007700">function&#xA0;</span><span style="color: #0000BB">http_digest_parse</span><span style="color: #007700">(</span><span style="color: #0000BB">$txt</span><span style="color: #007700">)<br>{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;protect&#xA0;against&#xA0;missing&#xA0;data<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$needed_parts&#xA0;</span><span style="color: #007700">=&#xA0;array(</span><span style="color: #DD0000">&apos;nonce&apos;</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;nc&apos;</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;cnonce&apos;</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;qop&apos;</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;username&apos;</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;uri&apos;</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;response&apos;</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$data&#xA0;</span><span style="color: #007700">=&#xA0;array();<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$keys&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;|&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">array_keys</span><span style="color: #007700">(</span><span style="color: #0000BB">$needed_parts</span><span style="color: #007700">));<br><br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">preg_match_all</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;@(&apos;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$keys&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&apos;)=(?:([\&apos;&quot;])([^\2]+?)\2|([^\s,]+))@&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$txt</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$matches</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">PREG_SET_ORDER</span><span style="color: #007700">);<br><br>&#xA0;&#xA0;&#xA0;&#xA0;foreach&#xA0;(</span><span style="color: #0000BB">$matches&#xA0;</span><span style="color: #007700">as&#xA0;</span><span style="color: #0000BB">$m</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]]&#xA0;=&#xA0;</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #0000BB">3</span><span style="color: #007700">]&#xA0;?&#xA0;</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #0000BB">3</span><span style="color: #007700">]&#xA0;:&#xA0;</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #0000BB">4</span><span style="color: #007700">];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;unset(</span><span style="color: #0000BB">$needed_parts</span><span style="color: #007700">[</span><span style="color: #0000BB">$m</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]]);<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;</span><span style="color: #0000BB">$needed_parts&#xA0;</span><span style="color: #007700">?&#xA0;</span><span style="color: #0000BB">false&#xA0;</span><span style="color: #007700">:&#xA0;</span><span style="color: #0000BB">$data</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>

  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <strong>Compatibility Note</strong><br>
   </p><p class="para">
    Please be careful when coding the HTTP header lines. In order to guarantee maximum
    compatibility with all clients, the keyword &quot;Basic&quot; should be written with an
    uppercase &quot;B&quot;, the realm string must be enclosed in double (not single) quotes,
    and exactly one space should precede the <em class="emphasis">401</em> code in the 
    <em class="emphasis">HTTP/1.0 401</em> header line. Authentication parameters have
    to be comma-separated as seen in the digest example above.
   </p>
  <p></p></blockquote>

  <p class="para">
   Instead of simply printing out <var class="varname"><var class="varname">PHP_AUTH_USER</var></var> 
   and <var class="varname"><var class="varname">PHP_AUTH_PW</var></var>, as done in the above example, 
   you may want to check the username and password for validity.  
   Perhaps by sending a query to a database, or by looking up the 
   user in a dbm file.
  </p>

  <p class="para">
   Watch out for buggy Internet Explorer browsers out there.  They
   seem very picky about the order of the headers.  Sending the
   <em class="emphasis">WWW-Authenticate</em> header before the
   <em>HTTP/1.0 401</em> header seems to do the trick
   for now.
  </p>

  <p class="simpara">
   In order to prevent someone from writing a script which
   reveals the password for a page that was authenticated through a
   traditional external mechanism, the PHP_AUTH variables will not be 
   set if external authentication is enabled for that particular
   page and <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe mode</a> is enabled.  Regardless, 
   <var class="varname"><var class="varname">REMOTE_USER</var></var> can be used 
   to identify the externally-authenticated user.  So, you can use  
   <var class="varname"><var class="varname"><a href="reserved.variables.server.html" class="classname">$_SERVER[&apos;REMOTE_USER&apos;]</a></var></var>.
  </p>

  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <strong>Configuration Note</strong><br>
   </p><p class="para">
    PHP uses the presence of an <em>AuthType</em> directive
    to determine whether external authentication is in effect.
   </p>
  <p></p></blockquote>

  <p class="simpara">
   Note, however, that the above does not prevent someone who
   controls a non-authenticated URL from stealing passwords from
   authenticated URLs on the same server.
  </p>
  <p class="simpara">
   Both Netscape Navigator and Internet Explorer will clear the local browser
   window&apos;s authentication cache for the realm upon receiving a
   server response of 401. This can effectively &quot;log out&quot; a user,
   forcing them to re-enter their username and password. Some people
   use this to &quot;time out&quot; logins, or provide a &quot;log-out&quot; button.
  </p>
  <p class="para">
   <div class="example" id="example-379">
    <p><strong>Example #3 HTTP Authentication example forcing a new name/password</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">function&#xA0;</span><span style="color: #0000BB">authenticate</span><span style="color: #007700">()&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;WWW-Authenticate:&#xA0;Basic&#xA0;realm=&quot;Test&#xA0;Authentication&#xA0;System&quot;&apos;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">&apos;HTTP/1.0&#xA0;401&#xA0;Unauthorized&apos;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;You&#xA0;must&#xA0;enter&#xA0;a&#xA0;valid&#xA0;login&#xA0;ID&#xA0;and&#xA0;password&#xA0;to&#xA0;access&#xA0;this&#xA0;resource\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;exit;<br>}<br>&#xA0;<br>if&#xA0;(!isset(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;PHP_AUTH_USER&apos;</span><span style="color: #007700">])&#xA0;||<br>&#xA0;&#xA0;&#xA0;&#xA0;(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;SeenBefore&apos;</span><span style="color: #007700">]&#xA0;==&#xA0;</span><span style="color: #0000BB">1&#xA0;</span><span style="color: #007700">&amp;&amp;&#xA0;</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;OldAuth&apos;</span><span style="color: #007700">]&#xA0;==&#xA0;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;PHP_AUTH_USER&apos;</span><span style="color: #007700">]))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">authenticate</span><span style="color: #007700">();<br>}&#xA0;else&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;p&gt;Welcome:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;PHP_AUTH_USER&apos;</span><span style="color: #007700">])&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;&lt;br&#xA0;/&gt;&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Old:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$_REQUEST</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;OldAuth&apos;</span><span style="color: #007700">]);<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;form&#xA0;action=&apos;&apos;&#xA0;method=&apos;post&apos;&gt;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;input&#xA0;type=&apos;hidden&apos;&#xA0;name=&apos;SeenBefore&apos;&#xA0;value=&apos;1&apos;&#xA0;/&gt;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;input&#xA0;type=&apos;hidden&apos;&#xA0;name=&apos;OldAuth&apos;&#xA0;value=\&quot;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">htmlspecialchars</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;PHP_AUTH_USER&apos;</span><span style="color: #007700">])&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;\&quot;&#xA0;/&gt;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;input&#xA0;type=&apos;submit&apos;&#xA0;value=&apos;Re&#xA0;Authenticate&apos;&#xA0;/&gt;\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;/form&gt;&lt;/p&gt;\n&quot;</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="simpara">
   This behavior is not required by the <em>HTTP Basic</em>
   authentication standard, so you should never depend on this. Testing with
   <em>Lynx</em> has shown that <em>Lynx</em> does not clear
   the authentication credentials with a 401 server response, so pressing back
   and then forward again will open the resource as long as the credential
   requirements haven&apos;t changed. The user can press the
   <em>&apos;_&apos;</em> key to clear their authentication information, however.
  </p>
  <p class="simpara">
   In order to get HTTP Authentication to work using IIS server with the CGI version
   of PHP you must edit your IIS configuration &quot;<em>Directory Security</em>&quot;.
   Click on &quot;<em>Edit</em>&quot; and only check
   &quot;<em>Anonymous Access</em>&quot;, all other fields
   should be left unchecked.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <strong>IIS Note:</strong><br>
   <span class="simpara">
    For HTTP Authentication to work with IIS, the PHP directive
    <a href="ini.core.html#ini.cgi.rfc2616-headers" class="link">cgi.rfc2616_headers</a> must
    be set to <em>0</em> (the default value).
   </span>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    If <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe mode</a> is enabled, the
    uid of the script is added to the <em>realm</em> part of
    the <em>WWW-Authenticate</em> header.
   </p>
  <p></p></blockquote>

 