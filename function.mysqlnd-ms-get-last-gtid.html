---
layout: default
---

 <div class="refnamediv">
  <h1 class="refname">mysqlnd_ms_get_last_gtid</h1>
  <p class="verinfo">(PECL mysqlnd_ms &gt;= 1.2.0)</p><p class="refpurpose"><span class="refname">mysqlnd_ms_get_last_gtid</span> &#x2014; <span class="dc-title">Returns the latest global transaction ID</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.mysqlnd-ms-get-last-gtid-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> 
   <span class="methodname"><strong>mysqlnd_ms_get_last_gtid</strong></span>
    ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$connection</code></span>
   )</div>

  <p class="para rdfs-comment">
   Returns a global transaction identifier which belongs to a write operation no
   older than the last write performed by the client. It is not guaranteed that
   the global transaction identifier is identical to that one created for the
   last write transaction performed by the client.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysqlnd-ms-get-last-gtid-parameters">
  <h3 class="title">Parameters</h3>
  <dl>

   
    <dt>
<code class="parameter">connection</code></dt>

    <dd>

     <p class="para">
      A PECL/mysqlnd_ms connection handle to a MySQL server of the type
      <a href="ref.pdo-mysql.html" class="link">PDO_MYSQL</a>, <a href="book.mysqli.html" class="link">mysqli</a>&gt; or
      <a href="book.mysql.html" class="link">ext/mysql</a>.
      The connection handle is obtained when opening a connection with
      a host name that matches a mysqlnd_ms configuration file
      entry using any of the above three MySQL driver extensions.
     </p>
    </dd>

   
  </dl>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysqlnd-ms-get-last-gtid-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns a global transaction ID (GTID) on success.
   Otherwise, returns <strong><code>FALSE</code></strong>.
  </p>
  <p class="para">
   The function <span class="function"><strong>mysqlnd_ms_get_last_gtid()</strong></span> returns the
   GTID obtained when executing the SQL statement from
   the <em>fetch_last_gtid</em> entry of the
   <em>global_transaction_id_injection</em> section from
   the plugins configuration file.
  </p>
  <p class="para">
   The function may be called after the GTID has been incremented.
  </p>
 </div>


 <div class="refsect1 unknown-returnvaluet" id="refsect1-function.mysqlnd-ms-get-last-gtid-unknown-returnvaluet">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    <span class="function"><strong>mysqlnd_ms_get_last_gtid()</strong></span> requires
    PHP &gt;= 5.4.0 and PECL mysqlnd_ms &gt;= 1.2.0. Internally, it is using
    a <em>mysqlnd</em> library C functionality not available with PHP 5.3.
   </p>
   <p class="para">
     Please note, all MySQL 5.6 production versions do not provide
     clients with enough information to use GTIDs for enforcing session consistency.
     In the worst case, the plugin will choose the master only.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mysqlnd-ms-get-last-gtid-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-2082">
    <p><strong>Example #1 <span class="function"><strong>mysqlnd_ms_get_last_gtid()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">/*&#xA0;Open&#xA0;mysqlnd_ms&#xA0;connection&#xA0;using&#xA0;mysqli,&#xA0;PDO_MySQL&#xA0;or&#xA0;mysql&#xA0;extension&#xA0;*/<br></span><span style="color: #0000BB">$mysqli&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;myapp&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;username&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;password&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;database&quot;</span><span style="color: #007700">);<br>if&#xA0;(!</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">)<br>&#xA0;&#xA0;</span><span style="color: #FF8000">/*&#xA0;Of&#xA0;course,&#xA0;your&#xA0;error&#xA0;handling&#xA0;is&#xA0;nicer...&#xA0;*/<br>&#xA0;&#xA0;</span><span style="color: #007700">die(</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;[%d]&#xA0;%s\n&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">mysqli_connect_errno</span><span style="color: #007700">(),&#xA0;</span><span style="color: #0000BB">mysqli_connect_error</span><span style="color: #007700">()));<br><br></span><span style="color: #FF8000">/*&#xA0;auto&#xA0;commit&#xA0;mode,&#xA0;transaction&#xA0;on&#xA0;master,&#xA0;GTID&#xA0;must&#xA0;be&#xA0;incremented&#xA0;*/<br></span><span style="color: #007700">if&#xA0;(!</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;DROP&#xA0;TABLE&#xA0;IF&#xA0;EXISTS&#xA0;test&quot;</span><span style="color: #007700">))<br>&#xA0;&#xA0;die(</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;[%d]&#xA0;%s\n&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errno</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;GTID&#xA0;after&#xA0;transaction&#xA0;%s\n&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">mysqlnd_ms_get_last_gtid</span><span style="color: #007700">(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">));<br><br></span><span style="color: #FF8000">/*&#xA0;auto&#xA0;commit&#xA0;mode,&#xA0;transaction&#xA0;on&#xA0;master,&#xA0;GTID&#xA0;must&#xA0;be&#xA0;incremented&#xA0;*/<br></span><span style="color: #007700">if&#xA0;(!</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;CREATE&#xA0;TABLE&#xA0;test(id&#xA0;INT)&quot;</span><span style="color: #007700">))<br>&#xA0;&#xA0;die(</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;[%d]&#xA0;%s\n&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errno</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error</span><span style="color: #007700">));<br><br></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;GTID&#xA0;after&#xA0;transaction&#xA0;%s\n&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">mysqlnd_ms_get_last_gtid</span><span style="color: #007700">(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">));<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysqlnd-ms-get-last-gtid-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member">
     <a href="mysqlnd-ms.gtid.html" class="link">Global Transaction IDs</a>
    </li>
   </ul>
  </p>
 </div>


