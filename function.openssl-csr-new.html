---
layout: default
---

 <div class="refnamediv">
  <h1 class="refname">openssl_csr_new</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">openssl_csr_new</span> &#x2014; <span class="dc-title">Generates a CSR</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.openssl-csr-new-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <span class="methodname"><strong>openssl_csr_new</strong></span>
    ( <span class="methodparam"><span class="type">array</span> <code class="parameter">$dn</code></span>
   , <span class="methodparam"><span class="type">resource</span> <code class="parameter reference">&amp;$privkey</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$configargs</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$extraattribs</code></span>
  ]] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>openssl_csr_new()</strong></span> generates a new CSR (Certificate Signing Request)
   based on the information provided by <code class="parameter">dn</code>, which represents the
   Distinguished Name to be used in the certificate.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
 <span class="simpara">
  You need to have a valid <var class="filename">openssl.cnf</var> installed for
  this function to operate correctly.
  See the notes under <a href="openssl.installation.html" class="link">the installation
  section</a> for more information.
 </span>
</p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.openssl-csr-new-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">dn</code></dt>

     <dd>

      <p class="para">
       The Distinguished Name to be used in the certificate.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">privkey</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">privkey</code> should be set to a private key that was
       previously generated by <span class="function"><a href="function.openssl-pkey-new.html" class="function">openssl_pkey_new()</a></span> (or
       otherwise obtained from the other openssl_pkey family of functions).
       The corresponding public portion of the key will be used to sign the
       CSR.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">configargs</code></dt>

     <dd>

      <p class="para">
       By default, the information in your system <em>openssl.conf</em>
       is used to initialize the request; you can specify a configuration file
       section by setting the <em>config_section_section</em> key of
       <code class="parameter">configargs</code>.  You can also specify an alternative
       openssl configuration file by setting the value of the
       <em>config</em> key to the path of the file you want to use.
       The following keys, if present in <code class="parameter">configargs</code>
       behave as their equivalents in the <em>openssl.conf</em>, as
       listed in the table below.
       <table class="doctable table">
        <caption><strong>Configuration overrides</strong></caption>
        
         <thead>
          <tr>
           <th><code class="parameter">configargs</code> key</th>
           <th>type</th>
           <th><em>openssl.conf</em> equivalent</th>
           <th>description</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td>digest_alg</td>
           <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td>
           <td>default_md</td>
           <td>Selects which digest method to use</td>
          </tr>

          <tr>
           <td>x509_extensions</td>
           <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td>
           <td>x509_extensions</td>
           <td>Selects which extensions should be used when creating an x509
           certificate</td>
          </tr>

          <tr>
           <td>req_extensions</td>
           <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td>
           <td>req_extensions</td>
           <td>Selects which extensions should be used when creating a CSR</td>
          </tr>

          <tr>
           <td>private_key_bits</td>
           <td><span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span></td>
           <td>default_bits</td>
           <td>Specifies how many bits should be used to generate a private
            key</td>
          </tr>

          <tr>
           <td>private_key_type</td>
           <td><span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span></td>
           <td>none</td>
           <td>Specifies the type of private key to create.  This can be one
            of <strong><code>OPENSSL_KEYTYPE_DSA</code></strong>,
            <strong><code>OPENSSL_KEYTYPE_DH</code></strong> or
            <strong><code>OPENSSL_KEYTYPE_RSA</code></strong>.
            The default value is <strong><code>OPENSSL_KEYTYPE_RSA</code></strong> which
            is currently the only supported key type.
           </td>
          </tr>

          <tr>
           <td>encrypt_key</td>
           <td><span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span></td>
           <td>encrypt_key</td>
           <td>Should an exported key (with passphrase) be encrypted?</td>
          </tr>

          <tr>
           <td>encrypt_key_cipher</td>
           <td><span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span></td>
           <td>none</td>
           <td>
            One of <a href="openssl.ciphers.html" class="link">cipher constants</a>.
           </td>
          </tr>

         </tbody>
        
       </table>

      </p>
     </dd>

    
    
     <dt>
<code class="parameter">extraattribs</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">extraattribs</code> is used to specify additional
       configuration options for the CSR.  Both <code class="parameter">dn</code> and
       <code class="parameter">extraattribs</code> are associative arrays whose keys are
       converted to OIDs and applied to the relevant part of the request.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.openssl-csr-new-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the CSR.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.openssl-csr-new-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-934">
    <p><strong>Example #1 Creating a self-signed-certificate</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&#xA0;Fill&#xA0;in&#xA0;data&#xA0;for&#xA0;the&#xA0;distinguished&#xA0;name&#xA0;to&#xA0;be&#xA0;used&#xA0;in&#xA0;the&#xA0;cert<br>//&#xA0;You&#xA0;must&#xA0;change&#xA0;the&#xA0;values&#xA0;of&#xA0;these&#xA0;keys&#xA0;to&#xA0;match&#xA0;your&#xA0;name&#xA0;and<br>//&#xA0;company,&#xA0;or&#xA0;more&#xA0;precisely,&#xA0;the&#xA0;name&#xA0;and&#xA0;company&#xA0;of&#xA0;the&#xA0;person/site<br>//&#xA0;that&#xA0;you&#xA0;are&#xA0;generating&#xA0;the&#xA0;certificate&#xA0;for.<br>//&#xA0;For&#xA0;SSL&#xA0;certificates,&#xA0;the&#xA0;commonName&#xA0;is&#xA0;usually&#xA0;the&#xA0;domain&#xA0;name&#xA0;of<br>//&#xA0;that&#xA0;will&#xA0;be&#xA0;using&#xA0;the&#xA0;certificate,&#xA0;but&#xA0;for&#xA0;S/MIME&#xA0;certificates,<br>//&#xA0;the&#xA0;commonName&#xA0;will&#xA0;be&#xA0;the&#xA0;name&#xA0;of&#xA0;the&#xA0;individual&#xA0;who&#xA0;will&#xA0;use&#xA0;the<br>//&#xA0;certificate.<br></span><span style="color: #0000BB">$dn&#xA0;</span><span style="color: #007700">=&#xA0;array(<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&quot;countryName&quot;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&quot;UK&quot;</span><span style="color: #007700">,<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&quot;stateOrProvinceName&quot;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&quot;Somerset&quot;</span><span style="color: #007700">,<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&quot;localityName&quot;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&quot;Glastonbury&quot;</span><span style="color: #007700">,<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&quot;organizationName&quot;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&quot;The&#xA0;Brain&#xA0;Room&#xA0;Limited&quot;</span><span style="color: #007700">,<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&quot;organizationalUnitName&quot;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&quot;PHP&#xA0;Documentation&#xA0;Team&quot;</span><span style="color: #007700">,<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&quot;commonName&quot;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&quot;Wez&#xA0;Furlong&quot;</span><span style="color: #007700">,<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&quot;emailAddress&quot;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&quot;wez@example.com&quot;<br></span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;Generate&#xA0;a&#xA0;new&#xA0;private&#xA0;(and&#xA0;public)&#xA0;key&#xA0;pair<br></span><span style="color: #0000BB">$privkey&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">openssl_pkey_new</span><span style="color: #007700">();<br><br></span><span style="color: #FF8000">//&#xA0;Generate&#xA0;a&#xA0;certificate&#xA0;signing&#xA0;request<br></span><span style="color: #0000BB">$csr&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">openssl_csr_new</span><span style="color: #007700">(</span><span style="color: #0000BB">$dn</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$privkey</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;You&#xA0;will&#xA0;usually&#xA0;want&#xA0;to&#xA0;create&#xA0;a&#xA0;self-signed&#xA0;certificate&#xA0;at&#xA0;this<br>//&#xA0;point&#xA0;until&#xA0;your&#xA0;CA&#xA0;fulfills&#xA0;your&#xA0;request.<br>//&#xA0;This&#xA0;creates&#xA0;a&#xA0;self-signed&#xA0;cert&#xA0;that&#xA0;is&#xA0;valid&#xA0;for&#xA0;365&#xA0;days<br></span><span style="color: #0000BB">$sscert&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">openssl_csr_sign</span><span style="color: #007700">(</span><span style="color: #0000BB">$csr</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">null</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$privkey</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">365</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;Now&#xA0;you&#xA0;will&#xA0;want&#xA0;to&#xA0;preserve&#xA0;your&#xA0;private&#xA0;key,&#xA0;CSR&#xA0;and&#xA0;self-signed<br>//&#xA0;cert&#xA0;so&#xA0;that&#xA0;they&#xA0;can&#xA0;be&#xA0;installed&#xA0;into&#xA0;your&#xA0;web&#xA0;server,&#xA0;mail&#xA0;server<br>//&#xA0;or&#xA0;mail&#xA0;client&#xA0;(depending&#xA0;on&#xA0;the&#xA0;intended&#xA0;use&#xA0;of&#xA0;the&#xA0;certificate).<br>//&#xA0;This&#xA0;example&#xA0;shows&#xA0;how&#xA0;to&#xA0;get&#xA0;those&#xA0;things&#xA0;into&#xA0;variables,&#xA0;but&#xA0;you<br>//&#xA0;can&#xA0;also&#xA0;store&#xA0;them&#xA0;directly&#xA0;into&#xA0;files.<br>//&#xA0;Typically,&#xA0;you&#xA0;will&#xA0;send&#xA0;the&#xA0;CSR&#xA0;on&#xA0;to&#xA0;your&#xA0;CA&#xA0;who&#xA0;will&#xA0;then&#xA0;issue<br>//&#xA0;you&#xA0;with&#xA0;the&#xA0;&quot;real&quot;&#xA0;certificate.<br></span><span style="color: #0000BB">openssl_csr_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$csr</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$csrout</span><span style="color: #007700">)&#xA0;and&#xA0;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$csrout</span><span style="color: #007700">);<br></span><span style="color: #0000BB">openssl_x509_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$sscert</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$certout</span><span style="color: #007700">)&#xA0;and&#xA0;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$certout</span><span style="color: #007700">);<br></span><span style="color: #0000BB">openssl_pkey_export</span><span style="color: #007700">(</span><span style="color: #0000BB">$privkey</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$pkeyout</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;mypassword&quot;</span><span style="color: #007700">)&#xA0;and&#xA0;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$pkeyout</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&#xA0;Show&#xA0;any&#xA0;errors&#xA0;that&#xA0;occurred&#xA0;here<br></span><span style="color: #007700">while&#xA0;((</span><span style="color: #0000BB">$e&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">openssl_error_string</span><span style="color: #007700">())&#xA0;!==&#xA0;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #0000BB">$e&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&quot;\n&quot;</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


