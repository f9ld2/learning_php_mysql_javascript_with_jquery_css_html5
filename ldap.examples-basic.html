---
layout: default
---

  <h2 class="title">Basic usage</h2>
  <p class="para">
   Retrieve information for all entries where the surname starts
   with &quot;S&quot; from a directory server, displaying an extract with
   name and email address.
  </p>

  <div class="example" id="example-4934">
   <p><strong>Example #1 LDAP search example</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&#xA0;basic&#xA0;sequence&#xA0;with&#xA0;LDAP&#xA0;is&#xA0;connect,&#xA0;bind,&#xA0;search,&#xA0;interpret&#xA0;search<br>//&#xA0;result,&#xA0;close&#xA0;connection<br><br></span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;h3&gt;LDAP&#xA0;query&#xA0;test&lt;/h3&gt;&quot;</span><span style="color: #007700">;<br>echo&#xA0;</span><span style="color: #DD0000">&quot;Connecting&#xA0;...&quot;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$ds</span><span style="color: #007700">=</span><span style="color: #0000BB">ldap_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">&quot;localhost&quot;</span><span style="color: #007700">);&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;must&#xA0;be&#xA0;a&#xA0;valid&#xA0;LDAP&#xA0;server!<br></span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&quot;connect&#xA0;result&#xA0;is&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$ds&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&quot;&lt;br&#xA0;/&gt;&quot;</span><span style="color: #007700">;<br><br>if&#xA0;(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">)&#xA0;{&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Binding&#xA0;...&quot;</span><span style="color: #007700">;&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$r</span><span style="color: #007700">=</span><span style="color: #0000BB">ldap_bind</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">);&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;this&#xA0;is&#xA0;an&#xA0;&quot;anonymous&quot;&#xA0;bind,&#xA0;typically<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;read-only&#xA0;access<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">echo&#xA0;</span><span style="color: #DD0000">&quot;Bind&#xA0;result&#xA0;is&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$r&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&quot;&lt;br&#xA0;/&gt;&quot;</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Searching&#xA0;for&#xA0;(sn=S*)&#xA0;...&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;Search&#xA0;surname&#xA0;entry<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$sr</span><span style="color: #007700">=</span><span style="color: #0000BB">ldap_search</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;o=My&#xA0;Company,&#xA0;c=US&quot;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;sn=S*&quot;</span><span style="color: #007700">);&#xA0;&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Search&#xA0;result&#xA0;is&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$sr&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #DD0000">&quot;&lt;br&#xA0;/&gt;&quot;</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Number&#xA0;of&#xA0;entries&#xA0;returned&#xA0;is&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">ldap_count_entries</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$sr</span><span style="color: #007700">)&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;&lt;br&#xA0;/&gt;&quot;</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Getting&#xA0;entries&#xA0;...&lt;p&gt;&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$info&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">ldap_get_entries</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$sr</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Data&#xA0;for&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">&quot;count&quot;</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;&#xA0;items&#xA0;returned:&lt;p&gt;&quot;</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;for&#xA0;(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&#xA0;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">&quot;count&quot;</span><span style="color: #007700">];&#xA0;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;dn&#xA0;is:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">][</span><span style="color: #DD0000">&quot;dn&quot;</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;&lt;br&#xA0;/&gt;&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;first&#xA0;cn&#xA0;entry&#xA0;is:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">][</span><span style="color: #DD0000">&quot;cn&quot;</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;&lt;br&#xA0;/&gt;&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;first&#xA0;email&#xA0;entry&#xA0;is:&#xA0;&quot;&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">][</span><span style="color: #DD0000">&quot;mail&quot;</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">]&#xA0;.&#xA0;</span><span style="color: #DD0000">&quot;&lt;br&#xA0;/&gt;&lt;hr&#xA0;/&gt;&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Closing&#xA0;connection&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">ldap_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$ds</span><span style="color: #007700">);<br><br>}&#xA0;else&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;&lt;h4&gt;Unable&#xA0;to&#xA0;connect&#xA0;to&#xA0;LDAP&#xA0;server&lt;/h4&gt;&quot;</span><span style="color: #007700">;<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 