---
layout: default
---

 <h1>Constructing signal events</h1>

 <p class="para">
  Event can also watch for POSIX-style signals. To construct a handler for a
  signal, use
  <span class="methodname"><a href="event.construct.html" class="methodname">Event::__construct()</a></span>
  constructor with
  <strong><code>Event::SIGNAL</code></strong>
  flag, or
  <span class="methodname"><a href="event.signal.html" class="methodname">Event::signal()</a></span>
  factory method.
 </p>
 <div class="example" id="example-4829">
  <p><strong>Example #1 Handling <em>SIGTERM</em> signal</strong></p>
  <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">/*<br>Launch&#xA0;it&#xA0;in&#xA0;a&#xA0;terminal&#xA0;window:<br><br>$&#xA0;php&#xA0;examples/signal.php<br><br>In&#xA0;another&#xA0;terminal&#xA0;window&#xA0;find&#xA0;out&#xA0;the&#xA0;pid&#xA0;and&#xA0;send&#xA0;SIGTERM,&#xA0;e.g.:<br><br>$&#xA0;ps&#xA0;aux&#xA0;|&#xA0;grep&#xA0;examp<br>ruslan&#xA0;&#xA0;&#xA0;&#xA0;3976&#xA0;&#xA0;0.2&#xA0;&#xA0;0.0&#xA0;139896&#xA0;11256&#xA0;pts/1&#xA0;&#xA0;&#xA0;&#xA0;S+&#xA0;&#xA0;&#xA0;10:25&#xA0;&#xA0;&#xA0;0:00&#xA0;php&#xA0;examples/signal.php<br>ruslan&#xA0;&#xA0;&#xA0;&#xA0;3978&#xA0;&#xA0;0.0&#xA0;&#xA0;0.0&#xA0;&#xA0;&#xA0;9572&#xA0;&#xA0;&#xA0;864&#xA0;pts/2&#xA0;&#xA0;&#xA0;&#xA0;S+&#xA0;&#xA0;&#xA0;10:26&#xA0;&#xA0;&#xA0;0:00&#xA0;grep&#xA0;--color=auto&#xA0;examp<br>$&#xA0;kill&#xA0;-TERM&#xA0;3976<br><br>At&#xA0;the&#xA0;first&#xA0;terminal&#xA0;window&#xA0;you&#xA0;should&#xA0;catch&#xA0;the&#xA0;following:<br><br>Caught&#xA0;signal&#xA0;15<br>*/<br></span><span style="color: #007700">class&#xA0;</span><span style="color: #0000BB">MyEventSignal&#xA0;</span><span style="color: #007700">{<br>&#xA0;&#xA0;&#xA0;&#xA0;private&#xA0;</span><span style="color: #0000BB">$base</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$ev</span><span style="color: #007700">;<br><br>&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;function&#xA0;</span><span style="color: #0000BB">__construct</span><span style="color: #007700">(</span><span style="color: #0000BB">$base</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">base&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$base</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ev&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">Event</span><span style="color: #007700">::</span><span style="color: #0000BB">signal</span><span style="color: #007700">(</span><span style="color: #0000BB">$base</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">SIGTERM</span><span style="color: #007700">,&#xA0;array(</span><span style="color: #0000BB">$this</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;eventSighandler&apos;</span><span style="color: #007700">));<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ev</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">();<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;&#xA0;&#xA0;public&#xA0;function&#xA0;</span><span style="color: #0000BB">eventSighandler</span><span style="color: #007700">(</span><span style="color: #0000BB">$no</span><span style="color: #007700">,&#xA0;</span><span style="color: #0000BB">$c</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Caught&#xA0;signal&#xA0;</span><span style="color: #0000BB">$no</span><span style="color: #DD0000">\n&quot;</span><span style="color: #007700">;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">base</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">exit</span><span style="color: #007700">();<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>}<br><br></span><span style="color: #0000BB">$base&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">EventBase</span><span style="color: #007700">();<br></span><span style="color: #0000BB">$c&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">MyEventSignal</span><span style="color: #007700">(</span><span style="color: #0000BB">$base</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$base</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">loop</span><span style="color: #007700">();<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
  </div>

 </div>
 <p class="para">
  Note that signal callbacks are run in the event loop after the signal
  occurs, so it is safe for them to call functions that you are not supposed
  to call from a regular POSIX signal handler.
 </p>
 <p class="para">
 </p><p class="para">
  See also
  <a href="http://www.wangafu.net/~nickm/libevent-book/Ref4_event.html#_constructing_signal_events" class="link external">&#xBB;&#xA0;Fast
 portable non-blocking network programming with Libevent, Constructing Signal
 Events</a>
  .
 </p>
