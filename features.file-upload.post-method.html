---
layout: default
---

   <h2 class="title">POST method uploads</h2>
   <p class="simpara">
    This feature lets people upload both text and binary files. 
    With PHP&apos;s authentication and file manipulation functions,
    you have full control over who is allowed to upload and
    what is to be done with the file once it has been uploaded.
   </p>
   <p class="simpara">
    PHP is capable of receiving file uploads from any RFC-1867
    compliant browser.
   </p>

   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <strong>Related Configurations Note</strong><br>
    </p><p class="para">
     See also the <a href="ini.core.html#ini.file-uploads" class="link">file_uploads</a>, 
     <a href="ini.core.html#ini.upload-max-filesize" class="link">upload_max_filesize</a>,
     <a href="ini.core.html#ini.upload-tmp-dir" class="link">upload_tmp_dir</a>,
     <a href="ini.core.html#ini.post-max-size" class="link">post_max_size</a> and
     <a href="info.configuration.html#ini.max-input-time" class="link">max_input_time</a> directives 
     in <var class="filename">php.ini</var>
    </p>
   <p></p></blockquote>

   <p class="para">
    PHP also supports PUT-method file uploads as used by
    <span class="productname">Netscape Composer</span> and W3C&apos;s 
    <span class="productname">Amaya</span> clients.  See the <a href="features.file-upload.put-method.html" class="link">PUT Method
    Support</a> for more details.
   </p>

   <p class="para">
    <div class="example" id="example-382">
     <p><strong>Example #1 File Upload Form</strong></p>
     <div class="example-contents"><p>
      A file upload screen can be built by creating a special form which
      looks something like this:
     </p></div>
     <div class="example-contents">
<div class="htmlcode"><pre class="htmlcode">&lt;!-- The data encoding type, enctype, MUST be specified as below --&gt;
&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;__URL__&quot; method=&quot;POST&quot;&gt;
    &lt;!-- MAX_FILE_SIZE must precede the file input field --&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;MAX_FILE_SIZE&quot; value=&quot;30000&quot; /&gt;
    &lt;!-- Name of input element determines name in $_FILES array --&gt;
    Send this file: &lt;input name=&quot;userfile&quot; type=&quot;file&quot; /&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Send File&quot; /&gt;
&lt;/form&gt;</pre>
</div>
     </div>

     <div class="example-contents"><p>
      The <em>__URL__</em> in the above example should be replaced,
      and point to a PHP file.
     </p></div>
     <div class="example-contents"><p>
      The <em>MAX_FILE_SIZE</em> hidden field (measured in bytes) must
      precede the file input field, and its value is the maximum filesize accepted by PHP.
      This form element should always be used as it saves users the trouble of
      waiting for a big file being transferred only to find that it was too
      large and the transfer failed.  Keep in mind: fooling this setting on the
      browser side is quite easy, so never rely on files with a greater size
      being blocked by this feature. It is merely a convenience feature for
      users on the client side of the application. The PHP settings (on the server
      side) for maximum-size, however, cannot be fooled.
     </p></div>
    </div>
   </p>

   <blockquote class="note"><p><strong class="note">Note</strong>: 
    </p><p class="para">
     Be sure your file upload form has attribute <em>enctype=&quot;multipart/form-data&quot;</em>
     otherwise the file upload will not work.
    </p>
   <p></p></blockquote>

   <p class="para">
    The global <var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES</a></var></var> will contain all the uploaded file information.
    Its contents from the example form is as follows. Note that this assumes the use of 
    the file upload name <em class="emphasis">userfile</em>, as used in the example 
    script above. This can be any name.
    <dl>

     
      <dt>
<var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;name&apos;]</a></var></var></dt>

      <dd>

       <p class="para">
        The original name of the file on the client machine.
       </p>
      </dd>

     
     
      <dt>
<var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;type&apos;]</a></var></var></dt>

      <dd>

       <p class="para">
        The mime type of the file, if the browser provided this
        information.  An example would be
        <em>&quot;image/gif&quot;</em>. This mime type is however
        not checked on the PHP side and therefore don&apos;t take its value
        for granted.
       </p>
      </dd>

     
     
      <dt>
<var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;size&apos;]</a></var></var></dt>

      <dd>

       <p class="para">
        The size, in bytes, of the uploaded file.
       </p>
      </dd>

     
     
      <dt>
<var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;tmp_name&apos;]</a></var></var></dt>

      <dd>

       <p class="para">
        The temporary filename of the file in which the uploaded file
        was stored on the server.
       </p>
      </dd>

     
     
      <dt>
<var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;error&apos;]</a></var></var></dt>

      <dd>

       <p class="para">
        The <a href="features.file-upload.errors.html" class="link">error code</a>
        associated with this file upload.
       </p>
      </dd>

     
    </dl>

   </p>

   <p class="para">
    Files will, by default be stored in the server&apos;s default temporary
    directory, unless another location has been given with the <a href="ini.core.html#ini.upload-tmp-dir" class="link">upload_tmp_dir</a> directive in
    <var class="filename">php.ini</var>. The server&apos;s default directory can
    be changed by setting the environment variable
    <span class="envar">TMPDIR</span> in the environment in which PHP runs.
    Setting it using <span class="function"><a href="function.putenv.html" class="function">putenv()</a></span> from within a PHP
    script will not work. This environment variable can also be used
    to make sure that other operations are working on uploaded files,
    as well.
    <div class="example" id="example-383">
     <p><strong>Example #2 Validating file uploads</strong></p>
     <div class="example-contents"><p>
      See also the function entries for <span class="function"><a href="function.is-uploaded-file.html" class="function">is_uploaded_file()</a></span> 
      and <span class="function"><a href="function.move-uploaded-file.html" class="function">move_uploaded_file()</a></span> for further information. The
      following example will process the file upload that came from a form.
     </p></div>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&#xA0;In&#xA0;PHP&#xA0;versions&#xA0;earlier&#xA0;than&#xA0;4.1.0,&#xA0;$HTTP_POST_FILES&#xA0;should&#xA0;be&#xA0;used&#xA0;instead<br>//&#xA0;of&#xA0;$_FILES.<br><br></span><span style="color: #0000BB">$uploaddir&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #DD0000">&apos;/var/www/uploads/&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$uploadfile&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$uploaddir&#xA0;</span><span style="color: #007700">.&#xA0;</span><span style="color: #0000BB">basename</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;userfile&apos;</span><span style="color: #007700">][</span><span style="color: #DD0000">&apos;name&apos;</span><span style="color: #007700">]);<br><br>echo&#xA0;</span><span style="color: #DD0000">&apos;&lt;pre&gt;&apos;</span><span style="color: #007700">;<br>if&#xA0;(</span><span style="color: #0000BB">move_uploaded_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">&apos;userfile&apos;</span><span style="color: #007700">][</span><span style="color: #DD0000">&apos;tmp_name&apos;</span><span style="color: #007700">],&#xA0;</span><span style="color: #0000BB">$uploadfile</span><span style="color: #007700">))&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;File&#xA0;is&#xA0;valid,&#xA0;and&#xA0;was&#xA0;successfully&#xA0;uploaded.\n&quot;</span><span style="color: #007700">;<br>}&#xA0;else&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;echo&#xA0;</span><span style="color: #DD0000">&quot;Possible&#xA0;file&#xA0;upload&#xA0;attack!\n&quot;</span><span style="color: #007700">;<br>}<br><br>echo&#xA0;</span><span style="color: #DD0000">&apos;Here&#xA0;is&#xA0;some&#xA0;more&#xA0;debugging&#xA0;info:&apos;</span><span style="color: #007700">;<br></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">);<br><br>print&#xA0;</span><span style="color: #DD0000">&quot;&lt;/pre&gt;&quot;</span><span style="color: #007700">;<br><br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <p class="simpara">
    The PHP script which receives the uploaded file should implement
    whatever logic is necessary for determining what should be done
    with the uploaded file. You can, for example, use the
    <var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;size&apos;]</a></var></var> variable
    to throw away any files that are either too small or too big.  You
    could use the
    <var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;type&apos;]</a></var></var> variable
    to throw away any files that didn&apos;t match a certain type criteria, but
    use this only as first of a series of checks, because this value
    is completely under the control of the client and not checked on the PHP
    side.
    Also, you could use <var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;error&apos;]</a></var></var> 
    and plan your logic according to the <a href="features.file-upload.errors.html" class="link">error codes</a>.
    Whatever the logic, you should either delete the file from the
    temporary directory or move it elsewhere.
   </p>
   <p class="simpara">
    If no file is selected for upload in your form, PHP will return
    <var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;size&apos;]</a></var></var> as 0, and
    <var class="varname"><var class="varname"><a href="reserved.variables.files.html" class="classname">$_FILES[&apos;userfile&apos;][&apos;tmp_name&apos;]</a></var></var> as none.
   </p>
   <p class="simpara">
    The file will be deleted from the temporary directory at the end
    of the request if it has not been moved away or renamed.
   </p>
    <div class="example" id="example-384">
     <p><strong>Example #3 Uploading array of files</strong></p>
     <div class="example-contents"><p>
      PHP supports <a href="faq.html.html#faq.html.arrays" class="link">HTML array feature</a>
      even with files.
     </p></div>
     <div class="example-contents">
<div class="htmlcode"><pre class="htmlcode">&lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
&lt;p&gt;Pictures:
&lt;input type=&quot;file&quot; name=&quot;pictures[]&quot; /&gt;
&lt;input type=&quot;file&quot; name=&quot;pictures[]&quot; /&gt;
&lt;input type=&quot;file&quot; name=&quot;pictures[]&quot; /&gt;
&lt;input type=&quot;submit&quot; value=&quot;Send&quot; /&gt;
&lt;/p&gt;
&lt;/form&gt;</pre>
</div>
     </div>

     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">foreach&#xA0;(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">&quot;pictures&quot;</span><span style="color: #007700">][</span><span style="color: #DD0000">&quot;error&quot;</span><span style="color: #007700">]&#xA0;as&#xA0;</span><span style="color: #0000BB">$key&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #0000BB">$error</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;if&#xA0;(</span><span style="color: #0000BB">$error&#xA0;</span><span style="color: #007700">==&#xA0;</span><span style="color: #0000BB">UPLOAD_ERR_OK</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$tmp_name&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">&quot;pictures&quot;</span><span style="color: #007700">][</span><span style="color: #DD0000">&quot;tmp_name&quot;</span><span style="color: #007700">][</span><span style="color: #0000BB">$key</span><span style="color: #007700">];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;basename()&#xA0;may&#xA0;prevent&#xA0;filesystem&#xA0;traversal&#xA0;attacks;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;further&#xA0;validation/sanitation&#xA0;of&#xA0;the&#xA0;filename&#xA0;may&#xA0;be&#xA0;appropriate<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$name&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">basename</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">&quot;pictures&quot;</span><span style="color: #007700">][</span><span style="color: #DD0000">&quot;name&quot;</span><span style="color: #007700">][</span><span style="color: #0000BB">$key</span><span style="color: #007700">]);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">move_uploaded_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$tmp_name</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&quot;data/</span><span style="color: #0000BB">$name</span><span style="color: #DD0000">&quot;</span><span style="color: #007700">);<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>}<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   <p class="para">
    File upload progress bar can be implemented using <a href="session.upload-progress.html" class="link">Session Upload Progress</a>.
   </p>
  