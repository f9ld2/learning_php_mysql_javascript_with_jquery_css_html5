---
layout: default
---

  <h2 class="title">Emit callbacks</h2>
  <p class="para">
   Emit callbacks are invoked when an instance of a registered class is
   emitted by <span class="function"><a href="function.yaml-emit.html" class="function">yaml_emit()</a></span> or
   <span class="function"><a href="function.yaml-emit-file.html" class="function">yaml_emit_file()</a></span>. The callback is passed the object to
   be emitted. The callback must return an array having two keys:
   &quot;<em>tag</em>&quot; and &quot;<em>data</em>&quot;.
   The value associated with the &quot;<em>tag</em>&quot; key must
   be a string to be used as the YAML tag in the output. The value associated
   with the &quot;<em>data</em>&quot; key will be encoded as YAML
   and emitted in place of the intercepted object.
  </p>
  <div class="example" id="example-4692">
   <p><strong>Example #1 Emit callback example</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #007700">class&#xA0;</span><span style="color: #0000BB">EmitExample&#xA0;</span><span style="color: #007700">{<br>&#xA0;&#xA0;public&#xA0;</span><span style="color: #0000BB">$data</span><span style="color: #007700">;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #FF8000">//&#xA0;data&#xA0;may&#xA0;be&#xA0;in&#xA0;any&#xA0;pecl/yaml&#xA0;suitable&#xA0;type<br><br>&#xA0;&#xA0;</span><span style="color: #007700">public&#xA0;function&#xA0;</span><span style="color: #0000BB">__construct&#xA0;</span><span style="color: #007700">(</span><span style="color: #0000BB">$d</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">data&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">$d</span><span style="color: #007700">;<br>&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;</span><span style="color: #FF8000">/**<br>&#xA0;&#xA0;&#xA0;*&#xA0;Yaml&#xA0;emit&#xA0;callback&#xA0;function,&#xA0;referred&#xA0;on&#xA0;yaml_emit&#xA0;call&#xA0;by&#xA0;class&#xA0;name.<br>&#xA0;&#xA0;&#xA0;*<br>&#xA0;&#xA0;&#xA0;*&#xA0;Expected&#xA0;to&#xA0;return&#xA0;an&#xA0;array&#xA0;with&#xA0;2&#xA0;values:<br>&#xA0;&#xA0;&#xA0;*&#xA0;&#xA0;&#xA0;-&#xA0;&apos;tag&apos;:&#xA0;custom&#xA0;tag&#xA0;for&#xA0;this&#xA0;serialization<br>&#xA0;&#xA0;&#xA0;*&#xA0;&#xA0;&#xA0;-&#xA0;&apos;data&apos;:&#xA0;value&#xA0;to&#xA0;convert&#xA0;to&#xA0;yaml&#xA0;(array,&#xA0;string,&#xA0;bool,&#xA0;number)<br>&#xA0;&#xA0;&#xA0;*<br>&#xA0;&#xA0;&#xA0;*&#xA0;@param&#xA0;object&#xA0;$obj&#xA0;Object&#xA0;to&#xA0;be&#xA0;emitted<br>&#xA0;&#xA0;&#xA0;*&#xA0;@return&#xA0;array&#xA0;Tag&#xA0;and&#xA0;surrogate&#xA0;data&#xA0;to&#xA0;emit<br>&#xA0;&#xA0;&#xA0;*/<br>&#xA0;&#xA0;</span><span style="color: #007700">public&#xA0;static&#xA0;function&#xA0;</span><span style="color: #0000BB">yamlEmit&#xA0;</span><span style="color: #007700">(</span><span style="color: #0000BB">EmitExample&#xA0;$obj</span><span style="color: #007700">)&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;return&#xA0;array(<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&apos;tag&apos;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #DD0000">&apos;!example/emit&apos;</span><span style="color: #007700">,<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&apos;data&apos;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #0000BB">$obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">data</span><span style="color: #007700">,<br>&#xA0;&#xA0;&#xA0;&#xA0;);<br>&#xA0;&#xA0;}<br>}<br><br></span><span style="color: #0000BB">$emit_callbacks&#xA0;</span><span style="color: #007700">=&#xA0;array(<br>&#xA0;&#xA0;</span><span style="color: #DD0000">&apos;EmitExample&apos;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;array(</span><span style="color: #DD0000">&apos;EmitExample&apos;</span><span style="color: #007700">,&#xA0;</span><span style="color: #DD0000">&apos;yamlEmit&apos;</span><span style="color: #007700">)<br>);<br><br></span><span style="color: #0000BB">$t&#xA0;</span><span style="color: #007700">=&#xA0;new&#xA0;</span><span style="color: #0000BB">EmitExample</span><span style="color: #007700">(array(</span><span style="color: #DD0000">&apos;a&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;b&apos;</span><span style="color: #007700">,</span><span style="color: #DD0000">&apos;c&apos;</span><span style="color: #007700">));<br></span><span style="color: #0000BB">$yaml&#xA0;</span><span style="color: #007700">=&#xA0;</span><span style="color: #0000BB">yaml_emit</span><span style="color: #007700">(<br>&#xA0;&#xA0;array(<br>&#xA0;&#xA0;&#xA0;&#xA0;</span><span style="color: #DD0000">&apos;example&apos;&#xA0;</span><span style="color: #007700">=&gt;&#xA0;</span><span style="color: #0000BB">$t</span><span style="color: #007700">,<br>&#xA0;&#xA0;),<br>&#xA0;&#xA0;</span><span style="color: #0000BB">YAML_ANY_ENCODING</span><span style="color: #007700">,<br>&#xA0;&#xA0;</span><span style="color: #0000BB">YAML_ANY_BREAK</span><span style="color: #007700">,<br>&#xA0;&#xA0;</span><span style="color: #0000BB">$emit_callbacks<br></span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$yaml</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>The above example will output
something similar to:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
string(43) &quot;---
example: !example/emit
- a
- b
- c
...
&quot;
</pre></div>
   </div>
  </div>
 